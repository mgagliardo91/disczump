{"filter":false,"title":"dashboard.js","tooltip":"/public/js/dashboard.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"start":{"row":701,"column":16},"end":{"row":701,"column":17},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":701,"column":17},"end":{"row":701,"column":18},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":703,"column":6},"end":{"row":732,"column":19},"action":"remove","lines":["var fileName = $inner.find('#exportFileName').val();","\t\t\t\t\t\tvar type = $inner.find('input:radio:checked').val();","\t\t\t\t\t\t","\t\t\t\t\t\tif (fileName == '') {","\t\t\t\t\t\t\tvar dt = new Date();","\t\t\t\t\t\t\tvar time = dt.getHours() + '_' + dt.getMinutes() + '_' + dt.getSeconds();","\t\t\t\t\t\t\tfileName = 'DiscZump_' + time;","\t\t\t\t\t\t}","\t\t\t\t\t\t","\t\t\t\t\t\tvar csvContent = \"data:text/csv;charset=utf-8,\";","\t\t\t\t\t\tvar writeHeaders = true;","\t\t\t\t\t\tvar list = discs;","\t\t\t\t\t\tif (type == 'filtered') {","\t\t\t\t\t\t\tlist = discList;","\t\t\t\t\t\t}","\t\t\t\t\t\t","\t\t\t\t\t\t_.each(list, function(disc) {","\t\t\t\t\t\t\tif (writeHeaders) {","\t\t\t\t\t\t\t\tcsvContent += _.map(_.keys(disc), function(key) {return key.toUpperCase();}).join(',') + '\\n';","\t\t\t\t\t\t\t\twriteHeaders = false;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t","\t\t\t\t\t\t\tcsvContent += _.values(disc).join(',') + '\\n';\t","\t\t\t\t\t\t});","\t\t\t\t\t\t","\t\t\t\t\t\tvar encodedUri = encodeURI(csvContent);","\t\t\t\t\t\tvar link = document.createElement(\"a\");","\t\t\t\t\t\tlink.setAttribute('href', encodedUri);","\t\t\t\t\t\tlink.setAttribute('download', fileName + '.csv');","\t\t\t\t\t\tlink.click();"]},{"start":{"row":703,"column":6},"end":{"row":710,"column":6},"action":"insert","lines":["var disc = createDisc($inner);","\t\t\tpostDisc(disc, function(success) {","\t\t\t\tif (success) {","\t\t\t\t\tupdateFilter();","\t\t\t\t} else {","\t\t\t\t\t// error logic","\t\t\t\t}","\t\t\t});"]}]}],[{"group":"doc","deltas":[{"start":{"row":704,"column":0},"end":{"row":704,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":705,"column":0},"end":{"row":705,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":706,"column":0},"end":{"row":706,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":707,"column":0},"end":{"row":707,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":708,"column":0},"end":{"row":708,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":709,"column":0},"end":{"row":709,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":710,"column":0},"end":{"row":710,"column":1},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":704,"column":0},"end":{"row":704,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":705,"column":0},"end":{"row":705,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":706,"column":0},"end":{"row":706,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":707,"column":0},"end":{"row":707,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":708,"column":0},"end":{"row":708,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":709,"column":0},"end":{"row":709,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":710,"column":0},"end":{"row":710,"column":1},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":704,"column":0},"end":{"row":704,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":705,"column":0},"end":{"row":705,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":706,"column":0},"end":{"row":706,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":707,"column":0},"end":{"row":707,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":708,"column":0},"end":{"row":708,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":709,"column":0},"end":{"row":709,"column":1},"action":"insert","lines":["\t"]},{"start":{"row":710,"column":0},"end":{"row":710,"column":1},"action":"insert","lines":["\t"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":83},"end":{"row":728,"column":6},"action":"remove","lines":[" {","\t\tif (success) {","\t\t\t","\t\t\tvar disc = createDisc($inner);","\t\t\tpostDisc(disc, function(success) {","\t\t\t\tif (success) {","\t\t\t\t\tupdateFilter();","\t\t\t\t} else {","\t\t\t\t\t// error logic","\t\t\t\t}","\t\t\t});","\t\t\t","\t\t}","\t\t","\t});*/"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":6},"end":{"row":714,"column":7},"action":"remove","lines":["*"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":5},"end":{"row":714,"column":6},"action":"remove","lines":["/"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":47},"end":{"row":714,"column":53},"action":"remove","lines":["Create"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":47},"end":{"row":714,"column":48},"action":"remove","lines":["'"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":46},"end":{"row":714,"column":47},"action":"remove","lines":["'"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":46},"end":{"row":714,"column":47},"action":"insert","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":47},"end":{"row":714,"column":48},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":48},"end":{"row":714,"column":49},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":49},"end":{"row":714,"column":50},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":50},"end":{"row":714,"column":51},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":51},"end":{"row":714,"column":52},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":52},"end":{"row":714,"column":53},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["("]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":[","]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["$"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":55},"end":{"row":714,"column":56},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":56},"end":{"row":714,"column":57},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":57},"end":{"row":714,"column":58},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":59},"end":{"row":714,"column":60},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":20},"end":{"row":714,"column":36},"action":"remove","lines":["New Disc Details"]},{"start":{"row":714,"column":20},"end":{"row":714,"column":21},"action":"insert","lines":["C"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":21},"end":{"row":714,"column":22},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":22},"end":{"row":714,"column":23},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":23},"end":{"row":714,"column":24},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":24},"end":{"row":714,"column":25},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":25},"end":{"row":714,"column":26},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":25},"end":{"row":714,"column":26},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":24},"end":{"row":714,"column":25},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":23},"end":{"row":714,"column":24},"action":"remove","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":22},"end":{"row":714,"column":23},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":21},"end":{"row":714,"column":22},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":20},"end":{"row":714,"column":21},"action":"remove","lines":["C"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":20},"end":{"row":714,"column":21},"action":"insert","lines":["A"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":21},"end":{"row":714,"column":22},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":22},"end":{"row":714,"column":23},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":23},"end":{"row":714,"column":24},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":24},"end":{"row":714,"column":25},"action":"insert","lines":["D"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":25},"end":{"row":714,"column":26},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":26},"end":{"row":714,"column":27},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":714,"column":27},"end":{"row":714,"column":28},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":85,"column":5},"end":{"row":86,"column":0},"action":"insert","lines":["",""]},{"start":{"row":86,"column":0},"end":{"row":86,"column":2},"action":"insert","lines":["\t "]}]}],[{"group":"doc","deltas":[{"start":{"row":86,"column":2},"end":{"row":87,"column":0},"action":"insert","lines":["",""]},{"start":{"row":87,"column":0},"end":{"row":87,"column":2},"action":"insert","lines":["\t "]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":2},"end":{"row":89,"column":5},"action":"insert","lines":["$('#export-list').click(function(e){","\t \texportList();","\t });"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":13},"end":{"row":87,"column":17},"action":"remove","lines":["list"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":12},"end":{"row":87,"column":13},"action":"remove","lines":["-"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":11},"end":{"row":87,"column":12},"action":"remove","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":10},"end":{"row":87,"column":11},"action":"remove","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":9},"end":{"row":87,"column":10},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":8},"end":{"row":87,"column":9},"action":"remove","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":7},"end":{"row":87,"column":8},"action":"remove","lines":["x"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":6},"end":{"row":87,"column":7},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":6},"end":{"row":87,"column":7},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":7},"end":{"row":87,"column":8},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":8},"end":{"row":87,"column":9},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":9},"end":{"row":87,"column":10},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":10},"end":{"row":87,"column":11},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":11},"end":{"row":87,"column":12},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":12},"end":{"row":87,"column":13},"action":"insert","lines":["-"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":13},"end":{"row":87,"column":14},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":14},"end":{"row":87,"column":15},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":15},"end":{"row":87,"column":16},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":16},"end":{"row":87,"column":17},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":17},"end":{"row":87,"column":18},"action":"insert","lines":["-"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":18},"end":{"row":87,"column":19},"action":"insert","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":19},"end":{"row":87,"column":20},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":20},"end":{"row":87,"column":21},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":21},"end":{"row":87,"column":22},"action":"insert","lines":["a"]}]}],[{"group":"doc","deltas":[{"start":{"row":87,"column":22},"end":{"row":87,"column":23},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":4},"end":{"row":88,"column":16},"action":"remove","lines":["xportList();"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":3},"end":{"row":88,"column":4},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":3},"end":{"row":88,"column":25},"action":"insert","lines":["generateCreateDiscForm"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":25},"end":{"row":88,"column":27},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":88,"column":27},"end":{"row":88,"column":28},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":1574,"column":0},"action":"remove","lines":["var url = \"https://disczumpserver-mgagliardo.c9.io/api/\";","","var $searchResults;","var $searchBar;","var $filterResults;","var $footerSort;","var $modalDetails;","","var searchRequest;","","var discList = [];","var discs = [];","var filters = {name: [], brand: [], type: [], material: [], weight: [], color: [], speed: [], glide: [], turn: [], fade: []};","var sort = [{sortProp: 'name', sortType: 'text', sortOn: true, sortAsc: true, sortOrder: 1},","\t\t  {sortProp: 'brand', sortType: 'text', sortOn: true, sortAsc: true, sortOrder: 0},","\t\t  {sortProp: 'type', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'material', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'weight', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'color', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'speed', sortType: 'number', sortOn: false, sortAsc: false, sortOrder: -1},","\t\t  {sortProp: 'glide', sortType: 'number', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'turn', sortType: 'number', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'fade', sortType: 'number', sortOn: false, sortAsc: true, sortOrder: -1}];","var paginateOptions = {displayCount: 20, currentPage: 1, lastPage: 1};","","$(document).ready(function(){","     $searchResults = $('#search-results');","     $searchBar = $('#search-all');","\t$filterResults = $('#filter-results');","\t$footerSort = $('#results-footer-sort');","\t$modalDetails = $('#modal-details');","     ","     $(window).on('resize', function(){","        resizeSearch();  ","     });","     ","     $(window).click(function(e) {","     \tif ($searchResults.is(':visible')) {","     \t\t$searchResults.hide();","     \t}\t","     });","     ","     $searchBar.focusin(function(){","     \t$(this).trigger('keyup');","     }).on('keyup', function(){","     \tdelay(function(){","\t     \tif ($searchBar.val().length > 0) {","\t     \t\tif (!$searchResults.is(':visible')) {","\t     \t\t\t$searchResults.show();","\t     \t\t}","\t               doSearch();","\t          } else {","\t               $searchResults.hide();","\t          }","\t\t}, 200 );","     }).click(function(e) { e.stopPropagation(); });","     ","     $('#search-request').click(function() {","     \t$searchBar.focus();","     });","     ","     $('.panel-heading').on('click', function(){","          var $this = $(this);","          var $panelBody = $this.siblings('.panel-body');","          var $glyph = $this.children('.glyphicon');","          ","          if ($this.hasClass('panel-open')) {","               $panelBody.slideUp(300, function(){","                    $glyph.removeClass('glyphicon-minus');","                    $glyph.addClass('glyphicon-plus');","                    $this.addClass('panel-closed');","               });","               $this.removeClass('panel-open');","          } else if ($this.hasClass('panel-closed')) {","               $panelBody.slideDown(300, function(){","                     $glyph.removeClass('glyphicon-plus');","                    $glyph.addClass('glyphicon-minus');","                    $this.addClass('panel-open');","               });","               $this.removeClass('panel-closed');","          }","     });","\t ","\t $('#export-list').click(function(e){","\t \texportList();","\t });","\t ","\t $('#create-disc-modal').click(function(e){","\t \tgenerateCreateDiscForm();","\t });","\t ","\t $(document).on('click', '.filter-option:not(.filter-option-static)', function(e){","\t\t\te.stopPropagation();","\t\t\t","\t\t\tvar $parent = $(this).parents('.filter-item-parent');","\t\t\tvar option = $parent.attr('id').match(/-([a-z]+)/)[1];","\t\t\t","\t\t\tvar child = $(this).children('.glyphicon');","\t\t\tif (child.length > 0) {","\t\t\t\tchild.remove();","\t\t\t\tfilters[option] = _.without(filters[option], $(this).text());","\t\t\t} else {","\t\t\t\t$(this).append('<span class=\"glyphicon glyphicon-ok pull-right\" aria-hidden=\"true\"></span>');","\t\t\t\tif (!_.contains(filters[option], $(this).text())) {","\t\t\t\t\tfilters[option].push($(this).text());","\t\t\t\t}","\t\t\t}","\t\t\tupdateFilter();","\t  });","\t  ","\t  $(document).on('click', '.result-item:not(.result-item-empty)', function(e) {","\t  \t\te.stopPropagation();","\t  \t\tvar $parent = $(this).parents('.result-section');","\t\t\tvar option = $parent.attr('id').match(/-([a-z]+)/)[1];","\t\t\tvar val = $(this).text();","\t\t\t","\t  \t\tif (option == 'name') {","\t  \t\t\tfilters.name.push(val);","\t  \t\t\t$searchBar.val(val).attr('readonly', true);","\t  \t\t\t$searchBar.bind('click', searchLock);","\t  \t\t\tupdateFilter();","\t  \t\t} else {","\t  \t\t\t$searchBar.val('');","\t  \t\t\tvar $filterOption = $('#filter-' + option);","\t  \t\t\t$filterOption.find('.filter-option').find('.glyphicon').remove();","\t  \t\t\tfilters[option] = [];","\t  \t\t\t$filterOption.find('.filter-option:contains(' + val + ')').trigger('click');","\t  \t\t}","\t  \t\t","\t  \t\t$searchResults.hide();","\t  });","     ","     $('.filter-option-multi').on('click', function(e){","\t\t  if ($(e.target).attr('class') == 'filter-option') {","\t\t\treturn;","\t\t  }","\t ","          var $this = $(this);","          var $itemGroup = $this.children('.filter-option-group');","               ","          if ($this.hasClass('filter-option-multi-closed')) {","               $itemGroup.slideDown(300, function(){","                    $this.addClass(('filter-option-multi-open'));","               });","               $this.removeClass('filter-option-multi-closed');","          } else {","               $itemGroup.slideUp(300, function(){","                    $this.addClass('filter-option-multi-closed');","               });","               $this.removeClass('filter-option-multi-open');","          }","     });","     ","     $('.heading-text').click(function(){","     \tvar glyph = $(this).children('.glyphicon');","     \ttrySort($(this), function(sorter) {","     \t\tif (!sorter.sortOn) {","     \t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","     \t\t} else {","     \t\t\tif (sorter.sortAsc) {","     \t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","     \t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet');","     \t\t\t} else {","     \t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet');","     \t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet-alt');","     \t\t\t}","     \t\t\tglyph.show();","     \t\t}","     \t});","     });","     ","\t $(document).on('click', '.disc-item', function() {","\t \tvar disc = getDisc($(this).attr('discid'));","\t \t$modalDetails.empty();","\t\t$modalDetails.append(generateModalTemplate(disc));","\t \t$('#viewDiscModal').modal('show');","\t });","\t ","\t $(document).on('click', '.page-dynamic', function() {","\t \tvar page = parseInt($(this).text());","\t \tpaginateOptions.currentPage = page;","\t \tshowDiscs(true);","\t });","\t ","\t $('#page-back').click(function(){","\t \tpaginateOptions.currentPage -= 1;\t","\t \tshowDiscs(true);","\t });","\t ","\t $('#page-forward').click(function(){","\t \tpaginateOptions.currentPage += 1;","\t \tshowDiscs(true);\t","\t });","\t ","\t $('#paginate-display-count').on('change', function(){","\t \tvar val = $(this).val();","\t \tval = parseInt(val);","\t \tif (_.isNaN(val)) {","\t \t\tpaginateOptions.displayCount = -1;","\t \t\tpaginateOptions.currentPage = 1;","\t \t} else {","\t \t\tpaginateOptions.displayCount = parseInt(val);","\t \t}","\t \t","\t \tshowDiscs();","\t });","\t ","\t$('#createDiscForm').submit(function(e){","\t\te.preventDefault();","\t\tvar disc = createDisc($(this));","\t\tpostDisc(disc, function(success) {","\t\t\tif (success) {","\t\t\t\tupdateFilter();","\t\t\t} else {","\t\t\t\t// error logic","\t\t\t}","\t\t\t","\t\t\t$('#createDiscModal').modal('hide');","\t\t});","\t});","\t","\t","     // Start on-load commands","     ","     resizeSearch();","     $searchResults.hide();","     getAllDiscs(function(success){","\t\tif (success) {","\t\t\tinitialize();","\t\t} else {","\t\t\talert('Unable to intialize');","\t\t}","\t });","});","","var searchLock = function(e) {","\te.stopPropagation();","\tfilters.name = [];","\t$(this).attr('readonly', false).unbind('click', searchLock);","\tupdateFilter();","\t$searchBar.trigger('keyup');","};","","function doSearch() {","\tvar search = $searchBar.val();","\t","\tcontainSearch(search, ['name', 'brand', 'type'], function(prop, list) {","\t\tif (prop == 'name') {","\t\t\tupdateSearchResults($('#results-name'), list);","\t\t} else if (prop == 'brand') {","\t\t\tupdateSearchResults($('#results-brand'), list);","\t\t} else if (prop == 'type') {","\t\t\tupdateSearchResults($('#results-type'), list);","\t\t}","\t});","}","","function updateSearchResults($section, list) {","\tvar $output = $section.children('.result-section-output');","\t$output.children('.result-item:not(.result-item-empty)').remove();","\tif (list.length > 0) {","\t\t$output.children('.result-item-empty').hide();","\t\t_.each(list, function(result) {","\t\t\t$output.append(generateResultItem(result));","\t\t});","\t} else {","\t\t$output.children('.result-item-empty').show();","\t}","}","","function generateResultItem(item) {","\treturn '<div class=\"result-item\">' + item +","    \t\t'<span class=\"glyphicon glyphicon-leaf pull-left\" aria-hidden=\"true\"></span>' + ","\t\t'</div>';","}","","function updateFilter() {","\tdiscList = filterList(filters);","\tshowDiscs();","}","","function resizeSearch() {","     if ($searchResults.is(':visible')) {","          $searchResults.width($searchBar.outerWidth());","          $searchResults.css({left: $searchBar.offset().left, ","          top: $searchBar.offset().top + $searchBar.outerHeight()});","     }","};","","function initialize() {","\t\tdiscList = discs;","\t\tgenerateFilters($('#filter-brand'), '.panel-body', getProperties('brand'));","\t\tgenerateFilters($('#filter-type'), '.panel-body', getProperties('type'));","\t\tgenerateFilters($('#filter-material'), '.panel-body', getProperties('material'));","\t\tgenerateFilters($('#filter-weight'), '.panel-body', getProperties('weight'));","\t\tgenerateFilters($('#filter-color'), '.panel-body', getProperties('color'));","\t\tgenerateFilters($('#filter-speed'), '.filter-option-group', getProperties('speed'));","\t\tgenerateFilters($('#filter-glide'), '.filter-option-group', getProperties('glide'));","\t\tgenerateFilters($('#filter-turn'), '.filter-option-group', getProperties('turn'));","\t\tgenerateFilters($('#filter-fade'), '.filter-option-group', getProperties('fade'));","\t\tshowDiscs();","}","","function generateFilters($option, query, items) {","\tvar filterBody = $option.find(query);","\tif (items.length > 0) {","\t\t$option.find('div.filter-option-static').hide();","\t\t_.each(items, function(item) {","\t\t\tfilterBody.append(generateFilterOption(item));","\t\t});","\t} else {","\t\t$option.find('div.filter-option-static').show();","\t}","}","","function generateFilterOption(option) {","\treturn '<div class=\"filter-option\">' + option + '</div>';","}","","function showDiscs(maintainPage) {","\tif (!maintainPage) {","\t\tpaginateOptions.currentPage = 1;","\t}","\t","\t$filterResults.empty();","\tvar sorted = sortDiscs(discList);","\tvar paged = paginate(sorted);","\t_.each(paged, function(disc) {","\t\t$filterResults.append(generateDiscTemplate(disc));","\t});","\tupdateFooter(sorted.length);","}","","function updateFooter(count) {","\t$('#results-footer-count').text('Results: ' + count);","\t$footerSort.text('Sort: ' + (_.where(sort, {sortOn: true}).length > 0 ? 'On' : 'Off'));","\t","\tvar $paginate = $('#paginate-nav');","\tvar $pageInsert = $('#page-back');","\t$paginate.find('.page-dynamic').remove();","\t","\tvar start = 1;","\tvar end = 5;","\t","\tif (paginateOptions.currentPage < 3) {","\t\tend = Math.min(5, paginateOptions.lastPage);","\t} else if (paginateOptions.currentPage > paginateOptions.lastPage - 2) {","\t\tend = paginateOptions.lastPage;","\t\tstart = Math.max(1, paginateOptions.lastPage - 4);","\t} else {","\t\tstart = paginateOptions.currentPage - 2;","\t\tend = paginateOptions.currentPage + 2;","\t}","\t","\tfor (var i = end; i >= start; i--) {","\t\t$pageInsert.after('<li class=\"page-dynamic' + (i == paginateOptions.currentPage ? ' active' : '') + '\">' + i + '</li>');","\t}","}","","function generateDiscTemplate(disc) {","\treturn '<tr class=\"disc-item\" discId=\"' + disc._id + '\">' +","\t\t  \t'<td class=\"disc-brand\">' + disc.brand + '</td>' +","\t\t  \t'<td class=\"disc-name\">' + disc.name + '</td>' +","\t\t  \t'<td class=\"disc-material\">' + disc.material + '</td>' +","\t\t  \t'<td class=\"disc-type\">' + disc.type + '</td>' +","\t\t  \t'<td class=\"disc-speed\">' + disc.speed + '</td>' +","\t\t  \t'<td class=\"disc-glide\">' + disc.glide + '</td>' +","\t\t  \t'<td class=\"disc-turn\">' + disc.turn + '</td>' +","\t\t  \t'<td class=\"disc-fade\">' + disc.fade + '</td>' +","\t\t  '</tr>';","}","","function generateModalTemplate(disc) {","\treturn '<p>' + disc.type + '</p>' +","\t\t\t'<p>' + disc.material + '</p>' +","\t\t\t'<p>' + disc.color + '</p>' +","\t\t\t'<p>' + disc.weight + '</p>' +","\t\t\t'<p>' + disc.speed + '</p>' +","\t\t\t'<p>' + disc.glide + '</p>' +","\t\t\t'<p>' + disc.turn + '</p>' +","\t\t\t'<p>' + disc.fade + '</p>'","}","","function trySort($sortHeader, callback) {","\tvar sorter = _.first(_.where(sort, {'sortProp': $sortHeader.text().toLowerCase().trim()}));","\tif (sorter !== undefined) {","\t\tvar isOn = sorter.sortOn;","\t\tsorter.sortAsc = !(isOn && sorter.sortAsc);","\t\tsorter.sortOn = !(isOn && sorter.sortAsc);","\t\t","\t\tvar order = _.max(_.pluck(sort, 'sortOrder')) + 1;","\t\tsorter.sortOrder = sorter.sortOn ? (isOn ? sorter.sortOrder : order) : -1;","\t\tshowDiscs();","\t\t","\t\tif (callback) {","\t\t\tcallback(sorter);","\t\t}","\t}","}","","function genericSort(sorter, array) {","\tif (sorter.sortType == 'number') {","\t\tarray = _.sortBy(array, function(disc) { return parseInt(disc[sorter.sortProp])});","\t} else {","\t\tarray = _.sortBy(array, sorter.sortProp);","\t}","\t","\tif (!sorter.sortAsc) {","\t\tarray = array.reverse();","\t}","\t","\treturn array;","}","","function sortDiscs() {","\tvar toSort = _.sortBy(_.where(sort, {sortOn : true}), 'sortOrder');","\tvar sorted = discList;","\t","\tvar lastSort;","\t_.each(toSort, function(sorter) {","\t\tif (typeof lastSort === 'undefined') {","\t\t\tsorted = genericSort(sorter, sorted);","\t\t} else {","\t\t\tvar parentVals = _.groupBy(sorted, function(disc) { return disc[lastSort.sortProp]; });","\t\t\tvar newArray = [];","\t\t\t_.each(parentVals, function(valArray) {","\t\t\t\tvalArray = genericSort(sorter, valArray);","\t\t\t\tnewArray = newArray.concat(valArray);","\t\t\t});","\t\t\tsorted = newArray;","\t\t}","\t\tlastSort = sorter;","\t});","\t ","\t if (toSort.length) {","\t \t$footerSort.popover({","\t\t \tanimation: true,","\t\t \thtml: true,","\t\t \tcontent: function(){","\t\t \t\t\tvar sortMethod = _.pluck(_.where(sort, {sortOn : true}), 'sortProp');","\t\t\t\t\tvar sortText = '<ol class=\"sort-text\">'","\t\t\t\t\t_.each(sortMethod, function(method) {","\t\t\t\t\t\tsortText += '<li>' + method + '</li>';\t","\t\t\t\t\t});","\t\t\t\t\tsortText += '</ol>';","\t\t\t\t\treturn sortText;","\t\t \t},","\t\t \tplacement: 'bottom',","\t\t \ttrigger: 'hover'","\t\t });","\t } else {","\t \t$footerSort.popover('destroy');","\t }","\t ","\t _.each(sort, function(sorter) {","\t\tglyph = $('#sort-' + sorter.sortProp).find('.glyphicon');","\t\tif (!sorter.sortOn) {","\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","\t\t} else {","\t\t\tif (sorter.sortAsc) {","\t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","\t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet');","\t\t\t} else {","\t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet');","\t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet-alt');","\t\t\t}","\t\t\tglyph.show();","\t\t}","\t });","\t ","\treturn sorted;","}","","function paginate(toPaginate) {","\tvar lastPage = 1;","\t","\tif (paginateOptions.displayCount > -1) {","\t\tlastPage = Math.ceil((toPaginate.length / paginateOptions.displayCount));","\t}","\t","\tpaginateOptions.lastPage = lastPage;","\tif (paginateOptions.currentPage > lastPage) {","\t\tpaginateOptions.currentPage = lastPage;","\t}","\t","\tif (paginateOptions.currentPage < 1) paginateOptions.currentPage = 1;","\t","\tvar start = (paginateOptions.currentPage - 1) * paginateOptions.displayCount;","\tvar end = Math.min(toPaginate.length, start + paginateOptions.displayCount);","\treturn toPaginate.slice(start, end);","}","","function exportList() {","\tvar $form =  $('<form class=\"form\" role=\"form\"></form>');","\t$form.html('<div class=\"form-group\">' + ","\t\t\t\t'<label for=\"exportFileName\">File Name</label>' +","\t\t\t\t'<input type=\"text\" class=\"form-control\" id=\"exportFileName\" placeholder=\"File Name\">' +","\t  \t\t'</div>' +","\t  \t\t'<div class=\"radio\">' +","\t\t\t\t'<label>' +","\t\t\t\t\t'<input type=\"radio\" name=\"exportOptions\" id=\"exportAll\" value=\"all\" checked>' +","\t\t\t\t\t'Export All Discs' +","\t\t\t\t'</label>' +","\t\t\t'</div>' +","\t\t\t'<div class=\"radio\">' +","\t\t\t\t'<label>' +","\t\t\t\t\t'<input type=\"radio\" name=\"exportOptions\" id=\"exportFiltered\" value=\"filtered\">' +","\t\t\t\t\t'Export Filtered Discs' +","\t\t\t\t'</label>' +","\t\t\t'</div>');","\t\t\t","\tvar $footer = $('<div></div>').html(","\t\t'<button type=\"button\" class=\"btn btn-default\" fn-title=\"close\">Close</button>' + ","          '<button type=\"button\" class=\"btn btn-primary\" fn-title=\"export\">Export</button>'","\t\t);","\t\t","\tvar fns = [","\t\t\t\t{","\t\t\t\t\tname: 'close',","\t\t\t\t\tfunction: function() {","\t\t\t\t\t\tconsole.log('Closed without exporting.');","\t\t\t\t\t}","\t\t\t\t},","\t\t\t\t{","\t\t\t\t\tname: 'export',","\t\t\t\t\tfunction: function($inner) {","\t\t\t\t\t\tvar fileName = $inner.find('#exportFileName').val();","\t\t\t\t\t\tvar type = $inner.find('input:radio:checked').val();","\t\t\t\t\t\t","\t\t\t\t\t\tif (fileName == '') {","\t\t\t\t\t\t\tvar dt = new Date();","\t\t\t\t\t\t\tvar time = dt.getHours() + '_' + dt.getMinutes() + '_' + dt.getSeconds();","\t\t\t\t\t\t\tfileName = 'DiscZump_' + time;","\t\t\t\t\t\t}","\t\t\t\t\t\t","\t\t\t\t\t\tvar csvContent = \"data:text/csv;charset=utf-8,\";","\t\t\t\t\t\tvar writeHeaders = true;","\t\t\t\t\t\tvar list = discs;","\t\t\t\t\t\tif (type == 'filtered') {","\t\t\t\t\t\t\tlist = discList;","\t\t\t\t\t\t}","\t\t\t\t\t\t","\t\t\t\t\t\t_.each(list, function(disc) {","\t\t\t\t\t\t\tif (writeHeaders) {","\t\t\t\t\t\t\t\tcsvContent += _.map(_.keys(disc), function(key) {return key.toUpperCase();}).join(',') + '\\n';","\t\t\t\t\t\t\t\twriteHeaders = false;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t","\t\t\t\t\t\t\tcsvContent += _.values(disc).join(',') + '\\n';\t","\t\t\t\t\t\t});","\t\t\t\t\t\t","\t\t\t\t\t\tvar encodedUri = encodeURI(csvContent);","\t\t\t\t\t\tvar link = document.createElement(\"a\");","\t\t\t\t\t\tlink.setAttribute('href', encodedUri);","\t\t\t\t\t\tlink.setAttribute('download', fileName + '.csv');","\t\t\t\t\t\tlink.click();","\t\t\t\t\t}","\t\t\t\t}","\t\t];","\t\t","\tgenerateModal('Export List', $form, $footer, fns);","}","","function generateModal(title, $body, $footer, fns) {","\t$('.custom-modal').remove();","\tvar bodyText = '';","\tvar footerText = '';","\t","\tif ($body) {","\t\tbodyText = $('<div></div>').append($body).html();","\t}","\t","\tif ($footer) {","\t\tfooterText = $footer.html();","\t}","\t","\tvar $modal = $('<div class=\"modal custom-modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"></div>');","\t$modal.html('<div class=\"modal-dialog\">' + ","            '<div class=\"modal-content\">' + ","              '<div class=\"modal-header\">' + ","              '<button type=\"button\" class=\"close\" data-dismiss=\"modal\"><span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span></button>' +","              '<h4 class=\"modal-title\">' + (title ? title : '') + '</h4>' + ","              '</div>' + ","              '<div class=\"modal-body\">' + bodyText + ","              '</div>' + ","              '<div class=\"modal-footer\">' + footerText +","              '</div>' + ","            '</div>' + ","            '</div>');","            ","     $('body').append($modal);","     ","     if (fns) {","     \t_.each(fns, function(fn) {","     \t\tif (fn.name && fn.function) {","     \t\t\t$modal.find('[fn-title=\"' + fn.name +'\"]').on('click', function() {","     \t\t\t\tfn.function($modal.find('.modal-body'));","     \t\t\t\t$modal.modal('hide');","     \t\t\t});","     \t\t}","     \t});","     }","     $modal.on('hidden.bs.modal', function (e) {","\t  $modal.remove();","\t});","     $modal.modal({show: true, backdrop: 'static'});","}","","function generateCreateDiscForm() {","\tvar $form =  $('<form class=\"form-horizontal\" role=\"form\" id=\"createDiscForm\"></form>');","\t$form.html('<div class=\"form-group\">' +","\t                  '<label for=\"md-add-brand\" class=\"col-sm-2 control-label\"><span class=\"required-field\">* </span>Brand</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<input type=\"text\" class=\"form-control\" id=\"create-disc-brand\" param=\"brand\" required>' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-name\" class=\"col-sm-2 control-label\"><span class=\"required-field\">* </span>Name</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<input type=\"text\" class=\"form-control\" id=\"create-disc-name\" param=\"name\" required>' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-material\" class=\"col-sm-2 control-label\">Material</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<input type=\"text\" class=\"form-control\" id=\"create-disc-material\" param=\"material\">' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-type\" class=\"col-sm-2 control-label\">Type</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<select class=\"form-control\" id=\"create-disc-type\"  param=\"type\">' +","\t                          '<option value=\"Putt/Approach\">Putt/Approach</option>' +","\t                          '<option value=\"Mid-range\">Mid-range</option>' +","\t                          '<option value=\"Fairway Driver\">Fairway Driver</option>' +","\t                          '<option value=\"Distance Driver\">Distance Driver</option>' +","\t                          '<option value=\"Mini\">Mini</option>' +","\t                      '</select>' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-weight\" class=\"col-sm-2 control-label\">Weight</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<input type=\"number\" class=\"form-control\" id=\"create-disc-weight\" param=\"weight\">' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-color\" class=\"col-sm-2 control-label\">Color</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<input type=\"text\" class=\"form-control\" id=\"create-disc-color\" param=\"color\">' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-speed\" class=\"col-sm-2 control-label\">Speed</label>' +","\t                  '<div class=\"col-sm-4\">' +","\t                      '<input type=\"number\" class=\"form-control\" id=\"create-disc-speed\" param=\"speed\">' +","\t                  '</div>' +","\t                  '<label for=\"md-add-glide\" class=\"col-sm-2 control-label\">Glide</label>' +","\t                  '<div class=\"col-sm-4\">' +","\t                      '<input type=\"number\" class=\"form-control\" id=\"create-disc-glide\" param=\"glide\">' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-turn\" class=\"col-sm-2 control-label\">Turn</label>' +","\t                  '<div class=\"col-sm-4\">' +","\t                      '<input type=\"number\" class=\"form-control\" id=\"create-disc-turn\" param=\"turn\">' +","\t                  '</div>' +","\t                  '<label for=\"md-add-fade\" class=\"col-sm-2 control-label\">Fade</label>' +","\t                  '<div class=\"col-sm-4\">' +","\t                      '<input type=\"number\" class=\"form-control\" id=\"create-disc-fade\" param=\"fade\">' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-notes\" class=\"col-sm-2 control-label\">Notes</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<textarea class=\"form-control\" id=\"create-discnotes\" rows=\"3\" param=\"notes\"></textarea>' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label class=\"col-sm-2 control-label\">Select Images</label>' +","\t                  '<div class=\"col-sm-5\">' +","\t                      '<a href=\"#\" class=\"thumbnail\">' +","\t                          '<img id=\"img-front\" data-src=\"holder.js/100%x180\" alt=\"Front\">' +","\t                      '</a>' +","\t                  '</div>' +","\t                  '<div class=\"col-sm-5\">' +","\t                      '<a href=\"#\" class=\"thumbnail\">' +","\t                          '<img id=\"img-back\" data-src=\"holder.js/100%x180\" alt=\"Back\">' +","\t                      '</a>' +","\t                  '</div>' +","\t              '</div>');","               ","     var $footer = $('<div></div>').html(","\t\t'<button type=\"button\" id=\"btn-add-disc\" class=\"btn btn-primary\" fn-title=\"create\"><span><i class=\"fa fa-plus-circle fa-tools\"></i></span>Add Disc</button>' +","\t\t'<button type=\"button\" class=\"btn btn-default\" fn-title=\"close\">Close</button>'","\t);","\t","\tvar fns = [","\t\t\t\t{","\t\t\t\t\tname: 'close',","\t\t\t\t\tfunction: function() {","\t\t\t\t\t\tconsole.log('Closed without exporting.');","\t\t\t\t\t}","\t\t\t\t},","\t\t\t\t{","\t\t\t\t\tname: 'create',","\t\t\t\t\tfunction: function($inner) {","\t\t\t\t\t\tvar disc = createDisc($inner);","\t\t\t\t\t\tpostDisc(disc, function(success) {","\t\t\t\t\t\t\tif (success) {","\t\t\t\t\t\t\t\tupdateFilter();","\t\t\t\t\t\t\t} else {","\t\t\t\t\t\t\t\t// error logic","\t\t\t\t\t\t\t}","\t\t\t\t\t\t});","\t\t\t\t\t}","\t\t\t\t}","\t];","     generateModal('Add Disc', $form, $footer, fns);","}","\t","function createDisc($form) {","\tvar disc = {};","\t","\tvar $fields = $form.find('input');","\t$.each($fields, function(index) {","\t\tvar $field = $(this);","\t\tdisc[$field.attr('param')] = $field.val();\t","\t});","\t","\t$fields = $form.find('select');","\t$.each($fields, function(index) {","\t\tvar $field = $(this);","\t\tdisc[$field.attr('param')] = $field.val();\t","\t});","\t","\t$fields = $form.find('textarea');","\t$.each($fields, function(index) {","\t\tvar $field = $(this);","\t\tdisc[$field.attr('param')] = $field.val();\t","\t});","\t","\treturn disc;","\t","}","","var delay = (function(){","  var timer = 0;","  return function(callback, ms){","    clearTimeout (timer);","    timer = setTimeout(callback, ms);","  };","})();","","","/*-------------------------------------------------------------------------------------------*/","/*                                      CONTROLLER JQUERY                                    */","/*-------------------------------------------------------------------------------------------*/","/*","\t\t\t\t\t                      /´¯/) ","\t\t\t\t\t                    ,/¯../ ","\t\t\t\t\t                   /..../ ","\t\t\t\t\t              /´¯/'...'/´¯¯`·¸ ","\t\t\t\t\t          /'/.../..../......./¨¯\\ ","\t\t\t\t\t        ('(...´...´.... ¯~/'...') ","\t\t\t\t\t         \\.................'...../ ","\t\t\t\t\t          ''...\\.......... _.·´ ","\t\t\t\t\t            \\..............( ","\t\t\t\t\t              \\.............\\","*/","/*-------------------------------------------------------------------------------------------*/","","function getAllDiscs(callback) {","\tvar success = false;","     $.ajax({","          type: \"GET\",","          dataType: \"json\",","          url: url + 'discs/',","          contentType: \"application/json\",","          success: function (data) {","               discs = data;","\t\t\tsuccess = true;","          },","          error: function (request, textStatus, errorThrown) {","               console.log(request.responseText);","               console.log(textStatus);","               console.log(errorThrown);","          },","\t\t  complete: function(){","\t\t\t   if (callback) {","\t\t\t\t\tcallback(success);","\t\t\t   }","\t\t  }","     });","}","","function postDisc(disc, callback) {","\t","\tvar success = false;","     $.ajax({","          type: \"POST\",","          dataType: \"json\",","          url: url + 'discs/',","          contentType: \"application/json\",","          data: JSON.stringify(disc),","          success: function (data) {","               discs.push(data);","\t\t\tsuccess = true;","          },","          error: function (request, textStatus, errorThrown) {","               console.log(request.responseText);","               console.log(textStatus);","               console.log(errorThrown);","          },","\t\tcomplete: function(){","\t\t   if (callback) {","\t\t\tcallback(success);","\t\t   }","\t\t}","     });","}","","function getProperties(prop) {","\treturn _.uniq(_.pluck(discs,  prop));","}","","function filterList(filters) {","\treturn _.filter(discs, function(disc) {","\t\tfor (var property in filters) {","\t\t\tif (filters[property].length > 0) {","\t\t\t\tif (_.has(disc, property)) {","\t\t\t\t\tif (!(_.contains(filters[property], String(disc[property])))) {","\t\t\t\t\t\treturn false;","\t\t\t\t\t}","\t\t\t\t} else {","\t\t\t\t\treturn false;","\t\t\t\t}","\t\t\t}","\t\t}","\t\treturn true;","\t});","}","","function containSearch(val, properties, callback) {","\t_.each(properties, function(prop) {","\t\tvar filtered = _.filter(getProperties(prop), function(item) {","\t\t\treturn item.toLowerCase().indexOf(val.toLowerCase()) >= 0;\t","\t\t});","\t\tcallback(prop, filtered);","\t});","}","","function sortList(sorts) {","\t","}","","function getDisc(id) {","\treturn _.first(_.where(discs, {'_id' : id}));","}","","","var url = \"https://disczumpserver-mgagliardo.c9.io/api/\";","","var $searchResults;","var $searchBar;","var $filterResults;","var $footerSort;","var $modalDetails;","","var searchRequest;","","var discList = [];","var discs = [];","var filters = {name: [], brand: [], type: [], material: [], weight: [], color: [], speed: [], glide: [], turn: [], fade: []};","var sort = [{sortProp: 'name', sortType: 'text', sortOn: true, sortAsc: true, sortOrder: 1},","\t\t  {sortProp: 'brand', sortType: 'text', sortOn: true, sortAsc: true, sortOrder: 0},","\t\t  {sortProp: 'type', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'material', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'weight', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'color', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'speed', sortType: 'number', sortOn: false, sortAsc: false, sortOrder: -1},","\t\t  {sortProp: 'glide', sortType: 'number', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'turn', sortType: 'number', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'fade', sortType: 'number', sortOn: false, sortAsc: true, sortOrder: -1}];","var paginateOptions = {displayCount: 20, currentPage: 1, lastPage: 1};","","$(document).ready(function(){","     $searchResults = $('#search-results');","     $searchBar = $('#search-all');","\t$filterResults = $('#filter-results');","\t$footerSort = $('#results-footer-sort');","\t$modalDetails = $('#modal-details');","     ","     $(window).on('resize', function(){","        resizeSearch();  ","     });","     ","     $(window).click(function(e) {","     \tif ($searchResults.is(':visible')) {","     \t\t$searchResults.hide();","     \t}\t","     });","     ","     $searchBar.focusin(function(){","     \t$(this).trigger('keyup');","     }).on('keyup', function(){","     \tdelay(function(){","\t     \tif ($searchBar.val().length > 0) {","\t     \t\tif (!$searchResults.is(':visible')) {","\t     \t\t\t$searchResults.show();","\t     \t\t}","\t               doSearch();","\t          } else {","\t               $searchResults.hide();","\t          }","\t\t}, 200 );","     }).click(function(e) { e.stopPropagation(); });","     ","     $('#search-request').click(function() {","     \t$searchBar.focus();","     });","     ","     $('.panel-heading').on('click', function(){","          var $this = $(this);","          var $panelBody = $this.siblings('.panel-body');","          var $glyph = $this.children('.glyphicon');","          ","          if ($this.hasClass('panel-open')) {","               $panelBody.slideUp(300, function(){","                    $glyph.removeClass('glyphicon-minus');","                    $glyph.addClass('glyphicon-plus');","                    $this.addClass('panel-closed');","               });","               $this.removeClass('panel-open');","          } else if ($this.hasClass('panel-closed')) {","               $panelBody.slideDown(300, function(){","                     $glyph.removeClass('glyphicon-plus');","                    $glyph.addClass('glyphicon-minus');","                    $this.addClass('panel-open');","               });","               $this.removeClass('panel-closed');","          }","     });","\t ","\t $('#export-list').click(function(e){","\t \texportList();","\t });","\t ","\t $(document).on('click', '.filter-option:not(.filter-option-static)', function(e){","\t\t\te.stopPropagation();","\t\t\t","\t\t\tvar $parent = $(this).parents('.filter-item-parent');","\t\t\tvar option = $parent.attr('id').match(/-([a-z]+)/)[1];","\t\t\t","\t\t\tvar child = $(this).children('.glyphicon');","\t\t\tif (child.length > 0) {","\t\t\t\tchild.remove();","\t\t\t\tfilters[option] = _.without(filters[option], $(this).text());","\t\t\t} else {","\t\t\t\t$(this).append('<span class=\"glyphicon glyphicon-ok pull-right\" aria-hidden=\"true\"></span>');","\t\t\t\tif (!_.contains(filters[option], $(this).text())) {","\t\t\t\t\tfilters[option].push($(this).text());","\t\t\t\t}","\t\t\t}","\t\t\tupdateFilter();","\t  });","\t  ","\t  $(document).on('click', '.result-item:not(.result-item-empty)', function(e) {","\t  \t\te.stopPropagation();","\t  \t\tvar $parent = $(this).parents('.result-section');","\t\t\tvar option = $parent.attr('id').match(/-([a-z]+)/)[1];","\t\t\tvar val = $(this).text();","\t\t\t","\t  \t\tif (option == 'name') {","\t  \t\t\tfilters.name.push(val);","\t  \t\t\t$searchBar.val(val).attr('readonly', true);","\t  \t\t\t$searchBar.bind('click', searchLock);","\t  \t\t\tupdateFilter();","\t  \t\t} else {","\t  \t\t\t$searchBar.val('');","\t  \t\t\tvar $filterOption = $('#filter-' + option);","\t  \t\t\t$filterOption.find('.filter-option').find('.glyphicon').remove();","\t  \t\t\tfilters[option] = [];","\t  \t\t\t$filterOption.find('.filter-option:contains(' + val + ')').trigger('click');","\t  \t\t}","\t  \t\t","\t  \t\t$searchResults.hide();","\t  });","     ","     $('.filter-option-multi').on('click', function(e){","\t\t  if ($(e.target).attr('class') == 'filter-option') {","\t\t\treturn;","\t\t  }","\t ","          var $this = $(this);","          var $itemGroup = $this.children('.filter-option-group');","               ","          if ($this.hasClass('filter-option-multi-closed')) {","               $itemGroup.slideDown(300, function(){","                    $this.addClass(('filter-option-multi-open'));","               });","               $this.removeClass('filter-option-multi-closed');","          } else {","               $itemGroup.slideUp(300, function(){","                    $this.addClass('filter-option-multi-closed');","               });","               $this.removeClass('filter-option-multi-open');","          }","     });","     ","     $('.heading-text').click(function(){","     \tvar glyph = $(this).children('.glyphicon');","     \ttrySort($(this), function(sorter) {","     \t\tif (!sorter.sortOn) {","     \t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","     \t\t} else {","     \t\t\tif (sorter.sortAsc) {","     \t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","     \t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet');","     \t\t\t} else {","     \t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet');","     \t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet-alt');","     \t\t\t}","     \t\t\tglyph.show();","     \t\t}","     \t});","     });","     ","\t $(document).on('click', '.disc-item', function() {","\t \tvar disc = getDisc($(this).attr('discid'));","\t \t$modalDetails.empty();","\t\t$modalDetails.append(generateModalTemplate(disc));","\t \t$('#viewDiscModal').modal('show');","\t });","\t ","\t $(document).on('click', '.page-dynamic', function() {","\t \tvar page = parseInt($(this).text());","\t \tpaginateOptions.currentPage = page;","\t \tshowDiscs(true);","\t });","\t ","\t $('#page-back').click(function(){","\t \tpaginateOptions.currentPage -= 1;\t","\t \tshowDiscs(true);","\t });","\t ","\t $('#page-forward').click(function(){","\t \tpaginateOptions.currentPage += 1;","\t \tshowDiscs(true);\t","\t });","\t ","\t $('#paginate-display-count').on('change', function(){","\t \tvar val = $(this).val();","\t \tval = parseInt(val);","\t \tif (_.isNaN(val)) {","\t \t\tpaginateOptions.displayCount = -1;","\t \t\tpaginateOptions.currentPage = 1;","\t \t} else {","\t \t\tpaginateOptions.displayCount = parseInt(val);","\t \t}","\t \t","\t \tshowDiscs();","\t });","\t ","\t$('#createDiscForm').submit(function(e){","\t\te.preventDefault();","\t\tvar disc = createDisc($(this));;","\t\t","\t\tpostDisc(disc, function(success) {","\t\t\tupdateFilter();","\t\t});","\t});","\t","\t","     // Start on-load commands","     ","     resizeSearch();","     $searchResults.hide();","     getAllDiscs(function(success){","\t\tif (success) {","\t\t\tinitialize();","\t\t} else {","\t\t\talert('Unable to intialize');","\t\t}","\t });","});","","var searchLock = function(e) {","\te.stopPropagation();","\tfilters.name = [];","\t$(this).attr('readonly', false).unbind('click', searchLock);","\tupdateFilter();","\t$searchBar.trigger('keyup');","};","","function doSearch() {","\tvar search = $searchBar.val();","\t","\tcontainSearch(search, ['name', 'brand', 'type'], function(prop, list) {","\t\tif (prop == 'name') {","\t\t\tupdateSearchResults($('#results-name'), list);","\t\t} else if (prop == 'brand') {","\t\t\tupdateSearchResults($('#results-brand'), list);","\t\t} else if (prop == 'type') {","\t\t\tupdateSearchResults($('#results-type'), list);","\t\t}","\t});","}","","function updateSearchResults($section, list) {","\tvar $output = $section.children('.result-section-output');","\t$output.children('.result-item:not(.result-item-empty)').remove();","\tif (list.length > 0) {","\t\t$output.children('.result-item-empty').hide();","\t\t_.each(list, function(result) {","\t\t\t$output.append(generateResultItem(result));","\t\t});","\t} else {","\t\t$output.children('.result-item-empty').show();","\t}","}","","function generateResultItem(item) {","\treturn '<div class=\"result-item\">' + item +","    \t\t'<span class=\"glyphicon glyphicon-leaf pull-left\" aria-hidden=\"true\"></span>' + ","\t\t'</div>';","}","","function updateFilter() {","\tdiscList = filterList(filters);","\tshowDiscs();","}","","function resizeSearch() {","     if ($searchResults.is(':visible')) {","          $searchResults.width($searchBar.outerWidth());","          $searchResults.css({left: $searchBar.offset().left, ","          top: $searchBar.offset().top + $searchBar.outerHeight()});","     }","};","","function initialize() {","\t\tdiscList = discs;","\t\tgenerateFilters($('#filter-brand'), '.panel-body', getProperties('brand'));","\t\tgenerateFilters($('#filter-type'), '.panel-body', getProperties('type'));","\t\tgenerateFilters($('#filter-material'), '.panel-body', getProperties('material'));","\t\tgenerateFilters($('#filter-weight'), '.panel-body', getProperties('weight'));","\t\tgenerateFilters($('#filter-color'), '.panel-body', getProperties('color'));","\t\tgenerateFilters($('#filter-speed'), '.filter-option-group', getProperties('speed'));","\t\tgenerateFilters($('#filter-glide'), '.filter-option-group', getProperties('glide'));","\t\tgenerateFilters($('#filter-turn'), '.filter-option-group', getProperties('turn'));","\t\tgenerateFilters($('#filter-fade'), '.filter-option-group', getProperties('fade'));","\t\tshowDiscs();","}","","function generateFilters($option, query, items) {","\tvar filterBody = $option.find(query);","\tif (items.length > 0) {","\t\t$option.find('div.filter-option-static').hide();","\t\t_.each(items, function(item) {","\t\t\tfilterBody.append(generateFilterOption(item));","\t\t});","\t} else {","\t\t$option.find('div.filter-option-static').show();","\t}","}","","function generateFilterOption(option) {","\treturn '<div class=\"filter-option\">' + option + '</div>';","}","","function showDiscs(maintainPage) {","\tif (!maintainPage) {","\t\tpaginateOptions.currentPage = 1;","\t}","\t","\t$filterResults.empty();","\tvar sorted = sortDiscs(discList);","\tvar paged = paginate(sorted);","\t_.each(paged, function(disc) {","\t\t$filterResults.append(generateDiscTemplate(disc));","\t});","\tupdateFooter(sorted.length);","}","","function updateFooter(count) {","\t$('#results-footer-count').text('Results: ' + count);","\t$footerSort.text('Sort: ' + (_.where(sort, {sortOn: true}).length > 0 ? 'On' : 'Off'));","\t","\tvar $paginate = $('#paginate-nav');","\tvar $pageInsert = $('#page-back');","\t$paginate.find('.page-dynamic').remove();","\t","\tvar start = 1;","\tvar end = 5;","\t","\tif (paginateOptions.currentPage < 3) {","\t\tend = Math.min(5, paginateOptions.lastPage);","\t} else if (paginateOptions.currentPage > paginateOptions.lastPage - 2) {","\t\tend = paginateOptions.lastPage;","\t\tstart = Math.max(1, paginateOptions.lastPage - 4);","\t} else {","\t\tstart = paginateOptions.currentPage - 2;","\t\tend = paginateOptions.currentPage + 2;","\t}","\t","\tfor (var i = end; i >= start; i--) {","\t\t$pageInsert.after('<li class=\"page-dynamic' + (i == paginateOptions.currentPage ? ' active' : '') + '\">' + i + '</li>');","\t}","}","","function generateDiscTemplate(disc) {","\treturn '<tr class=\"disc-item\" discId=\"' + disc._id + '\">' +","\t\t  \t'<td class=\"disc-brand\">' + disc.brand + '</td>' +","\t\t  \t'<td class=\"disc-name\">' + disc.name + '</td>' +","\t\t  \t'<td class=\"disc-material\">' + disc.material + '</td>' +","\t\t  \t'<td class=\"disc-type\">' + disc.type + '</td>' +","\t\t  \t'<td class=\"disc-speed\">' + disc.speed + '</td>' +","\t\t  \t'<td class=\"disc-glide\">' + disc.glide + '</td>' +","\t\t  \t'<td class=\"disc-turn\">' + disc.turn + '</td>' +","\t\t  \t'<td class=\"disc-fade\">' + disc.fade + '</td>' +","\t\t  '</tr>';","}","","function generateModalTemplate(disc) {","\treturn '<p>' + disc.type + '</p>' +","\t\t\t'<p>' + disc.material + '</p>' +","\t\t\t'<p>' + disc.color + '</p>' +","\t\t\t'<p>' + disc.weight + '</p>' +","\t\t\t'<p>' + disc.speed + '</p>' +","\t\t\t'<p>' + disc.glide + '</p>' +","\t\t\t'<p>' + disc.turn + '</p>' +","\t\t\t'<p>' + disc.fade + '</p>'","}","","function trySort($sortHeader, callback) {","\tvar sorter = _.first(_.where(sort, {'sortProp': $sortHeader.text().toLowerCase().trim()}));","\tif (sorter !== undefined) {","\t\tvar isOn = sorter.sortOn;","\t\tsorter.sortAsc = !(isOn && sorter.sortAsc);","\t\tsorter.sortOn = !(isOn && sorter.sortAsc);","\t\t","\t\tvar order = _.max(_.pluck(sort, 'sortOrder')) + 1;","\t\tsorter.sortOrder = sorter.sortOn ? (isOn ? sorter.sortOrder : order) : -1;","\t\tshowDiscs();","\t\t","\t\tif (callback) {","\t\t\tcallback(sorter);","\t\t}","\t}","}","","function genericSort(sorter, array) {","\tif (sorter.sortType == 'number') {","\t\tarray = _.sortBy(array, function(disc) { return parseInt(disc[sorter.sortProp])});","\t} else {","\t\tarray = _.sortBy(array, sorter.sortProp);","\t}","\t","\tif (!sorter.sortAsc) {","\t\tarray = array.reverse();","\t}","\t","\treturn array;","}","","function sortDiscs() {","\tvar toSort = _.sortBy(_.where(sort, {sortOn : true}), 'sortOrder');","\tvar sorted = discList;","\t","\tvar lastSort;","\t_.each(toSort, function(sorter) {","\t\tif (typeof lastSort === 'undefined') {","\t\t\tsorted = genericSort(sorter, sorted);","\t\t} else {","\t\t\tvar parentVals = _.groupBy(sorted, function(disc) { return disc[lastSort.sortProp]; });","\t\t\tvar newArray = [];","\t\t\t_.each(parentVals, function(valArray) {","\t\t\t\tvalArray = genericSort(sorter, valArray);","\t\t\t\tnewArray = newArray.concat(valArray);","\t\t\t});","\t\t\tsorted = newArray;","\t\t}","\t\tlastSort = sorter;","\t});","\t ","\t if (toSort.length) {","\t \t$footerSort.popover({","\t\t \tanimation: true,","\t\t \thtml: true,","\t\t \tcontent: function(){","\t\t \t\t\tvar sortMethod = _.pluck(_.where(sort, {sortOn : true}), 'sortProp');","\t\t\t\t\tvar sortText = '<ol class=\"sort-text\">'","\t\t\t\t\t_.each(sortMethod, function(method) {","\t\t\t\t\t\tsortText += '<li>' + method + '</li>';\t","\t\t\t\t\t});","\t\t\t\t\tsortText += '</ol>';","\t\t\t\t\treturn sortText;","\t\t \t},","\t\t \tplacement: 'bottom',","\t\t \ttrigger: 'hover'","\t\t });","\t } else {","\t \t$footerSort.popover('destroy');","\t }","\t ","\t _.each(sort, function(sorter) {","\t\tglyph = $('#sort-' + sorter.sortProp).find('.glyphicon');","\t\tif (!sorter.sortOn) {","\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","\t\t} else {","\t\t\tif (sorter.sortAsc) {","\t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","\t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet');","\t\t\t} else {","\t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet');","\t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet-alt');","\t\t\t}","\t\t\tglyph.show();","\t\t}","\t });","\t ","\treturn sorted;","}","","function paginate(toPaginate) {","\tvar lastPage = 1;","\t","\tif (paginateOptions.displayCount > -1) {","\t\tlastPage = Math.ceil((toPaginate.length / paginateOptions.displayCount));","\t}","\t","\tpaginateOptions.lastPage = lastPage;","\tif (paginateOptions.currentPage > lastPage) {","\t\tpaginateOptions.currentPage = lastPage;","\t}","\t","\tif (paginateOptions.currentPage < 1) paginateOptions.currentPage = 1;","\t","\tvar start = (paginateOptions.currentPage - 1) * paginateOptions.displayCount;","\tvar end = Math.min(toPaginate.length, start + paginateOptions.displayCount);","\treturn toPaginate.slice(start, end);","}","","function exportList() {","\tvar $form =  $('<form class=\"form\" role=\"form\"></form>');","\t$form.html('<div class=\"form-group\">' + ","\t\t\t\t'<label for=\"exportFileName\">File Name</label>' +","\t\t\t\t'<input type=\"text\" class=\"form-control\" id=\"exportFileName\" placeholder=\"File Name\">' +","\t  \t\t'</div>' +","\t  \t\t'<div class=\"radio\">' +","\t\t\t\t'<label>' +","\t\t\t\t\t'<input type=\"radio\" name=\"exportOptions\" id=\"exportAll\" value=\"all\" checked>' +","\t\t\t\t\t'Export All Discs' +","\t\t\t\t'</label>' +","\t\t\t'</div>' +","\t\t\t'<div class=\"radio\">' +","\t\t\t\t'<label>' +","\t\t\t\t\t'<input type=\"radio\" name=\"exportOptions\" id=\"exportFiltered\" value=\"filtered\">' +","\t\t\t\t\t'Export Filtered Discs' +","\t\t\t\t'</label>' +","\t\t\t'</div>');","\tgenerateModal('Export List', $form, 'Export', function(success, $inner) {","\t\tif (success) {","\t\t\tvar fileName = $inner.find('#exportFileName').val();","\t\t\tvar type = $inner.find('input:radio:checked').val();","\t\t\t","\t\t\tif (fileName == '') {","\t\t\t\tvar dt = new Date();","\t\t\t\tvar time = dt.getHours() + '_' + dt.getMinutes() + '_' + dt.getSeconds();","\t\t\t\tfileName = 'DiscZump_' + time;","\t\t\t}","\t\t\t","\t\t\tvar csvContent = \"data:text/csv;charset=utf-8,\";","\t\t\tvar writeHeaders = true;","\t\t\tvar list = discs;","\t\t\tif (type == 'filtered') {","\t\t\t\tlist = discList;","\t\t\t}","\t\t\t","\t\t\t_.each(list, function(disc) {","\t\t\t\tif (writeHeaders) {","\t\t\t\t\tcsvContent += _.map(_.keys(disc), function(key) {return key.toUpperCase();}).join(',') + '\\n';","\t\t\t\t\twriteHeaders = false;","\t\t\t\t}","\t\t\t\t","\t\t\t\tcsvContent += _.values(disc).join(',') + '\\n';\t","\t\t\t});","\t\t\t","\t\t\tvar encodedUri = encodeURI(csvContent);","\t\t\tvar link = document.createElement(\"a\");","\t\t\tlink.setAttribute('href', encodedUri);","\t\t\tlink.setAttribute('download', fileName + '.csv');","\t\t\tlink.click();","\t\t}","\t\t","\t});","}","","function generateModal(title, $body, event, callback) {","\t$('.custom-modal').remove();","\tvar bodyText = '';","\tif ($body) {","\t\tbodyText = $('<div></div>').append($body).html();","\t}","\tvar $modal = $('<div class=\"modal custom-modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"></div>');","\t$modal.html('<div class=\"modal-dialog\">' + ","            '<div class=\"modal-content\">' + ","              '<div class=\"modal-header\">' + ","                '<h4 class=\"modal-title\">' + (title ? title : '') + '</h4>' + ","              '</div>' + ","              '<div class=\"modal-body\">' + bodyText + ","              '</div>' + ","              '<div class=\"modal-footer\">' + ","                '<button type=\"button\" class=\"btn btn-default modal-close\">Close</button>' + ","                '<button type=\"button\" class=\"btn btn-primary modal-success\">' + (event ? event : '') + '</button>' + ","              '</div>' + ","            '</div>' + ","            '</div>');","     $('body').append($modal);","     $modal.find('.modal-close').on('click', function(){","     \tif (callback) callback(false);\t","     \t$modal.modal('hide');","     });","     $modal.find('.modal-success').on('click', function(){","     \tif (callback) callback(true, $modal.find('.modal-body'));","     \t$modal.modal('hide');","     });","     $modal.on('hidden.bs.modal', function (e) {","\t  $modal.remove();","\t});","     $modal.modal({show: true, backdrop: 'static'});","}","","function createDisc($form) {","\tvar disc = {};","\t","\tvar $fields = $form.find('input');","\t$.each($fields, function(index) {","\t\tvar $field = $(this);","\t\tdisc[$field.attr('param')] = $field.val();\t","\t});","\t","\t$fields = $form.find('select');","\t$.each($fields, function(index) {","\t\tvar $field = $(this);","\t\tdisc[$field.attr('param')] = $field.val();\t","\t});","\t","\t$fields = $form.find('textarea');","\t$.each($fields, function(index) {","\t\tvar $field = $(this);","\t\tdisc[$field.attr('param')] = $field.val();\t","\t});","\t","\treturn disc;","\t","}","","var delay = (function(){","  var timer = 0;","  return function(callback, ms){","    clearTimeout (timer);","    timer = setTimeout(callback, ms);","  };","})();","","","/*-------------------------------------------------------------------------------------------*/","/*                                      CONTROLLER JQUERY                                    */","/*-------------------------------------------------------------------------------------------*/","/*","\t\t\t\t\t                      /´¯/) ","\t\t\t\t\t                    ,/¯../ ","\t\t\t\t\t                   /..../ ","\t\t\t\t\t              /´¯/'...'/´¯¯`·¸ ","\t\t\t\t\t          /'/.../..../......./¨¯\\ ","\t\t\t\t\t        ('(...´...´.... ¯~/'...') ","\t\t\t\t\t         \\.................'...../ ","\t\t\t\t\t          ''...\\.......... _.·´ ","\t\t\t\t\t            \\..............( ","\t\t\t\t\t              \\.............\\","*/","/*-------------------------------------------------------------------------------------------*/","","function getAllDiscs(callback) {","\tvar success = false;","     $.ajax({","          type: \"GET\",","          dataType: \"json\",","          url: url + 'discs/',","          contentType: \"application/json\",","          success: function (data) {","               discs = data;","\t\t\tsuccess = true;","          },","          error: function (request, textStatus, errorThrown) {","               console.log(request.responseText);","               console.log(textStatus);","               console.log(errorThrown);","          },","\t\t  complete: function(){","\t\t\t   if (callback) {","\t\t\t\t\tcallback(success);","\t\t\t   }","\t\t  }","     });","}","","function postDisc(disc, callback) {","\t","\tvar success = false;","     $.ajax({","          type: \"POST\",","          dataType: \"json\",","          url: url + 'discs/',","          contentType: \"application/json\",","          data: JSON.stringify(disc),","          success: function (data) {","               discs.push(data);","\t\t\tsuccess = true;","          },","          error: function (request, textStatus, errorThrown) {","               console.log(request.responseText);","               console.log(textStatus);","               console.log(errorThrown);","          },","\t\t  complete: function(){","\t\t\t   if (callback) {","\t\t\t\t\tcallback(success);","\t\t\t   }","\t\t  }","     });","}","","function getProperties(prop) {","\treturn _.uniq(_.pluck(discs,  prop));","}","","function filterList(filters) {","\treturn _.filter(discs, function(disc) {","\t\tfor (var property in filters) {","\t\t\tif (filters[property].length > 0) {","\t\t\t\tif (_.has(disc, property)) {","\t\t\t\t\tif (!(_.contains(filters[property], String(disc[property])))) {","\t\t\t\t\t\treturn false;","\t\t\t\t\t}","\t\t\t\t} else {","\t\t\t\t\treturn false;","\t\t\t\t}","\t\t\t}","\t\t}","\t\treturn true;","\t});","}","","function containSearch(val, properties, callback) {","\t_.each(properties, function(prop) {","\t\tvar filtered = _.filter(getProperties(prop), function(item) {","\t\t\treturn item.toLowerCase().indexOf(val.toLowerCase()) >= 0;\t","\t\t});","\t\tcallback(prop, filtered);","\t});","}","","function sortList(sorts) {","\t","}","","function getDisc(id) {","\treturn _.first(_.where(discs, {'_id' : id}));","}","","",""]},{"start":{"row":0,"column":0},"end":{"row":859,"column":0},"action":"insert","lines":["var url = \"https://disczumpserver-mgagliardo.c9.io/api/\";","","var $searchResults;","var $searchBar;","var $filterResults;","var $footerSort;","var $modalDetails;","","var searchRequest;","","var discList = [];","var discs = [];","var filters = {name: [], brand: [], type: [], material: [], weight: [], color: [], speed: [], glide: [], turn: [], fade: []};","var sort = [{sortProp: 'name', sortType: 'text', sortOn: true, sortAsc: true, sortOrder: 1},","\t\t  {sortProp: 'brand', sortType: 'text', sortOn: true, sortAsc: true, sortOrder: 0},","\t\t  {sortProp: 'type', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'material', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'weight', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'color', sortType: 'text', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'speed', sortType: 'number', sortOn: false, sortAsc: false, sortOrder: -1},","\t\t  {sortProp: 'glide', sortType: 'number', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'turn', sortType: 'number', sortOn: false, sortAsc: true, sortOrder: -1},","\t\t  {sortProp: 'fade', sortType: 'number', sortOn: false, sortAsc: true, sortOrder: -1}];","var paginateOptions = {displayCount: 20, currentPage: 1, lastPage: 1};","","$(document).ready(function(){","     $searchResults = $('#search-results');","     $searchBar = $('#search-all');","\t$filterResults = $('#filter-results');","\t$footerSort = $('#results-footer-sort');","\t$modalDetails = $('#modal-details');","     ","     $(window).on('resize', function(){","        resizeSearch();  ","     });","     ","     $(window).click(function(e) {","     \tif ($searchResults.is(':visible')) {","     \t\t$searchResults.hide();","     \t}\t","     });","     ","     $searchBar.focusin(function(){","     \t$(this).trigger('keyup');","     }).on('keyup', function(){","     \tdelay(function(){","\t     \tif ($searchBar.val().length > 0) {","\t     \t\tif (!$searchResults.is(':visible')) {","\t     \t\t\t$searchResults.show();","\t     \t\t}","\t               doSearch();","\t          } else {","\t               $searchResults.hide();","\t          }","\t\t}, 200 );","     }).click(function(e) { e.stopPropagation(); });","     ","     $('#search-request').click(function() {","     \t$searchBar.focus();","     });","     ","     $('.panel-heading').on('click', function(){","          var $this = $(this);","          var $panelBody = $this.siblings('.panel-body');","          var $glyph = $this.children('.glyphicon');","          ","          if ($this.hasClass('panel-open')) {","               $panelBody.slideUp(300, function(){","                    $glyph.removeClass('glyphicon-minus');","                    $glyph.addClass('glyphicon-plus');","                    $this.addClass('panel-closed');","               });","               $this.removeClass('panel-open');","          } else if ($this.hasClass('panel-closed')) {","               $panelBody.slideDown(300, function(){","                     $glyph.removeClass('glyphicon-plus');","                    $glyph.addClass('glyphicon-minus');","                    $this.addClass('panel-open');","               });","               $this.removeClass('panel-closed');","          }","     });","\t ","\t $('#export-list').click(function(e){","\t \texportList();","\t });","\t ","\t $('#create-disc-modal').click(function(e){","\t \tgenerateCreateDiscForm();","\t });","\t ","\t $(document).on('click', '.filter-option:not(.filter-option-static)', function(e){","\t\t\te.stopPropagation();","\t\t\t","\t\t\tvar $parent = $(this).parents('.filter-item-parent');","\t\t\tvar option = $parent.attr('id').match(/-([a-z]+)/)[1];","\t\t\t","\t\t\tvar child = $(this).children('.glyphicon');","\t\t\tif (child.length > 0) {","\t\t\t\tchild.remove();","\t\t\t\tfilters[option] = _.without(filters[option], $(this).text());","\t\t\t} else {","\t\t\t\t$(this).append('<span class=\"glyphicon glyphicon-ok pull-right\" aria-hidden=\"true\"></span>');","\t\t\t\tif (!_.contains(filters[option], $(this).text())) {","\t\t\t\t\tfilters[option].push($(this).text());","\t\t\t\t}","\t\t\t}","\t\t\tupdateFilter();","\t  });","\t  ","\t  $(document).on('click', '.result-item:not(.result-item-empty)', function(e) {","\t  \t\te.stopPropagation();","\t  \t\tvar $parent = $(this).parents('.result-section');","\t\t\tvar option = $parent.attr('id').match(/-([a-z]+)/)[1];","\t\t\tvar val = $(this).text();","\t\t\t","\t  \t\tif (option == 'name') {","\t  \t\t\tfilters.name.push(val);","\t  \t\t\t$searchBar.val(val).attr('readonly', true);","\t  \t\t\t$searchBar.bind('click', searchLock);","\t  \t\t\tupdateFilter();","\t  \t\t} else {","\t  \t\t\t$searchBar.val('');","\t  \t\t\tvar $filterOption = $('#filter-' + option);","\t  \t\t\t$filterOption.find('.filter-option').find('.glyphicon').remove();","\t  \t\t\tfilters[option] = [];","\t  \t\t\t$filterOption.find('.filter-option:contains(' + val + ')').trigger('click');","\t  \t\t}","\t  \t\t","\t  \t\t$searchResults.hide();","\t  });","     ","     $('.filter-option-multi').on('click', function(e){","\t\t  if ($(e.target).attr('class') == 'filter-option') {","\t\t\treturn;","\t\t  }","\t ","          var $this = $(this);","          var $itemGroup = $this.children('.filter-option-group');","               ","          if ($this.hasClass('filter-option-multi-closed')) {","               $itemGroup.slideDown(300, function(){","                    $this.addClass(('filter-option-multi-open'));","               });","               $this.removeClass('filter-option-multi-closed');","          } else {","               $itemGroup.slideUp(300, function(){","                    $this.addClass('filter-option-multi-closed');","               });","               $this.removeClass('filter-option-multi-open');","          }","     });","     ","     $('.heading-text').click(function(){","     \tvar glyph = $(this).children('.glyphicon');","     \ttrySort($(this), function(sorter) {","     \t\tif (!sorter.sortOn) {","     \t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","     \t\t} else {","     \t\t\tif (sorter.sortAsc) {","     \t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","     \t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet');","     \t\t\t} else {","     \t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet');","     \t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet-alt');","     \t\t\t}","     \t\t\tglyph.show();","     \t\t}","     \t});","     });","     ","\t $(document).on('click', '.disc-item', function() {","\t \tvar disc = getDisc($(this).attr('discid'));","\t \t$modalDetails.empty();","\t\t$modalDetails.append(generateModalTemplate(disc));","\t \t$('#viewDiscModal').modal('show');","\t });","\t ","\t $(document).on('click', '.page-dynamic', function() {","\t \tvar page = parseInt($(this).text());","\t \tpaginateOptions.currentPage = page;","\t \tshowDiscs(true);","\t });","\t ","\t $('#page-back').click(function(){","\t \tpaginateOptions.currentPage -= 1;\t","\t \tshowDiscs(true);","\t });","\t ","\t $('#page-forward').click(function(){","\t \tpaginateOptions.currentPage += 1;","\t \tshowDiscs(true);\t","\t });","\t ","\t $('#paginate-display-count').on('change', function(){","\t \tvar val = $(this).val();","\t \tval = parseInt(val);","\t \tif (_.isNaN(val)) {","\t \t\tpaginateOptions.displayCount = -1;","\t \t\tpaginateOptions.currentPage = 1;","\t \t} else {","\t \t\tpaginateOptions.displayCount = parseInt(val);","\t \t}","\t \t","\t \tshowDiscs();","\t });","\t ","\t$('#createDiscForm').submit(function(e){","\t\te.preventDefault();","\t\tvar disc = createDisc($(this));","\t\tpostDisc(disc, function(success) {","\t\t\tif (success) {","\t\t\t\tupdateFilter();","\t\t\t} else {","\t\t\t\t// error logic","\t\t\t}","\t\t\t","\t\t\t$('#createDiscModal').modal('hide');","\t\t});","\t});","\t","\t","     // Start on-load commands","     ","     resizeSearch();","     $searchResults.hide();","     getAllDiscs(function(success){","\t\tif (success) {","\t\t\tinitialize();","\t\t} else {","\t\t\talert('Unable to intialize');","\t\t}","\t });","});","","var searchLock = function(e) {","\te.stopPropagation();","\tfilters.name = [];","\t$(this).attr('readonly', false).unbind('click', searchLock);","\tupdateFilter();","\t$searchBar.trigger('keyup');","};","","function doSearch() {","\tvar search = $searchBar.val();","\t","\tcontainSearch(search, ['name', 'brand', 'type'], function(prop, list) {","\t\tif (prop == 'name') {","\t\t\tupdateSearchResults($('#results-name'), list);","\t\t} else if (prop == 'brand') {","\t\t\tupdateSearchResults($('#results-brand'), list);","\t\t} else if (prop == 'type') {","\t\t\tupdateSearchResults($('#results-type'), list);","\t\t}","\t});","}","","function updateSearchResults($section, list) {","\tvar $output = $section.children('.result-section-output');","\t$output.children('.result-item:not(.result-item-empty)').remove();","\tif (list.length > 0) {","\t\t$output.children('.result-item-empty').hide();","\t\t_.each(list, function(result) {","\t\t\t$output.append(generateResultItem(result));","\t\t});","\t} else {","\t\t$output.children('.result-item-empty').show();","\t}","}","","function generateResultItem(item) {","\treturn '<div class=\"result-item\">' + item +","    \t\t'<span class=\"glyphicon glyphicon-leaf pull-left\" aria-hidden=\"true\"></span>' + ","\t\t'</div>';","}","","function updateFilter() {","\tdiscList = filterList(filters);","\tshowDiscs();","}","","function resizeSearch() {","     if ($searchResults.is(':visible')) {","          $searchResults.width($searchBar.outerWidth());","          $searchResults.css({left: $searchBar.offset().left, ","          top: $searchBar.offset().top + $searchBar.outerHeight()});","     }","};","","function initialize() {","\t\tdiscList = discs;","\t\tgenerateFilters($('#filter-brand'), '.panel-body', getProperties('brand'));","\t\tgenerateFilters($('#filter-type'), '.panel-body', getProperties('type'));","\t\tgenerateFilters($('#filter-material'), '.panel-body', getProperties('material'));","\t\tgenerateFilters($('#filter-weight'), '.panel-body', getProperties('weight'));","\t\tgenerateFilters($('#filter-color'), '.panel-body', getProperties('color'));","\t\tgenerateFilters($('#filter-speed'), '.filter-option-group', getProperties('speed'));","\t\tgenerateFilters($('#filter-glide'), '.filter-option-group', getProperties('glide'));","\t\tgenerateFilters($('#filter-turn'), '.filter-option-group', getProperties('turn'));","\t\tgenerateFilters($('#filter-fade'), '.filter-option-group', getProperties('fade'));","\t\tshowDiscs();","}","","function generateFilters($option, query, items) {","\tvar filterBody = $option.find(query);","\tif (items.length > 0) {","\t\t$option.find('div.filter-option-static').hide();","\t\t_.each(items, function(item) {","\t\t\tfilterBody.append(generateFilterOption(item));","\t\t});","\t} else {","\t\t$option.find('div.filter-option-static').show();","\t}","}","","function generateFilterOption(option) {","\treturn '<div class=\"filter-option\">' + option + '</div>';","}","","function showDiscs(maintainPage) {","\tif (!maintainPage) {","\t\tpaginateOptions.currentPage = 1;","\t}","\t","\t$filterResults.empty();","\tvar sorted = sortDiscs(discList);","\tvar paged = paginate(sorted);","\t_.each(paged, function(disc) {","\t\t$filterResults.append(generateDiscTemplate(disc));","\t});","\tupdateFooter(sorted.length);","}","","function updateFooter(count) {","\t$('#results-footer-count').text('Results: ' + count);","\t$footerSort.text('Sort: ' + (_.where(sort, {sortOn: true}).length > 0 ? 'On' : 'Off'));","\t","\tvar $paginate = $('#paginate-nav');","\tvar $pageInsert = $('#page-back');","\t$paginate.find('.page-dynamic').remove();","\t","\tvar start = 1;","\tvar end = 5;","\t","\tif (paginateOptions.currentPage < 3) {","\t\tend = Math.min(5, paginateOptions.lastPage);","\t} else if (paginateOptions.currentPage > paginateOptions.lastPage - 2) {","\t\tend = paginateOptions.lastPage;","\t\tstart = Math.max(1, paginateOptions.lastPage - 4);","\t} else {","\t\tstart = paginateOptions.currentPage - 2;","\t\tend = paginateOptions.currentPage + 2;","\t}","\t","\tfor (var i = end; i >= start; i--) {","\t\t$pageInsert.after('<li class=\"page-dynamic' + (i == paginateOptions.currentPage ? ' active' : '') + '\">' + i + '</li>');","\t}","}","","function generateDiscTemplate(disc) {","\treturn '<tr class=\"disc-item\" discId=\"' + disc._id + '\">' +","\t\t  \t'<td class=\"disc-brand\">' + disc.brand + '</td>' +","\t\t  \t'<td class=\"disc-name\">' + disc.name + '</td>' +","\t\t  \t'<td class=\"disc-material\">' + disc.material + '</td>' +","\t\t  \t'<td class=\"disc-type\">' + disc.type + '</td>' +","\t\t  \t'<td class=\"disc-speed\">' + disc.speed + '</td>' +","\t\t  \t'<td class=\"disc-glide\">' + disc.glide + '</td>' +","\t\t  \t'<td class=\"disc-turn\">' + disc.turn + '</td>' +","\t\t  \t'<td class=\"disc-fade\">' + disc.fade + '</td>' +","\t\t  '</tr>';","}","","function generateModalTemplate(disc) {","\treturn '<p>' + disc.type + '</p>' +","\t\t\t'<p>' + disc.material + '</p>' +","\t\t\t'<p>' + disc.color + '</p>' +","\t\t\t'<p>' + disc.weight + '</p>' +","\t\t\t'<p>' + disc.speed + '</p>' +","\t\t\t'<p>' + disc.glide + '</p>' +","\t\t\t'<p>' + disc.turn + '</p>' +","\t\t\t'<p>' + disc.fade + '</p>'","}","","function trySort($sortHeader, callback) {","\tvar sorter = _.first(_.where(sort, {'sortProp': $sortHeader.text().toLowerCase().trim()}));","\tif (sorter !== undefined) {","\t\tvar isOn = sorter.sortOn;","\t\tsorter.sortAsc = !(isOn && sorter.sortAsc);","\t\tsorter.sortOn = !(isOn && sorter.sortAsc);","\t\t","\t\tvar order = _.max(_.pluck(sort, 'sortOrder')) + 1;","\t\tsorter.sortOrder = sorter.sortOn ? (isOn ? sorter.sortOrder : order) : -1;","\t\tshowDiscs();","\t\t","\t\tif (callback) {","\t\t\tcallback(sorter);","\t\t}","\t}","}","","function genericSort(sorter, array) {","\tif (sorter.sortType == 'number') {","\t\tarray = _.sortBy(array, function(disc) { return parseInt(disc[sorter.sortProp])});","\t} else {","\t\tarray = _.sortBy(array, sorter.sortProp);","\t}","\t","\tif (!sorter.sortAsc) {","\t\tarray = array.reverse();","\t}","\t","\treturn array;","}","","function sortDiscs() {","\tvar toSort = _.sortBy(_.where(sort, {sortOn : true}), 'sortOrder');","\tvar sorted = discList;","\t","\tvar lastSort;","\t_.each(toSort, function(sorter) {","\t\tif (typeof lastSort === 'undefined') {","\t\t\tsorted = genericSort(sorter, sorted);","\t\t} else {","\t\t\tvar parentVals = _.groupBy(sorted, function(disc) { return disc[lastSort.sortProp]; });","\t\t\tvar newArray = [];","\t\t\t_.each(parentVals, function(valArray) {","\t\t\t\tvalArray = genericSort(sorter, valArray);","\t\t\t\tnewArray = newArray.concat(valArray);","\t\t\t});","\t\t\tsorted = newArray;","\t\t}","\t\tlastSort = sorter;","\t});","\t ","\t if (toSort.length) {","\t \t$footerSort.popover({","\t\t \tanimation: true,","\t\t \thtml: true,","\t\t \tcontent: function(){","\t\t \t\t\tvar sortMethod = _.pluck(_.where(sort, {sortOn : true}), 'sortProp');","\t\t\t\t\tvar sortText = '<ol class=\"sort-text\">'","\t\t\t\t\t_.each(sortMethod, function(method) {","\t\t\t\t\t\tsortText += '<li>' + method + '</li>';\t","\t\t\t\t\t});","\t\t\t\t\tsortText += '</ol>';","\t\t\t\t\treturn sortText;","\t\t \t},","\t\t \tplacement: 'bottom',","\t\t \ttrigger: 'hover'","\t\t });","\t } else {","\t \t$footerSort.popover('destroy');","\t }","\t ","\t _.each(sort, function(sorter) {","\t\tglyph = $('#sort-' + sorter.sortProp).find('.glyphicon');","\t\tif (!sorter.sortOn) {","\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","\t\t} else {","\t\t\tif (sorter.sortAsc) {","\t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet-alt');","\t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet');","\t\t\t} else {","\t\t\t\tglyph.removeClass('glyphicon-sort-by-alphabet');","\t\t\t\tglyph.addClass('glyphicon-sort-by-alphabet-alt');","\t\t\t}","\t\t\tglyph.show();","\t\t}","\t });","\t ","\treturn sorted;","}","","function paginate(toPaginate) {","\tvar lastPage = 1;","\t","\tif (paginateOptions.displayCount > -1) {","\t\tlastPage = Math.ceil((toPaginate.length / paginateOptions.displayCount));","\t}","\t","\tpaginateOptions.lastPage = lastPage;","\tif (paginateOptions.currentPage > lastPage) {","\t\tpaginateOptions.currentPage = lastPage;","\t}","\t","\tif (paginateOptions.currentPage < 1) paginateOptions.currentPage = 1;","\t","\tvar start = (paginateOptions.currentPage - 1) * paginateOptions.displayCount;","\tvar end = Math.min(toPaginate.length, start + paginateOptions.displayCount);","\treturn toPaginate.slice(start, end);","}","","function exportList() {","\tvar $form =  $('<form class=\"form\" role=\"form\"></form>');","\t$form.html('<div class=\"form-group\">' + ","\t\t\t\t'<label for=\"exportFileName\">File Name</label>' +","\t\t\t\t'<input type=\"text\" class=\"form-control\" id=\"exportFileName\" placeholder=\"File Name\">' +","\t  \t\t'</div>' +","\t  \t\t'<div class=\"radio\">' +","\t\t\t\t'<label>' +","\t\t\t\t\t'<input type=\"radio\" name=\"exportOptions\" id=\"exportAll\" value=\"all\" checked>' +","\t\t\t\t\t'Export All Discs' +","\t\t\t\t'</label>' +","\t\t\t'</div>' +","\t\t\t'<div class=\"radio\">' +","\t\t\t\t'<label>' +","\t\t\t\t\t'<input type=\"radio\" name=\"exportOptions\" id=\"exportFiltered\" value=\"filtered\">' +","\t\t\t\t\t'Export Filtered Discs' +","\t\t\t\t'</label>' +","\t\t\t'</div>');","\t\t\t","\tvar $footer = $('<div></div>').html(","\t\t'<button type=\"button\" class=\"btn btn-default\" fn-title=\"close\">Close</button>' + ","          '<button type=\"button\" class=\"btn btn-primary\" fn-title=\"export\">Export</button>'","\t\t);","\t\t","\tvar fns = [","\t\t\t\t{","\t\t\t\t\tname: 'close',","\t\t\t\t\tfunction: function() {","\t\t\t\t\t\tconsole.log('Closed without exporting.');","\t\t\t\t\t}","\t\t\t\t},","\t\t\t\t{","\t\t\t\t\tname: 'export',","\t\t\t\t\tfunction: function($inner) {","\t\t\t\t\t\tvar fileName = $inner.find('#exportFileName').val();","\t\t\t\t\t\tvar type = $inner.find('input:radio:checked').val();","\t\t\t\t\t\t","\t\t\t\t\t\tif (fileName == '') {","\t\t\t\t\t\t\tvar dt = new Date();","\t\t\t\t\t\t\tvar time = dt.getHours() + '_' + dt.getMinutes() + '_' + dt.getSeconds();","\t\t\t\t\t\t\tfileName = 'DiscZump_' + time;","\t\t\t\t\t\t}","\t\t\t\t\t\t","\t\t\t\t\t\tvar csvContent = \"data:text/csv;charset=utf-8,\";","\t\t\t\t\t\tvar writeHeaders = true;","\t\t\t\t\t\tvar list = discs;","\t\t\t\t\t\tif (type == 'filtered') {","\t\t\t\t\t\t\tlist = discList;","\t\t\t\t\t\t}","\t\t\t\t\t\t","\t\t\t\t\t\t_.each(list, function(disc) {","\t\t\t\t\t\t\tif (writeHeaders) {","\t\t\t\t\t\t\t\tcsvContent += _.map(_.keys(disc), function(key) {return key.toUpperCase();}).join(',') + '\\n';","\t\t\t\t\t\t\t\twriteHeaders = false;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t","\t\t\t\t\t\t\tcsvContent += _.values(disc).join(',') + '\\n';\t","\t\t\t\t\t\t});","\t\t\t\t\t\t","\t\t\t\t\t\tvar encodedUri = encodeURI(csvContent);","\t\t\t\t\t\tvar link = document.createElement(\"a\");","\t\t\t\t\t\tlink.setAttribute('href', encodedUri);","\t\t\t\t\t\tlink.setAttribute('download', fileName + '.csv');","\t\t\t\t\t\tlink.click();","\t\t\t\t\t}","\t\t\t\t}","\t\t];","\t\t","\tgenerateModal('Export List', $form, $footer, fns);","}","","function generateModal(title, $body, $footer, fns) {","\t$('.custom-modal').remove();","\tvar bodyText = '';","\tvar footerText = '';","\t","\tif ($body) {","\t\tbodyText = $('<div></div>').append($body).html();","\t}","\t","\tif ($footer) {","\t\tfooterText = $footer.html();","\t}","\t","\tvar $modal = $('<div class=\"modal custom-modal fade\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\"></div>');","\t$modal.html('<div class=\"modal-dialog\">' + ","            '<div class=\"modal-content\">' + ","              '<div class=\"modal-header\">' + ","              '<button type=\"button\" class=\"close\" data-dismiss=\"modal\"><span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span></button>' +","              '<h4 class=\"modal-title\">' + (title ? title : '') + '</h4>' + ","              '</div>' + ","              '<div class=\"modal-body\">' + bodyText + ","              '</div>' + ","              '<div class=\"modal-footer\">' + footerText +","              '</div>' + ","            '</div>' + ","            '</div>');","            ","     $('body').append($modal);","     ","     if (fns) {","     \t_.each(fns, function(fn) {","     \t\tif (fn.name && fn.function) {","     \t\t\t$modal.find('[fn-title=\"' + fn.name +'\"]').on('click', function() {","     \t\t\t\tfn.function($modal.find('.modal-body'));","     \t\t\t\t$modal.modal('hide');","     \t\t\t});","     \t\t}","     \t});","     }","     $modal.on('hidden.bs.modal', function (e) {","\t  $modal.remove();","\t});","     $modal.modal({show: true, backdrop: 'static'});","}","","function generateCreateDiscForm() {","\tvar $form =  $('<form class=\"form-horizontal\" role=\"form\" id=\"createDiscForm\"></form>');","\t$form.html('<div class=\"form-group\">' +","\t                  '<label for=\"md-add-brand\" class=\"col-sm-2 control-label\"><span class=\"required-field\">* </span>Brand</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<input type=\"text\" class=\"form-control\" id=\"create-disc-brand\" param=\"brand\" required>' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-name\" class=\"col-sm-2 control-label\"><span class=\"required-field\">* </span>Name</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<input type=\"text\" class=\"form-control\" id=\"create-disc-name\" param=\"name\" required>' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-material\" class=\"col-sm-2 control-label\">Material</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<input type=\"text\" class=\"form-control\" id=\"create-disc-material\" param=\"material\">' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-type\" class=\"col-sm-2 control-label\">Type</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<select class=\"form-control\" id=\"create-disc-type\"  param=\"type\">' +","\t                          '<option value=\"Putt/Approach\">Putt/Approach</option>' +","\t                          '<option value=\"Mid-range\">Mid-range</option>' +","\t                          '<option value=\"Fairway Driver\">Fairway Driver</option>' +","\t                          '<option value=\"Distance Driver\">Distance Driver</option>' +","\t                          '<option value=\"Mini\">Mini</option>' +","\t                      '</select>' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-weight\" class=\"col-sm-2 control-label\">Weight</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<input type=\"number\" class=\"form-control\" id=\"create-disc-weight\" param=\"weight\">' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-color\" class=\"col-sm-2 control-label\">Color</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<input type=\"text\" class=\"form-control\" id=\"create-disc-color\" param=\"color\">' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-speed\" class=\"col-sm-2 control-label\">Speed</label>' +","\t                  '<div class=\"col-sm-4\">' +","\t                      '<input type=\"number\" class=\"form-control\" id=\"create-disc-speed\" param=\"speed\">' +","\t                  '</div>' +","\t                  '<label for=\"md-add-glide\" class=\"col-sm-2 control-label\">Glide</label>' +","\t                  '<div class=\"col-sm-4\">' +","\t                      '<input type=\"number\" class=\"form-control\" id=\"create-disc-glide\" param=\"glide\">' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-turn\" class=\"col-sm-2 control-label\">Turn</label>' +","\t                  '<div class=\"col-sm-4\">' +","\t                      '<input type=\"number\" class=\"form-control\" id=\"create-disc-turn\" param=\"turn\">' +","\t                  '</div>' +","\t                  '<label for=\"md-add-fade\" class=\"col-sm-2 control-label\">Fade</label>' +","\t                  '<div class=\"col-sm-4\">' +","\t                      '<input type=\"number\" class=\"form-control\" id=\"create-disc-fade\" param=\"fade\">' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label for=\"md-add-notes\" class=\"col-sm-2 control-label\">Notes</label>' +","\t                  '<div class=\"col-sm-10\">' +","\t                      '<textarea class=\"form-control\" id=\"create-discnotes\" rows=\"3\" param=\"notes\"></textarea>' +","\t                  '</div>' +","\t              '</div>' +","\t              '<div class=\"form-group\">' +","\t                  '<label class=\"col-sm-2 control-label\">Select Images</label>' +","\t                  '<div class=\"col-sm-5\">' +","\t                      '<a href=\"#\" class=\"thumbnail\">' +","\t                          '<img id=\"img-front\" data-src=\"holder.js/100%x180\" alt=\"Front\">' +","\t                      '</a>' +","\t                  '</div>' +","\t                  '<div class=\"col-sm-5\">' +","\t                      '<a href=\"#\" class=\"thumbnail\">' +","\t                          '<img id=\"img-back\" data-src=\"holder.js/100%x180\" alt=\"Back\">' +","\t                      '</a>' +","\t                  '</div>' +","\t              '</div>');","               ","     var $footer = $('<div></div>').html(","\t\t'<button type=\"button\" id=\"btn-add-disc\" class=\"btn btn-primary\" fn-title=\"create\"><span><i class=\"fa fa-plus-circle fa-tools\"></i></span>Add Disc</button>' +","\t\t'<button type=\"button\" class=\"btn btn-default\" fn-title=\"close\">Close</button>'","\t);","\t","\tvar fns = [","\t\t\t\t{","\t\t\t\t\tname: 'close',","\t\t\t\t\tfunction: function() {","\t\t\t\t\t\tconsole.log('Closed without exporting.');","\t\t\t\t\t}","\t\t\t\t},","\t\t\t\t{","\t\t\t\t\tname: 'create',","\t\t\t\t\tfunction: function($inner) {","\t\t\t\t\t\tvar disc = createDisc($inner);","\t\t\t\t\t\tpostDisc(disc, function(success) {","\t\t\t\t\t\t\tif (success) {","\t\t\t\t\t\t\t\tupdateFilter();","\t\t\t\t\t\t\t} else {","\t\t\t\t\t\t\t\t// error logic","\t\t\t\t\t\t\t}","\t\t\t\t\t\t});","\t\t\t\t\t}","\t\t\t\t}","\t];","     generateModal('Add Disc', $form, $footer, fns);","}","\t","function createDisc($form) {","\tvar disc = {};","\t","\tvar $fields = $form.find('input');","\t$.each($fields, function(index) {","\t\tvar $field = $(this);","\t\tdisc[$field.attr('param')] = $field.val();\t","\t});","\t","\t$fields = $form.find('select');","\t$.each($fields, function(index) {","\t\tvar $field = $(this);","\t\tdisc[$field.attr('param')] = $field.val();\t","\t});","\t","\t$fields = $form.find('textarea');","\t$.each($fields, function(index) {","\t\tvar $field = $(this);","\t\tdisc[$field.attr('param')] = $field.val();\t","\t});","\t","\treturn disc;","\t","}","","var delay = (function(){","  var timer = 0;","  return function(callback, ms){","    clearTimeout (timer);","    timer = setTimeout(callback, ms);","  };","})();","","","/*-------------------------------------------------------------------------------------------*/","/*                                      CONTROLLER JQUERY                                    */","/*-------------------------------------------------------------------------------------------*/","/*","\t\t\t\t\t                      /´¯/) ","\t\t\t\t\t                    ,/¯../ ","\t\t\t\t\t                   /..../ ","\t\t\t\t\t              /´¯/'...'/´¯¯`·¸ ","\t\t\t\t\t          /'/.../..../......./¨¯\\ ","\t\t\t\t\t        ('(...´...´.... ¯~/'...') ","\t\t\t\t\t         \\.................'...../ ","\t\t\t\t\t          ''...\\.......... _.·´ ","\t\t\t\t\t            \\..............( ","\t\t\t\t\t              \\.............\\","*/","/*-------------------------------------------------------------------------------------------*/","","function getAllDiscs(callback) {","\tvar success = false;","     $.ajax({","          type: \"GET\",","          dataType: \"json\",","          url: url + 'discs/',","          contentType: \"application/json\",","          success: function (data) {","               discs = data;","\t\t\tsuccess = true;","          },","          error: function (request, textStatus, errorThrown) {","               console.log(request.responseText);","               console.log(textStatus);","               console.log(errorThrown);","          },","\t\t  complete: function(){","\t\t\t   if (callback) {","\t\t\t\t\tcallback(success);","\t\t\t   }","\t\t  }","     });","}","","function postDisc(disc, callback) {","\t","\tvar success = false;","     $.ajax({","          type: \"POST\",","          dataType: \"json\",","          url: url + 'discs/',","          contentType: \"application/json\",","          data: JSON.stringify(disc),","          success: function (data) {","               discs.push(data);","\t\t\tsuccess = true;","          },","          error: function (request, textStatus, errorThrown) {","               console.log(request.responseText);","               console.log(textStatus);","               console.log(errorThrown);","          },","\t\tcomplete: function(){","\t\t   if (callback) {","\t\t\tcallback(success);","\t\t   }","\t\t}","     });","}","","function getProperties(prop) {","\treturn _.uniq(_.pluck(discs,  prop));","}","","function filterList(filters) {","\treturn _.filter(discs, function(disc) {","\t\tfor (var property in filters) {","\t\t\tif (filters[property].length > 0) {","\t\t\t\tif (_.has(disc, property)) {","\t\t\t\t\tif (!(_.contains(filters[property], String(disc[property])))) {","\t\t\t\t\t\treturn false;","\t\t\t\t\t}","\t\t\t\t} else {","\t\t\t\t\treturn false;","\t\t\t\t}","\t\t\t}","\t\t}","\t\treturn true;","\t});","}","","function containSearch(val, properties, callback) {","\t_.each(properties, function(prop) {","\t\tvar filtered = _.filter(getProperties(prop), function(item) {","\t\t\treturn item.toLowerCase().indexOf(val.toLowerCase()) >= 0;\t","\t\t});","\t\tcallback(prop, filtered);","\t});","}","","function sortList(sorts) {","\t","}","","function getDisc(id) {","\treturn _.first(_.where(discs, {'_id' : id}));","}",""]}]}]]},"ace":{"folds":[],"scrolltop":11681,"scrollleft":0,"selection":{"start":{"row":852,"column":26},"end":{"row":853,"column":1},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":833,"state":"no_regex","mode":"ace/mode/javascript"}},"timestamp":1419029273947,"hash":"038d11f5e02cfe11569933498384e83cecb6420b"}