!function(){"use strict";function e(t,o){function r(e,t){return function(){return e.apply(t,arguments)}}var i;if(o=o||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=o.touchBoundary||10,this.layer=t,this.tapDelay=o.tapDelay||200,this.tapTimeout=o.tapTimeout||700,!e.notNeeded(t)){for(var a=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],c=this,u=0,l=a.length;l>u;u++)c[a[u]]=r(c[a[u]],c);n&&(t.addEventListener("mouseover",this.onMouse,!0),t.addEventListener("mousedown",this.onMouse,!0),t.addEventListener("mouseup",this.onMouse,!0)),t.addEventListener("click",this.onClick,!0),t.addEventListener("touchstart",this.onTouchStart,!1),t.addEventListener("touchmove",this.onTouchMove,!1),t.addEventListener("touchend",this.onTouchEnd,!1),t.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(t.removeEventListener=function(e,n,o){var r=Node.prototype.removeEventListener;"click"===e?r.call(t,e,n.hijacked||n,o):r.call(t,e,n,o)},t.addEventListener=function(e,n,o){var r=Node.prototype.addEventListener;"click"===e?r.call(t,e,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),o):r.call(t,e,n,o)}),"function"==typeof t.onclick&&(i=t.onclick,t.addEventListener("click",function(e){i(e)},!1),t.onclick=null)}}var t=navigator.userAgent.indexOf("Windows Phone")>=0,n=navigator.userAgent.indexOf("Android")>0&&!t,o=/iP(ad|hone|od)/.test(navigator.userAgent)&&!t,r=o&&/OS 4_\d(_\d)?/.test(navigator.userAgent),i=o&&/OS [6-7]_\d/.test(navigator.userAgent),a=navigator.userAgent.indexOf("BB10")>0;e.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(o&&"file"===e.type||e.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(e.className)},e.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!n;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},e.prototype.sendClick=function(e,t){var n,o;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),o=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(e),!0,!0,window,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},e.prototype.determineEventType=function(e){return n&&"select"===e.tagName.toLowerCase()?"mousedown":"click"},e.prototype.focus=function(e){var t;o&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type&&"month"!==e.type?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},e.prototype.updateScrollParent=function(e){var t,n;if(t=e.fastClickScrollParent,!t||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},e.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},e.prototype.onTouchStart=function(e){var t,n,i;if(e.targetTouches.length>1)return!0;if(t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0],o){if(i=window.getSelection(),i.rangeCount&&!i.isCollapsed)return!0;if(!r){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault(),!0},e.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n?!0:!1},e.prototype.onTouchMove=function(e){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},e.prototype.findControl=function(e){return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},e.prototype.onTouchEnd=function(e){var t,a,c,u,l,s=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(e.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,a=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,i&&(l=e.changedTouches[0],s=document.elementFromPoint(l.pageX-window.pageXOffset,l.pageY-window.pageYOffset)||s,s.fastClickScrollParent=this.targetElement.fastClickScrollParent),c=s.tagName.toLowerCase(),"label"===c){if(t=this.findControl(s)){if(this.focus(s),n)return!1;s=t}}else if(this.needsFocus(s))return e.timeStamp-a>100||o&&window.top!==window&&"input"===c?(this.targetElement=null,!1):(this.focus(s),this.sendClick(s,e),o&&"select"===c||(this.targetElement=null,e.preventDefault()),!1);return o&&!r&&(u=s.fastClickScrollParent,u&&u.fastClickLastScrollTop!==u.scrollTop)?!0:(this.needsClick(s)||(e.preventDefault(),this.sendClick(s,e)),!1)},e.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},e.prototype.onMouse=function(e){return this.targetElement?e.forwardedTouchEvent?!0:e.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1):!0:!0},e.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===e.target.type&&0===e.detail?!0:(t=this.onMouse(e),t||(this.targetElement=null),t)},e.prototype.destroy=function(){var e=this.layer;n&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},e.notNeeded=function(e){var t,o,r,i;if("undefined"==typeof window.ontouchstart)return!0;if(o=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!n)return!0;if(t=document.querySelector("meta[name=viewport]")){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(o>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(a&&(r=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),r[1]>=10&&r[2]>=3&&(t=document.querySelector("meta[name=viewport]")))){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===e.style.msTouchAction||"manipulation"===e.style.touchAction?!0:(i=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],i>=27&&(t=document.querySelector("meta[name=viewport]"),t&&(-1!==t.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))?!0:"none"===e.style.touchAction||"manipulation"===e.style.touchAction?!0:!1)},e.attach=function(t,n){return new e(t,n)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return e}):"undefined"!=typeof module&&module.exports?(module.exports=e.attach,module.exports.FastClick=e):window.FastClick=e}(),function(){"use strict";angular.module("mobile-angular-ui.core.activeLinks",[]).run(["$rootScope","$window","$document","$location",function(e,t,n,o){var r=function(){var e,r=o.url(),i=r.indexOf("#"),a=r.indexOf("?"),c=t.location.href,u=c.indexOf(r);-1===i&&-1===a?e=c:-1!==i&&i>a?e=c.slice(0,u+i):-1!==a&&a>i&&(e=c.slice(0,u+a));for(var l=n[0].links,s=0;s<l.length;s++){var d=l[s],f=angular.element(d);f.attr("href")&&""!==f.attr("href")&&d.href===e?f.addClass("active"):f.attr("href")&&""!==f.attr("href")&&d.href&&d.href.length&&f.removeClass("active")}};e.$on("$locationChangeSuccess",r),e.$on("$includeContentLoaded",r)}])}(),function(){"use strict";angular.module("mobile-angular-ui.core.capture",[]).run(["Capture","$rootScope",function(e,t){t.$on("$routeChangeSuccess",function(){e.resetAll()})}]).factory("Capture",["$compile",function(e){var t={};return{resetAll:function(){for(var e in t)t.hasOwnProperty(e)&&this.resetYielder(e)},resetYielder:function(e){var n=t[e];this.setContentFor(e,n.defaultContent,n.defaultScope)},putYielder:function(e,n,o,r){var i={};i.name=e,i.element=n,i.defaultContent=r||"",i.defaultScope=o,t[e]=i},getYielder:function(e){return t[e]},removeYielder:function(e){delete t[e]},setContentFor:function(n,o,r){var i=t[n];i&&(i.element.html(o),e(i.element.contents())(r))}}}]).directive("uiContentFor",["Capture",function(e){return{compile:function(t,n){var o=t.html();return(null===n.uiDuplicate||void 0===n.uiDuplicate)&&(t.html(""),t.remove()),function(t,n,r){e.setContentFor(r.uiContentFor,o,t)}}}}]).directive("uiYieldTo",["$compile","Capture",function(e,t){return{link:function(e,n,o){t.putYielder(o.uiYieldTo,n,e,n.html()),n.on("$destroy",function(){t.removeYielder(o.uiYieldTo)}),e.$on("$destroy",function(){t.removeYielder(o.uiYieldTo)})}}}])}(),function(){"use strict";var e=angular.module("mobile-angular-ui.core.fastclick",[]);e.run(["$window",function(e){function t(e,t){return function(){return e.apply(t,arguments)}}var n=FastClick.prototype.onTouchEnd;FastClick.prototype.onTouchEnd=function(e){e.changedTouches||(e.changedTouches=[{}]),(n=t(n,this))(e)},FastClick.attach(e.document.body)}]),angular.forEach(["select","input","textarea"],function(t){e.directive(t,function(){return{restrict:"E",compile:function(e){e.addClass("needsclick")}}})})}(),function(){"use strict";var e=function(e,t){for(var n=e;n.length>0;){if(n[0]===t[0])return n=null,!0;n=n.parent()}return n=null,!1};angular.module("mobile-angular-ui.core.outerClick",[]).factory("bindOuterClick",["$document","$timeout",function(t,n){return function(o,r,i,a){var c=function(t){e(angular.element(t.target),r)||o.$apply(function(){i(o,{$event:t})})},u=angular.noop,l=null;a?u=o.$watch(a,function(e){n.cancel(l),e?l=n(function(){t.on("click tap",c)},0):t.unbind("click tap",c)}):(n.cancel(l),t.on("click tap",c)),o.$on("$destroy",function(){u(),t.unbind("click tap",c)})}}]).directive("uiOuterClick",["bindOuterClick","$parse",function(e,t){return{restrict:"A",compile:function(n,o){var r=t(o.uiOuterClick),i=o.uiOuterClickIf;return function(t,n){e(t,n,r,i)}}}}])}(),function(){"use strict";var e=angular.module("mobile-angular-ui.core.sharedState",[]);e.factory("SharedState",["$rootScope",function(e){var t={},n={},o={},r={};return{initialize:function(i,a,c){c=c||{};var u=void 0===o[i],l=c.defaultValue,s=c.exclusionGroup;o[i.$id]=o[i.$id]||[],o[i.$id].push(a),n[a]?u&&n[a].references++:(n[a]=angular.extend({},c,{references:1}),e.$broadcast("mobile-angular-ui.state.initialized."+a,l),void 0!==l&&this.setOne(a,l),s&&(r[s]=r[s]||{},r[s][a]=!0)),i.$on("$destroy",function(){for(var c=o[i.$id]||[],u=0;u<c.length;u++){var l=n[c[u]];l.exclusionGroup&&(delete r[l.exclusionGroup][c[u]],0===Object.keys(r[l.exclusionGroup]).length&&delete r[l.exclusionGroup]),l.references--,l.references<=0&&(delete n[c[u]],delete t[c[u]],e.$broadcast("mobile-angular-ui.state.destroyed."+a))}delete o[i.$id]})},setOne:function(o,r){if(void 0!==n[o]){var i=t[o];return t[o]=r,i!==r&&e.$broadcast("mobile-angular-ui.state.changed."+o,r,i),r}console&&console.warn("Warning: Attempt to set uninitialized shared state:",o)},setMany:function(e){angular.forEach(e,function(e,t){this.setOne(t,e)},this)},set:function(e,t){angular.isObject(e)&&angular.isUndefined(t)?this.setMany(e):this.setOne(e,t)},turnOn:function(e){var t=n[e]&&n[e].exclusionGroup;if(t)for(var o=Object.keys(r[t]),i=0;i<o.length;i++){var a=o[i];a!==e&&this.turnOff(a)}return this.setOne(e,!0)},turnOff:function(e){return this.setOne(e,!1)},toggle:function(e){return this.get(e)?this.turnOff(e):this.turnOn(e)},get:function(e){return n[e]&&t[e]},isActive:function(e){return!!this.get(e)},active:function(e){return this.isActive(e)},isUndefined:function(e){return void 0===n[e]||void 0===this.get(e)},has:function(e){return void 0!==n[e]},referenceCount:function(e){var t=n[e];return void 0===t?0:t.references},equals:function(e,t){return this.get(e)===t},eq:function(e,t){return this.equals(e,t)},values:function(){return t}}}]);var t=function(e,t,n,o){n=n||"click tap",t.on(n,function(t){e.$apply(function(){o(e,{$event:t})})})};e.directive("uiState",["SharedState",function(e){return{restrict:"EA",priority:601,link:function(t,n,o){var r=o.uiState||o.id,i=o.uiDefault||o["default"],a=i?t.$eval(i):void 0;e.initialize(t,r,{defaultValue:a,exclusionGroup:o.uiExclusionGroup})}}}]),angular.forEach(["toggle","turnOn","turnOff","set"],function(n){var o="ui"+n[0].toUpperCase()+n.slice(1);e.directive(o,["$parse","$interpolate","SharedState",function(e,r,i){var a=i[n];return{restrict:"A",priority:1,compile:function(c,u){var l=u[o],s=l.match(/\{\{/),d=function(t){var o=l;if(s){var i=r(o);o=i(t)}return"set"===n&&(o=e(o)(t)),o};return function(e,n,o){var r=function(){var t=d(e);return a.call(i,t)};t(e,n,o.uiTriggers,r)}}}}])});var n=function(e){if(!e||""===e)return[];for(var t=e?e.trim().split(/ *, */):[],n=[],o=0;o<t.length;o++){var r=t[o].split(/ *as */);if(r.length>2||r.length<1)throw new Error('Error parsing uiScopeContext="'+e+'"');n.push(r)}return n},o=function(e,t,n){for(var o=0;o<t.length;o++){var r=t[o][0],i=t[o][1]||r;e[i]=r.split(".").reduce(function(e,t){return e[t]},n)}},r=function(e,t,r,i,a,c){var u,l=t[e],s=l.match(/\{\{/);u=s?function(e){var t=c(l),n=a(t(r));return n(e)}:a(l);var d=n(t.uiScopeContext);return function(){var e;return d.length?(e=angular.extend({},i.values()),o(e,d,r)):e=i.values(),u(e)}};e.directive("uiIf",["$animate","SharedState","$parse","$interpolate",function(e,t,n,o){function i(e){var t=e[0],n=e[e.length-1],o=[t];do{if(t=t.nextSibling,!t)break;o.push(t)}while(t!==n);return angular.element(o)}return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(a,c,u,l,s){var d,f,h,m=r("uiIf",u,a,t,n,o);a.$watch(m,function(t){if(t)f||s(function(t,n){f=n,t[t.length++]=document.createComment(" end uiIf: "+u.uiIf+" "),d={clone:t},e.enter(t,c.parent(),c)});else if(h&&(h.remove(),h=null),f&&(f.$destroy(),f=null),d){h=i(d.clone);var n=function(){h=null},o=e.leave(h,n);o&&o.then(n),d=null}})}}}]),e.directive("uiHide",["$animate","SharedState","$parse","$interpolate",function(e,t,n,o){var i="ng-hide",a="ng-hide-animate";return{restrict:"A",multiElement:!0,link:function(c,u,l){var s=r("uiHide",l,c,t,n,o);c.$watch(s,function(t){e[t?"addClass":"removeClass"](u,i,{tempClasses:a})})}}}]),e.directive("uiShow",["$animate","SharedState","$parse","$interpolate",function(e,t,n){var o="ng-hide",i="ng-hide-animate";return{restrict:"A",multiElement:!0,link:function(a,c,u){var l=r("uiShow",u,a,t,n);a.$watch(l,function(t){e[t?"removeClass":"addClass"](c,o,{tempClasses:i})})}}}]),e.directive("uiClass",["SharedState","$parse","$interpolate",function(e,t){return{restrict:"A",link:function(n,o,i){var a=r("uiClass",i,n,e,t);n.$watch(a,function(e){var t="",n="";angular.forEach(e,function(e,r){e?t+=" "+r:n+=" "+r,t=t.trim(),n=n.trim(),t.length&&o.addClass(t),n.length&&o.removeClass(n)})},!0)}}}]),e.run(["$rootScope","SharedState",function(e,t){e.Ui=t}])}(),function(){"use strict";var e=angular.module("mobile-angular-ui.core.touchmoveDefaults",[]);e.directive("uiPreventTouchmoveDefaults",function(){var e=function(e){e.allowTouchmoveDefault!==!0&&e.preventDefault()};return{compile:function(t){"ontouchmove"in document&&t.on("touchmove",e)}}}),e.factory("allowTouchmoveDefault",function(){var e=function(){return!0};return"ontouchmove"in document?function(t,n){n=n||e;var o=function(e){n(e)&&(e.allowTouchmoveDefault=!0)};return t=angular.element(t),t.on("touchmove",o),t.on("$destroy",function(){t.off("touchmove",o),t=null}),function(){t&&t.off("touchmove",o)}}:angular.noop})}(),function(){"use strict";angular.module("mobile-angular-ui.core",["mobile-angular-ui.core.fastclick","mobile-angular-ui.core.activeLinks","mobile-angular-ui.core.capture","mobile-angular-ui.core.outerClick","mobile-angular-ui.core.sharedState","mobile-angular-ui.core.touchmoveDefaults"])}(),function(e,t){var n=e.document,o=n.documentElement,r="overthrow-enabled",i="ontouchmove"in n,a="WebkitOverflowScrolling"in o.style||"msOverflowStyle"in o.style||!i&&e.screen.width>800||function(){var t=e.navigator.userAgent,n=t.match(/AppleWebKit\/([0-9]+)/),o=n&&n[1],r=n&&o>=534;return t.match(/Android ([0-9]+)/)&&RegExp.$1>=3&&r||t.match(/ Version\/([0-9]+)/)&&RegExp.$1>=0&&e.blackberry&&r||t.indexOf("PlayBook")>-1&&r&&-1===!t.indexOf("Android 2")||t.match(/Firefox\/([0-9]+)/)&&RegExp.$1>=4||t.match(/wOSBrowser\/([0-9]+)/)&&RegExp.$1>=233&&r||t.match(/NokiaBrowser\/([0-9\.]+)/)&&7.3===parseFloat(RegExp.$1)&&n&&o>=533}();e.overthrow={},e.overthrow.enabledClassName=r,e.overthrow.addClass=function(){-1===o.className.indexOf(e.overthrow.enabledClassName)&&(o.className+=" "+e.overthrow.enabledClassName)},e.overthrow.removeClass=function(){o.className=o.className.replace(e.overthrow.enabledClassName,"")},e.overthrow.set=function(){a&&e.overthrow.addClass()},e.overthrow.canBeFilledWithPoly=i,e.overthrow.forget=function(){e.overthrow.removeClass()},e.overthrow.support=a?"native":"none"}(this),function(e,t){e.overthrow.set()}(this),function(e,t,n){if(t!==n){t.scrollIndicatorClassName="overthrow";var o=e.document,r=o.documentElement,i="native"===t.support,a=t.canBeFilledWithPoly,c=(t.configure,t.set),u=t.forget,l=t.scrollIndicatorClassName;t.closest=function(e,n){return!n&&e.className&&e.className.indexOf(l)>-1&&e||t.closest(e.parentNode)};var s=!1;t.set=function(){if(c(),!s&&!i&&a){e.overthrow.addClass(),s=!0,t.support="polyfilled",t.forget=function(){u(),s=!1,o.removeEventListener&&o.removeEventListener("touchstart",b,!1)};var l,d,f,h,m=[],v=[],p=function(){m=[],d=null},g=function(){v=[],f=null},C=function(e){h=l.querySelectorAll("textarea, input");for(var t=0,n=h.length;n>t;t++)h[t].style.pointerEvents=e},k=function(e,t){if(o.createEvent){var r,i=(!t||t===n)&&l.parentNode||l.touchchild||l;i!==l&&(r=o.createEvent("HTMLEvents"),r.initEvent("touchend",!0,!0),l.dispatchEvent(r),i.touchchild=l,l=i,i.dispatchEvent(e))}},b=function(e){if(t.intercept&&t.intercept(),p(),g(),l=t.closest(e.target),l&&l!==r&&!(e.touches.length>1)){C("none");var n=e,o=l.scrollTop,i=l.scrollLeft,a=l.offsetHeight,c=l.offsetWidth,u=e.touches[0].pageY,s=e.touches[0].pageX,h=l.scrollHeight,b=l.scrollWidth,E=function(e){var t=o+u-e.touches[0].pageY,r=i+s-e.touches[0].pageX,C=t>=(m.length?m[0]:0),E=r>=(v.length?v[0]:0);t>0&&h-a>t||r>0&&b-c>r?e.preventDefault():k(n),d&&C!==d&&p(),f&&E!==f&&g(),d=C,f=E,l.scrollTop=t,l.scrollLeft=r,m.unshift(t),v.unshift(r),m.length>3&&m.pop(),v.length>3&&v.pop()},y=function(e){C("auto"),setTimeout(function(){C("none")},450),l.removeEventListener("touchmove",E,!1),l.removeEventListener("touchend",y,!1)};l.addEventListener("touchmove",E,!1),l.addEventListener("touchend",y,!1)}};o.addEventListener("touchstart",b,!1)}}}}(this,this.overthrow),function(){"use strict";angular.module("mobile-angular-ui.components.modals",[]).directive("modal",["$rootElement",function(e){return{restrict:"C",link:function(t,n){e.addClass("has-modal"),n.on("$destroy",function(){e.removeClass("has-modal")}),t.$on("$destroy",function(){e.removeClass("has-modal")}),n.hasClass("modal-overlay")&&(e.addClass("has-modal-overlay"),n.on("$destroy",function(){e.removeClass("has-modal-overlay")}),t.$on("$destroy",function(){e.removeClass("has-modal-overlay")}))}}}])}(),function(){"use strict";var e=angular.module("mobile-angular-ui.components.navbars",[]);angular.forEach(["top","bottom"],function(t){var n="navbarAbsolute"+t.charAt(0).toUpperCase()+t.slice(1);e.directive(n,["$rootElement",function(e){return{restrict:"C",link:function(n){e.addClass("has-navbar-"+t),n.$on("$destroy",function(){e.removeClass("has-navbar-"+t)})}}}])})}(),function(){"use strict";var e=angular.module("mobile-angular-ui.components.scrollable",["mobile-angular-ui.core.touchmoveDefaults"]),t=function(e){var t=e.touches&&e.touches.length?e.touches:[e],n=e.changedTouches&&e.changedTouches[0]||e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]||t[0].originalEvent||t[0];return n.clientY};e.directive("scrollableContent",function(){return{restrict:"C",controller:["$element","allowTouchmoveDefault",function(e,n){var o=e[0],r=e.parent()[0];if("ontouchmove"in document){var i,a,c,u,l,s=function(e){i=o.scrollTop>0,a=o.scrollTop<o.scrollHeight-o.clientHeight,c=null,u=null,l=t(e)};e.on("touchstart",s),e.on("$destroy",function(){e.off("touchstart")}),n(e,function(e){var n=t(e),o=n>l,r=!o;return l=n,o&&i||r&&a})}this.scrollableContent=o,this.scrollTo=function(e,t){if(t=t||0,angular.isNumber(e))o.scrollTop=e-t;else{var n=angular.element(e)[0];n.offsetParent&&n.offsetParent!==r?this.scrollTo(n.offsetParent,t-n.offsetTop):o.scrollTop=n.offsetTop-t}}}],link:function(e,t){"native"!==overthrow.support&&(t.addClass("overthrow"),overthrow.forget(),overthrow.set())}}}),angular.forEach(["input","textarea"],function(t){e.directive(t,["$rootScope","$timeout",function(e,t){return{require:"?^^scrollableContent",link:function(e,n,o,r){n.on("focus",function(){if(r&&r.scrollableContent){var e=r.scrollableContent.offsetHeight;t(function(){var t=r.scrollableContent.offsetHeight;e>t&&r.scrollTo(n,10)},500)}})}}}])}),angular.forEach({uiScrollTop:function(e){return 0===e.scrollTop},uiScrollBottom:function(e){return e.scrollHeight===e.scrollTop+e.clientHeight}},function(t,n){e.directive(n,[function(){return{restrict:"A",link:function(e,o,r){o.on("scroll",function(){t(o[0])&&e.$apply(function(){e.$eval(r[n])})})}}}])}),angular.forEach({Top:"scrollableHeader",Bottom:"scrollableFooter"},function(t,n){e.directive(t,["$window",function(e){return{restrict:"C",link:function(t,o){var r=o[0],i=o.parent()[0].style,a=function(){var t=e.getComputedStyle(r),o=parseInt(t.marginTop,10)+parseInt(t.marginBottom,10);i["padding"+n]=r.offsetHeight+o+"px"},c=setInterval(a,30);o.on("$destroy",function(){i["padding"+n]=null,clearInterval(c),c=a=o=null})}}}])})}(),function(){"use strict";var e=angular.module("mobile-angular-ui.components.sidebars",["mobile-angular-ui.core.sharedState","mobile-angular-ui.core.outerClick"]);angular.forEach(["left","right"],function(t){var n="sidebar"+t.charAt(0).toUpperCase()+t.slice(1),o="ui"+n.charAt(0).toUpperCase()+n.slice(1);e.directive(n,["$rootElement","SharedState","bindOuterClick","$location",function(e,n,r,i){return{restrict:"C",link:function(a,c,u){var l="has-sidebar-"+t,s="sidebar-"+t+"-visible",d="sidebar-"+t+"-in";u.id&&(o=u.id);var f=function(){n.turnOff(o)},h=function(){return n.isActive(o)};e.addClass(l),a.$on("$destroy",function(){e.removeClass(l),e.removeClass(s),e.removeClass(d)});var m=void 0!==u.active&&"false"!==u.active;n.initialize(a,o,{defaultValue:m}),a.$on("mobile-angular-ui.state.changed."+o,function(t,n){(""===u.uiTrackAsSearchParam||u.uiTrackAsSearchParam)&&i.search(o,n||null),n?(e.addClass(s),e.addClass(d)):e.removeClass(d)}),a.$on("$routeChangeSuccess",function(){n.turnOff(o)}),a.$on("$routeUpdate",function(){u.uiTrackAsSearchParam&&(i.search()[o]?n.turnOn(o):n.turnOff(o))}),a.$on("mobile-angular-ui.app.transitionend",function(){n.isActive(o)||e.removeClass(s)}),"false"!==u.closeOnOuterClicks&&r(a,c,f,h)}}}])}),e.directive("app",["$rootScope",function(e){return{restrict:"C",link:function(t,n){n.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend",function(){e.$broadcast("mobile-angular-ui.app.transitionend")})}}}])}(),function(){"use strict";angular.module("mobile-angular-ui.components.switch",[]).directive("uiSwitch",["$injector",function(e){var t=e.has("$drag")&&e.get("$drag");return{restrict:"EA",scope:{model:"=ngModel",changeExpr:"@ngChange"},link:function(e,n,o){n.addClass("switch");var r=o.disabled||n.attr("disabled"),i=e.$watch(function(){return o.disabled||n.attr("disabled")},function(e){r=e&&"false"!==e&&"0"!==e?!0:!1}),a=angular.element('<div class="switch-handle"></div>');n.append(a),e.model&&n.addClass("active"),n.addClass("switch-transition-enabled");var c=e.$watch("model",function(e){e?n.addClass("active"):n.removeClass("active")}),u=function(){return!r},l=function(t){u()&&t!==e.model&&(e.model=t,e.$apply(),null!==e.changeExpr&&void 0!==e.changeExpr&&e.$parent.$eval(e.changeExpr))},s=function(){l(!e.model)};n.on("click tap",s);var d=angular.noop;t&&(d=t.bind(a,{transform:t.TRANSLATE_INSIDE(n),start:function(){n.off("click tap",s)},cancel:function(){a.removeAttr("style"),n.off("click tap",s),n.on("click tap",s)},end:function(){var e=a[0].getBoundingClientRect(),t=n[0].getBoundingClientRect();e.left-t.left<e.width/3?(l(!1),a.removeAttr("style")):t.right-e.right<e.width/3?(l(!0),a.removeAttr("style")):a.removeAttr("style"),n.on("click tap",s)}})),n.on("$destroy",function(){d(),i(),c(),u=l=d=c=i=s=null})}}}])}(),function(){"use strict";angular.module("mobile-angular-ui.components",["mobile-angular-ui.components.modals","mobile-angular-ui.components.navbars","mobile-angular-ui.components.sidebars","mobile-angular-ui.components.scrollable","mobile-angular-ui.components.switch"])}(),function(){"use strict";angular.module("mobile-angular-ui",["mobile-angular-ui.core","mobile-angular-ui.components"])}();
//# sourceMappingURL=mobile-angular-ui.min.js.map
!function(){"use strict";angular.module("mobile-angular-ui.gestures.drag",["mobile-angular-ui.gestures.touch","mobile-angular-ui.gestures.transform"]).provider("$drag",function(){this.$get=["$touch","$transform",function(t,e){var n=document.createElement("style");n.appendChild(document.createTextNode("")),document.head.appendChild(n);var r=n.sheet;return r.insertRule("html .ui-drag-move{z-index: 99999 !important;}",0),r.insertRule("html .ui-drag-move{-webkit-transition: none !important;-moz-transition: none !important;-o-transition: none !important;-ms-transition: none !important;transition: none !important;}",0),r.insertRule("html .ui-drag-move, html .ui-drag-move *{-webkit-touch-callout: none !important;-webkit-user-select: none !important;-khtml-user-select: none !important;-moz-user-select: none !important;-ms-user-select: none !important;user-select: none !important;}",0),n=r=null,{NULL_TRANSFORM:function(t,e){return e},TRANSLATE_BOTH:function(t,e,n){return e.translateX=n.distanceX,e.translateY=n.distanceY,e},TRANSLATE_HORIZONTAL:function(t,e,n){return e.translateX=n.distanceX,e.translateY=0,e},TRANSLATE_UP:function(t,e,n){return e.translateY=n.distanceY<=0?n.distanceY:0,e.translateX=0,e},TRANSLATE_DOWN:function(t,e,n){return e.translateY=n.distanceY>=0?n.distanceY:0,e.translateX=0,e},TRANSLATE_LEFT:function(t,e,n){return e.translateX=n.distanceX<=0?n.distanceX:0,e.translateY=0,e},TRANSLATE_RIGHT:function(t,e,n){return e.translateX=n.distanceX>=0?n.distanceX:0,e.translateY=0,e},TRANSLATE_VERTICAL:function(t,e,n){return e.translateX=0,e.translateY=n.distanceY,e},TRANSLATE_INSIDE:function(t){return t=t.length?t[0]:t,function(e,n,r){e=e.length?e[0]:e;var a,o,i=e.getBoundingClientRect(),u=t instanceof Element?t.getBoundingClientRect():t;return a=i.width>=u.width?0:i.right+r.stepX>u.right?u.right-i.right:i.left+r.stepX<u.left?u.left-i.left:r.stepX,o=i.height>=u.height?0:i.bottom+r.stepY>u.bottom?u.bottom-i.bottom:i.top+r.stepY<u.top?u.top-i.top:r.stepY,n.translateX+=a,n.translateY+=o,n}},bind:function(n,r,a){n=angular.element(n),r=r||{},a=a||{};var o,i,u=r.start,s=r.end,c=r.move,l=r.cancel,f=r.transform||this.TRANSLATE_BOTH,v=n[0],m=e.get(n),d=v.getBoundingClientRect(),g=!1,h=function(){return g},p=function(){g=!1,o=i=null,n.removeClass("ui-drag-move")},X=function(){e.set(v,m)},Y=function(){e.set(v,o||m)},T=function(){g=!0,i=v.getBoundingClientRect(),o=e.get(v),n.addClass("ui-drag-move")},b=function(t){return t=angular.extend({},t),t.originalTransform=m,t.originalRect=d,t.startRect=i,t.rect=v.getBoundingClientRect(),t.startTransform=o,t.transform=e.get(v),t.reset=X,t.undo=Y,t},w=function(t,r){if(r.preventDefault(),h()){t=b(t);var a=f(n,angular.extend({},t.transform),t,r);e.set(v,a),c&&c(t,r)}else T(),u&&u(b(t),r)},R=function(t,e){h()&&(e.__UiSwipeHandled__=!0,t=b(t),p(),s&&s(t,e))},E=function(t,e){h()&&(t=b(t),Y(),p(),l&&l(t,e))};return t.bind(n,{move:w,end:R,cancel:E},a)}}}]})}(),function(){"use strict";var t=angular.module("mobile-angular-ui.gestures.swipe",["mobile-angular-ui.gestures.touch"]);t.factory("$swipe",["$touch",function(t){var e=500,n=10,r=10,a=10,o=Math.abs,i={movementThreshold:n,valid:function(t){var n=o(t.angle);n=n>=90?n-90:n;var i=t.total-t.distance<=r,u=a>=n||n>=90-a,s=t.averageVelocity>=e;return i&&u&&s}};return{bind:function(e,n,r){return r=angular.extend({},i,r||{}),t.bind(e,n,r)}}}]),angular.forEach(["ui","ng"],function(e){angular.forEach(["Left","Right"],function(n){var r=e+"Swipe"+n;t.directive(r,["$swipe","$parse",function(t,e){return{link:function(a,o,i){var u=e(i[r]);t.bind(o,{end:function(t,e){t.direction===n.toUpperCase()&&(e.__UiSwipeHandled__||(e.__UiSwipeHandled__=!0,a.$apply(function(){u(a,{$touch:t})})))}})}}}])})})}(),function(){"use strict";var t=angular.module("mobile-angular-ui.gestures.touch",[]);t.provider("$touch",function(){var t=function(){return!0},e=1,n={mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},touch:{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"}},r=["mouse","touch"],a=function(t){return t[0].ownerDocument.documentElement.getBoundingClientRect()};this.setPointerEvents=function(t){n=t,r=Object.keys(n)},this.setValid=function(e){t=e},this.setMovementThreshold=function(t){e=t},this.setSensitiveArea=function(t){a=t};var o=Math.abs,i=Math.atan2,u=Math.sqrt,s=function(t){var e=t.touches&&t.touches.length?t.touches:[t],n=t.changedTouches&&t.changedTouches[0]||t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]||e[0].originalEvent||e[0];return{x:n.clientX,y:n.clientY}},c=function(t,e){var r=[];return angular.forEach(t,function(t){var a=n[t][e];a&&r.push(a)}),r.join(" ")},l=function(){return new Date},f=function(t,e){return e=e||l(),o(e-t)},v=function(t,e){return u(t*t+e*e)},m=function(t,e,n,r){n=n||{},r=r||{};var a=l(),u=n.timestamp||a,s=r.timestamp||u,c=e.x,m=e.y,d=n.x||c,g=n.y||m,h=r.x||d,p=r.y||g,X=r.totalX||0,Y=r.totalY||0,T=X+o(c-h),b=Y+o(m-p),w=v(T,b),R=f(a,u),E=f(a,s),y=c-h,A=m-p,x=v(y,A),Z=c-d,_=m-g,k=v(Z,_),C=E>0?o(x/(E/1e3)):0,M=R>0?o(w/(R/1e3)):0,L=o(Z)>o(_)?0>Z?"LEFT":"RIGHT":0>_?"TOP":"BOTTOM",S=0!==Z||0!==_?i(_,Z)*(180/Math.PI):null;return S=-180===S?180:S,{type:t,timestamp:a,duration:R,startX:d,startY:g,prevX:h,prevY:p,x:e.x,y:e.y,step:x,stepX:y,stepY:A,velocity:C,averageVelocity:M,distance:k,distanceX:Z,distanceY:_,total:w,totalX:T,totalY:b,direction:L,angle:S}};this.$get=[function(){return{bind:function(n,o,i){n=angular.element(n),i=i||{};var u,l,f=i.pointerTypes||r,v=void 0===i.valid?t:i.valid,d=void 0===i.movementThreshold?e:i.valid,g=void 0===i.sensitiveArea?a:i.sensitiveArea,h=c(f,"start"),p=c(f,"end"),X=c(f,"move"),Y=c(f,"cancel"),T=o.start,b=o.end,w=o.move,R=o.cancel,E=angular.element(n[0].ownerDocument),y=function(){u=l=null,E.off(X,_),E.off(p,k),Y&&E.off(Y,Z)},A=function(){return!!u},x=function(t){t.touches&&t.touches.length>1||(l=u=m("touchstart",s(t)),E.on(X,_),E.on(p,k),Y&&E.on(Y,Z),T&&T(u,t))},Z=function(t){var e=m("touchcancel",s(t),u,l);y(),R&&R(e,t)},_=function(t){if(!(t.touches&&t.touches.length>1)&&A()){var e=s(t),r="function"==typeof g?g(n):g;r=r.length?r[0]:r;var a=r instanceof Element?r.getBoundingClientRect():r;if(!(e.x<a.left||e.x>a.right||e.y<a.top||e.y>a.bottom)){var o=m("touchmove",e,u,l),i=o.totalX,c=o.totalY;l=o,d>i&&d>c||v(o,t)&&((void 0===t.cancelable||t.cancelable)&&t.preventDefault(),w&&w(o,t))}}},k=function(t){if(!(t.touches&&t.touches.length>1)&&A()){var e=angular.extend({},l,{type:"touchend"});v(e,t)&&((void 0===t.cancelable||t.cancelable)&&t.preventDefault(),b&&setTimeout(function(){b(e,t)},0)),y()}};return n.on(h,x),function(){n&&(n.off(h,x),Y&&E.off(Y,Z),E.off(X,_),E.off(p,k),n=E=h=Y=X=p=x=Z=_=k=f=v=d=g=null)}}}}]})}(),function(){"use strict";var t=angular.module("mobile-angular-ui.gestures.transform",[]);t.factory("$transform",function(){for(var t,e,n,r=["","webkit","Moz","O","ms"],a=document.createElement("div"),o=0;o<r.length;o++){var i=r[o];if(i+"Perspective"in a.style){t=""===i?"":"-"+i.toLowerCase()+"-",n=i+(""===i?"transform":"Transform"),e=t+"transform";break}}a=null;var u=function(t){t=t.length?t[0]:t;var n=window.getComputedStyle(t,null).getPropertyValue(e);return n},s=function(t,e){t=t.length?t[0]:t,t.style[n]=e},c=1e-7,l=function(t){return 180*t/Math.PI},f=Math.sqrt,v=Math.asin,m=Math.atan2,d=Math.cos,g=Math.abs,h=Math.floor,p=function(t){for(var e=[[],[],[],[]],n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)e[n][r]=t[n][r];return e},X=function(t,e,n,r){return t*r-e*n},Y=function(t,e,n,r,a,o,i,u,s){return t*X(a,o,u,s)-r*X(e,n,u,s)+i*X(e,n,a,o)},T=function(t){var e=t[0][0],n=t[0][1],r=t[0][2],a=t[0][3],o=t[1][0],i=t[1][1],u=t[1][2],s=t[1][3],c=t[2][0],l=t[2][1],f=t[2][2],v=t[2][3],m=t[3][0],d=t[3][1],g=t[3][2],h=t[3][3];return e*Y(i,l,d,u,f,g,s,v,h)-n*Y(o,c,m,u,f,g,s,v,h)+r*Y(o,c,m,i,l,d,s,v,h)-a*Y(o,c,m,i,l,d,u,f,g)},b=function(t){var e=[[],[],[],[]],n=t[0][0],r=t[0][1],a=t[0][2],o=t[0][3],i=t[1][0],u=t[1][1],s=t[1][2],c=t[1][3],l=t[2][0],f=t[2][1],v=t[2][2],m=t[2][3],d=t[3][0],g=t[3][1],h=t[3][2],p=t[3][3];return e[0][0]=Y(u,f,g,s,v,h,c,m,p),e[1][0]=-Y(i,l,d,s,v,h,c,m,p),e[2][0]=Y(i,l,d,u,f,g,c,m,p),e[3][0]=-Y(i,l,d,u,f,g,s,v,h),e[0][1]=-Y(r,f,g,a,v,h,o,m,p),e[1][1]=Y(n,l,d,a,v,h,o,m,p),e[2][1]=-Y(n,l,d,r,f,g,o,m,p),e[3][1]=Y(n,l,d,r,f,g,a,v,h),e[0][2]=Y(r,u,g,a,s,h,o,c,p),e[1][2]=-Y(n,i,d,a,s,h,o,c,p),e[2][2]=Y(n,i,d,r,u,g,o,c,p),e[3][2]=-Y(n,i,d,r,u,g,a,s,h),e[0][3]=-Y(r,u,f,a,s,v,o,c,m),e[1][3]=Y(n,i,l,a,s,v,o,c,m),e[2][3]=-Y(n,i,l,r,u,f,o,c,m),e[3][3]=Y(n,i,l,r,u,f,a,s,v),e},w=function(t){var e=b(t),n=T(t);if(g(n)<c)return!1;for(var r=0;4>r;r++)for(var a=0;4>a;a++)e[r][a]=e[r][a]/n;return e},R=function(t){for(var e=[[],[],[],[]],n=0;4>n;n++)for(var r=0;4>r;r++)e[n][r]=t[r][n];return e},E=function(t,e){var n=[];return n[0]=t[0]*e[0][0]+t[1]*e[1][0]+t[2]*e[2][0]+t[3]*e[3][0],n[1]=t[0]*e[0][1]+t[1]*e[1][1]+t[2]*e[2][1]+t[3]*e[3][1],n[2]=t[0]*e[0][2]+t[1]*e[1][2]+t[2]*e[2][2]+t[3]*e[3][2],n[3]=t[0]*e[0][3]+t[1]*e[1][3]+t[2]*e[2][3]+t[3]*e[3][3],n},y=function(t){return f(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])},A=function(t,e){var n=[],r=y(t);if(0!==r){var a=e/r;n[0]*=a,n[1]*=a,n[2]*=a}return n},x=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},Z=function(t,e,n,r){var a=[];return a[0]=n*t[0]+r*e[0],a[1]=n*t[1]+r*e[1],a[2]=n*t[2]+r*e[2],a},_=function(t,e){var n=[];return n[0]=t[1]*e[2]-t[2]*e[1],n[1]=t[2]*e[0]-t[0]*e[2],n[2]=t[0]*e[1]-t[1]*e[0],n},k=function(t){var e,n,r={},a=p(t);if(0===a[3][3])return!1;for(e=0;4>e;e++)for(n=0;4>n;n++)a[e][n]/=a[3][3];var o=p(a);for(e=0;3>e;e++)o[e][3]=0;if(o[3][3]=1,0===T(o))return!1;if(0!==a[0][3]||0!==a[1][3]||0!==a[2][3]){var i=[];i[0]=a[0][3],i[1]=a[1][3],i[2]=a[2][3],i[3]=a[3][3];var u=w(o),s=R(u),c=E(i,s);r.perspectiveX=c[0],r.perspectiveY=c[1],r.perspectiveZ=c[2],r.perspectiveW=c[3],a[0][3]=a[1][3]=a[2][3]=0,a[3][3]=1}else r.perspectiveX=r.perspectiveY=r.perspectiveZ=0,r.perspectiveW=1;r.translateX=a[3][0],a[3][0]=0,r.translateY=a[3][1],a[3][1]=0,r.translateZ=a[3][2],a[3][2]=0;var f,g=[[],[],[]];for(e=0;3>e;e++)g[e][0]=a[e][0],g[e][1]=a[e][1],g[e][2]=a[e][2];if(r.scaleX=y(g[0]),A(g[0],1),r.skewXY=x(g[0],g[1]),Z(g[1],g[0],g[1],1,-r.skewXY),r.scaleY=y(g[1]),A(g[1],1),r.skewXY/=r.scaleY,r.skewXZ=x(g[0],g[2]),Z(g[2],g[0],g[2],1,-r.skewXZ),r.skewYZ=x(g[1],g[2]),Z(g[2],g[1],g[2],1,-r.skewYZ),r.scaleZ=y(g[2]),A(g[2],1),r.skewXZ/=r.scaleZ,r.skewYZ/=r.scaleZ,f=_(g[1],g[2]),x(g[0],f)<0)for(e=0;3>e;e++)r.scaleX*=-1,g[e][0]*=-1,g[e][1]*=-1,g[e][2]*=-1;return r.rotateY=l(v(-g[0][2]))||0,0!==d(r.rotateY)?(r.rotateX=l(m(g[1][2],g[2][2]))||0,r.rotateZ=l(m(g[0][1],g[0][0]))||0):(r.rotateX=l(m(-g[2][0],g[1][1]))||0,r.rotateZ=0),r},C=function(t,e){var n=t||e||0;return""+n.toFixed(20)},M=function(t,e){return C(t,e)+"px"},L=function(t,e){return C(t,e)+"deg"};return{fromCssMatrix:function(t){var e=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];if(t&&"none"!==t){var n=t.split("(")[1].split(")")[0].split(",").map(Number);if(t.match(/^matrix\(/))e[0][0]=n[0],e[1][0]=n[1],e[0][1]=n[2],e[1][1]=n[3],e[3][0]=n[4],e[3][1]=n[5];else for(var r=0;16>r;r++){var a=h(r/4),o=r%4;e[a][o]=n[r]}}return k(e)},toCss:function(t){var e=[C(t.perspectiveX),C(t.perspectiveY),C(t.perspectiveZ),C(t.perspectiveW,1)],n=[M(t.translateX),M(t.translateY),M(t.translateZ)],r=[C(t.scaleX),C(t.scaleY),C(t.scaleZ)],a=[L(t.rotateX),L(t.rotateY),L(t.rotateZ)],o=[C(t.skewXY),C(t.skewXZ),C(t.skewYZ)];return["matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,"+e.join(",")+")","translate3d("+n.join(",")+")","rotateX("+a[0]+") rotateY("+a[1]+") rotateZ("+a[2]+")","matrix3d(1,0,0,0,0,1,0,0,0,"+o[2]+",1,0,0,0,0,1)","matrix3d(1,0,0,0,0,1,0,0,"+o[1]+",0,1,0,0,0,0,1)","matrix3d(1,0,0,0,"+o[0]+",1,0,0,0,0,1,0,0,0,0,1)","scale3d("+r.join(",")+")"].join(" ")},get:function(t){return this.fromCssMatrix(u(t))},set:function(t,e){var n="string"==typeof e?e:this.toCss(e);s(t,n)}}})}(),function(){"use strict";angular.module("mobile-angular-ui.gestures",["mobile-angular-ui.gestures.drag","mobile-angular-ui.gestures.swipe","mobile-angular-ui.gestures.transform"])}();
//# sourceMappingURL=mobile-angular-ui.gestures.min.js.map
!function(){"use strict";angular.module("as.sortable",[]).constant("sortableConfig",{itemClass:"as-sortable-item",handleClass:"as-sortable-item-handle",placeHolderClass:"as-sortable-placeholder",dragClass:"as-sortable-drag",hiddenClass:"as-sortable-hidden",dragging:"as-sortable-dragging"})}(),function(){"use strict";var mainModule=angular.module("as.sortable");mainModule.factory("$helper",["$document","$window",function($document,$window){return{height:function(element){return element[0].getBoundingClientRect().height},width:function(element){return element[0].getBoundingClientRect().width},offset:function(element,scrollableContainer){var boundingClientRect=element[0].getBoundingClientRect();return scrollableContainer||(scrollableContainer=$document[0].documentElement),{width:boundingClientRect.width||element.prop("offsetWidth"),height:boundingClientRect.height||element.prop("offsetHeight"),top:boundingClientRect.top+($window.pageYOffset||scrollableContainer.scrollTop-scrollableContainer.offsetTop),left:boundingClientRect.left+($window.pageXOffset||scrollableContainer.scrollLeft-scrollableContainer.offsetLeft)}},eventObj:function(event){var obj=event;return void 0!==event.targetTouches?obj=event.targetTouches.item(0):void 0!==event.originalEvent&&void 0!==event.originalEvent.targetTouches&&(obj=event.originalEvent.targetTouches.item(0)),obj},isTouchInvalid:function(event){var touchInvalid=!1;return void 0!==event.touches&&event.touches.length>1?touchInvalid=!0:void 0!==event.originalEvent&&void 0!==event.originalEvent.touches&&event.originalEvent.touches.length>1&&(touchInvalid=!0),touchInvalid},positionStarted:function(event,target,scrollableContainer){var pos={};return pos.offsetX=event.pageX-this.offset(target,scrollableContainer).left,pos.offsetY=event.pageY-this.offset(target,scrollableContainer).top,pos.startX=pos.lastX=event.pageX,pos.startY=pos.lastY=event.pageY,pos.nowX=pos.nowY=pos.distX=pos.distY=pos.dirAx=0,pos.dirX=pos.dirY=pos.lastDirX=pos.lastDirY=pos.distAxX=pos.distAxY=0,pos},calculatePosition:function(pos,event){pos.lastX=pos.nowX,pos.lastY=pos.nowY,pos.nowX=event.pageX,pos.nowY=event.pageY,pos.distX=pos.nowX-pos.lastX,pos.distY=pos.nowY-pos.lastY,pos.lastDirX=pos.dirX,pos.lastDirY=pos.dirY,pos.dirX=0===pos.distX?0:pos.distX>0?1:-1,pos.dirY=0===pos.distY?0:pos.distY>0?1:-1;var newAx=Math.abs(pos.distX)>Math.abs(pos.distY)?1:0;pos.dirAx!==newAx?(pos.distAxX=0,pos.distAxY=0):(pos.distAxX+=Math.abs(pos.distX),0!==pos.dirX&&pos.dirX!==pos.lastDirX&&(pos.distAxX=0),pos.distAxY+=Math.abs(pos.distY),0!==pos.dirY&&pos.dirY!==pos.lastDirY&&(pos.distAxY=0)),pos.dirAx=newAx},movePosition:function(event,element,pos,container,containerPositioning,scrollableContainer){var bounds,useRelative="relative"===containerPositioning;element.x=event.pageX-pos.offsetX,element.y=event.pageY-pos.offsetY,container&&(bounds=this.offset(container,scrollableContainer),useRelative&&(element.x-=bounds.left,element.y-=bounds.top,bounds.left=0,bounds.top=0),element.x<bounds.left?element.x=bounds.left:element.x>=bounds.width+bounds.left-this.offset(element).width&&(element.x=bounds.width+bounds.left-this.offset(element).width),element.y<bounds.top?element.y=bounds.top:element.y>=bounds.height+bounds.top-this.offset(element).height&&(element.y=bounds.height+bounds.top-this.offset(element).height)),element.css({left:element.x+"px",top:element.y+"px"}),this.calculatePosition(pos,event)},dragItem:function(item){return{index:item.index(),parent:item.sortableScope,source:item,targetElement:null,targetElementOffset:null,sourceInfo:{index:item.index(),itemScope:item.itemScope,sortableScope:item.sortableScope},canMove:function(itemPosition,targetElement,targetElementOffset){return this.targetElement!==targetElement?(this.targetElement=targetElement,this.targetElementOffset=targetElementOffset,!0):itemPosition.dirX*(targetElementOffset.left-this.targetElementOffset.left)>0||itemPosition.dirY*(targetElementOffset.top-this.targetElementOffset.top)>0?(this.targetElementOffset=targetElementOffset,!0):!1},moveTo:function(parent,index){this.parent=parent,this.isSameParent()&&this.source.index()<index&&(index-=1),this.index=index},isSameParent:function(){return this.parent.element===this.sourceInfo.sortableScope.element},isOrderChanged:function(){return this.index!==this.sourceInfo.index},eventArgs:function(){return{source:this.sourceInfo,dest:{index:this.index,sortableScope:this.parent}}},apply:function(){this.sourceInfo.sortableScope.options.clone||this.sourceInfo.sortableScope.removeItem(this.sourceInfo.index),(this.parent.options.allowDuplicates||this.parent.modelValue.indexOf(this.source.modelValue)<0)&&this.parent.insertItem(this.index,this.source.modelValue)}}},noDrag:function(element){return void 0!==element.attr("no-drag")||void 0!==element.attr("data-no-drag")},findAncestor:function(el,selector){el=el[0];for(var matches=Element.matches||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector;(el=el.parentElement)&&!matches.call(el,selector););return el?angular.element(el):angular.element(document.body)}}}])}(),function(){"use strict";var mainModule=angular.module("as.sortable");mainModule.controller("as.sortable.sortableController",["$scope",function($scope){this.scope=$scope,$scope.modelValue=null,$scope.callbacks=null,$scope.type="sortable",$scope.options={},$scope.isDisabled=!1,$scope.insertItem=function(index,itemData){$scope.options.allowDuplicates?$scope.modelValue.splice(index,0,angular.copy(itemData)):$scope.modelValue.splice(index,0,itemData)},$scope.removeItem=function(index){var removedItem=null;return index>-1&&(removedItem=$scope.modelValue.splice(index,1)[0]),removedItem},$scope.isEmpty=function(){return $scope.modelValue&&0===$scope.modelValue.length},$scope.accept=function(sourceItemHandleScope,destScope,destItemScope){return $scope.callbacks.accept(sourceItemHandleScope,destScope,destItemScope)}}]),mainModule.directive("asSortable",function(){return{require:"ngModel",restrict:"A",scope:!0,controller:"as.sortable.sortableController",link:function(scope,element,attrs,ngModelController){var ngModel,callbacks;ngModel=ngModelController,ngModel&&(ngModel.$render=function(){scope.modelValue=ngModel.$modelValue},scope.element=element,element.data("_scope",scope),callbacks={accept:null,orderChanged:null,itemMoved:null,dragStart:null,dragMove:null,dragCancel:null,dragEnd:null},callbacks.accept=function(sourceItemHandleScope,destSortableScope,destItemScope){return!0},callbacks.orderChanged=function(event){},callbacks.itemMoved=function(event){},callbacks.dragStart=function(event){},callbacks.dragMove=angular.noop,callbacks.dragCancel=function(event){},callbacks.dragEnd=function(event){},scope.$watch(attrs.asSortable,function(newVal,oldVal){angular.forEach(newVal,function(value,key){callbacks[key]?"function"==typeof value&&(callbacks[key]=value):scope.options[key]=value}),scope.callbacks=callbacks},!0),angular.isDefined(attrs.isDisabled)&&scope.$watch(attrs.isDisabled,function(newVal,oldVal){angular.isUndefined(newVal)||(scope.isDisabled=newVal)},!0))}}})}(),function(){"use strict";function isParent(possibleParent,elem){return elem&&"HTML"!==elem.nodeName?elem.parentNode===possibleParent?!0:isParent(possibleParent,elem.parentNode):!1}var mainModule=angular.module("as.sortable");mainModule.controller("as.sortable.sortableItemHandleController",["$scope",function($scope){this.scope=$scope,$scope.itemScope=null,$scope.type="handle"}]),mainModule.directive("asSortableItemHandle",["sortableConfig","$helper","$window","$document",function(sortableConfig,$helper,$window,$document){return{require:"^asSortableItem",scope:!0,restrict:"A",controller:"as.sortable.sortableItemHandleController",link:function(scope,element,attrs,itemController){function insertBefore(targetElement,targetScope){"table-row"!==placeHolder.css("display")&&placeHolder.css("display","block"),targetScope.sortableScope.options.clone||(targetElement[0].parentNode.insertBefore(placeHolder[0],targetElement[0]),dragItemInfo.moveTo(targetScope.sortableScope,targetScope.index()))}function insertAfter(targetElement,targetScope){"table-row"!==placeHolder.css("display")&&placeHolder.css("display","block"),targetScope.sortableScope.options.clone||(targetElement.after(placeHolder),dragItemInfo.moveTo(targetScope.sortableScope,targetScope.index()+1))}function fetchScope(element){for(var scope;!scope&&element.length;)scope=element.data("_scope"),scope||(element=element.parent());return scope}function rollbackDragChanges(){placeElement.replaceWith(scope.itemScope.element),placeHolder.remove(),dragElement.remove(),dragElement=null,dragHandled=!1,containment.css("cursor",""),containment.removeClass("as-sortable-un-selectable")}var dragElement,placeHolder,placeElement,itemPosition,dragItemInfo,containment,containerPositioning,dragListen,scrollableContainer,dragStart,dragMove,dragEnd,dragCancel,isDraggable,placeHolderIndex,bindDrag,unbindDrag,bindEvents,unBindEvents,hasTouch,dragHandled,createPlaceholder,isPlaceHolderPresent,escapeListen,isDisabled=!1;hasTouch=$window.hasOwnProperty("ontouchstart"),sortableConfig.handleClass&&element.addClass(sortableConfig.handleClass),scope.itemScope=itemController.scope,element.data("_scope",scope),scope.$watch("sortableScope.isDisabled",function(newVal){isDisabled!==newVal&&(isDisabled=newVal,isDisabled?unbindDrag():bindDrag())}),scope.$on("$destroy",function(){angular.element($document[0].body).unbind("keydown",escapeListen)}),createPlaceholder=function(itemScope){return"function"==typeof scope.sortableScope.options.placeholder?angular.element(scope.sortableScope.options.placeholder(itemScope)):"string"==typeof scope.sortableScope.options.placeholder?angular.element(scope.sortableScope.options.placeholder):angular.element($document[0].createElement(itemScope.element.prop("tagName")))},dragListen=function(event){var startPosition,unbindMoveListen=function(){angular.element($document).unbind("mousemove",moveListen),angular.element($document).unbind("touchmove",moveListen),element.unbind("mouseup",unbindMoveListen),element.unbind("touchend",unbindMoveListen),element.unbind("touchcancel",unbindMoveListen)},moveListen=function(e){e.preventDefault();var eventObj=$helper.eventObj(e);startPosition||(startPosition={clientX:eventObj.clientX,clientY:eventObj.clientY}),Math.abs(eventObj.clientX-startPosition.clientX)+Math.abs(eventObj.clientY-startPosition.clientY)>10&&(unbindMoveListen(),dragStart(event))};angular.element($document).bind("mousemove",moveListen),angular.element($document).bind("touchmove",moveListen),element.bind("mouseup",unbindMoveListen),element.bind("touchend",unbindMoveListen),element.bind("touchcancel",unbindMoveListen),event.stopPropagation()},dragStart=function(event){var eventObj,tagName;(hasTouch||2!==event.button&&3!==event.which)&&(hasTouch&&$helper.isTouchInvalid(event)||!dragHandled&&isDraggable(event)&&(dragHandled=!0,event.preventDefault(),eventObj=$helper.eventObj(event),scope.sortableScope=scope.sortableScope||scope.itemScope.sortableScope,scope.callbacks=scope.callbacks||scope.itemScope.callbacks,scrollableContainer=angular.element($document[0].querySelector(scope.sortableScope.options.scrollableContainer)).length>0?$document[0].querySelector(scope.sortableScope.options.scrollableContainer):$document[0].documentElement,containment=scope.sortableScope.options.containment?$helper.findAncestor(element,scope.sortableScope.options.containment):angular.element($document[0].body),containment.css("cursor","move"),containment.css("cursor","-webkit-grabbing"),containment.css("cursor","-moz-grabbing"),containment.addClass("as-sortable-un-selectable"),containerPositioning=scope.sortableScope.options.containerPositioning||"absolute",dragItemInfo=$helper.dragItem(scope),tagName=scope.itemScope.element.prop("tagName"),dragElement=angular.element($document[0].createElement(scope.sortableScope.element.prop("tagName"))).addClass(scope.sortableScope.element.attr("class")).addClass(sortableConfig.dragClass),dragElement.css("width",$helper.width(scope.itemScope.element)+"px"),dragElement.css("height",$helper.height(scope.itemScope.element)+"px"),placeHolder=createPlaceholder(scope.itemScope).addClass(sortableConfig.placeHolderClass).addClass(scope.sortableScope.options.additionalPlaceholderClass),placeHolder.css("width",$helper.width(scope.itemScope.element)+"px"),placeHolder.css("height",$helper.height(scope.itemScope.element)+"px"),placeElement=angular.element($document[0].createElement(tagName)),sortableConfig.hiddenClass&&placeElement.addClass(sortableConfig.hiddenClass),itemPosition=$helper.positionStarted(eventObj,scope.itemScope.element,scrollableContainer),$helper.movePosition(eventObj,dragElement,itemPosition,containment,containerPositioning,scrollableContainer),scope.itemScope.sortableScope.options.clone||scope.itemScope.element.after(placeHolder),scope.itemScope.element.after(placeElement),scope.itemScope.sortableScope.options.clone?dragElement.append(scope.itemScope.element.clone()):dragElement.append(scope.itemScope.element),containment.append(dragElement),scope.sortableScope.$apply(function(){scope.callbacks.dragStart(dragItemInfo.eventArgs())}),bindEvents()))},isDraggable=function(event){var elementClicked,sourceScope,isDraggable;for(elementClicked=angular.element(event.target),sourceScope=fetchScope(elementClicked),isDraggable=sourceScope&&"handle"===sourceScope.type;isDraggable&&elementClicked[0]!==element[0];)$helper.noDrag(elementClicked)&&(isDraggable=!1),elementClicked=elementClicked.parent();return isDraggable},dragMove=function(event){var eventObj,targetX,targetY,targetScope,targetElement;if((!hasTouch||!$helper.isTouchInvalid(event))&&dragHandled&&dragElement){if(event.preventDefault(),eventObj=$helper.eventObj(event),scope.callbacks.dragMove!==angular.noop&&scope.sortableScope.$apply(function(){scope.callbacks.dragMove(itemPosition,containment,eventObj)}),targetX=eventObj.pageX-$document[0].documentElement.scrollLeft,targetY=eventObj.pageY-($window.pageYOffset||$document[0].documentElement.scrollTop),targetElement=angular.element($document[0].elementFromPoint(targetX,targetY)),dragElement.addClass(sortableConfig.hiddenClass),dragElement.removeClass(sortableConfig.hiddenClass),$helper.movePosition(eventObj,dragElement,itemPosition,containment,containerPositioning,scrollableContainer),dragElement.addClass(sortableConfig.dragging),targetScope=fetchScope(targetElement),!targetScope||!targetScope.type)return;if("handle"===targetScope.type&&(targetScope=targetScope.itemScope),"item"!==targetScope.type&&"sortable"!==targetScope.type)return;if("item"===targetScope.type&&targetScope.accept(scope,targetScope.sortableScope,targetScope)){targetElement=targetScope.element;var targetElementOffset=$helper.offset(targetElement,scrollableContainer);if(!dragItemInfo.canMove(itemPosition,targetElement,targetElementOffset))return;var placeholderIndex=placeHolderIndex(targetScope.sortableScope.element);0>placeholderIndex?insertBefore(targetElement,targetScope):placeholderIndex<=targetScope.index()?insertAfter(targetElement,targetScope):insertBefore(targetElement,targetScope)}"sortable"===targetScope.type&&targetScope.accept(scope,targetScope)&&!isParent(targetScope.element[0],targetElement[0])&&(isPlaceHolderPresent(targetElement)||targetScope.options.clone||(targetElement[0].appendChild(placeHolder[0]),dragItemInfo.moveTo(targetScope,targetScope.modelValue.length)))}},placeHolderIndex=function(targetElement){var itemElements,i;if(targetElement.hasClass(sortableConfig.placeHolderClass))return 0;for(itemElements=targetElement.children(),i=0;i<itemElements.length;i+=1)if(angular.element(itemElements[i]).hasClass(sortableConfig.placeHolderClass))return i;return-1},isPlaceHolderPresent=function(targetElement){return placeHolderIndex(targetElement)>=0},dragEnd=function(event){dragHandled&&(event.preventDefault(),dragElement&&(rollbackDragChanges(),dragItemInfo.apply(),scope.sortableScope.$apply(function(){dragItemInfo.isSameParent()?dragItemInfo.isOrderChanged()&&scope.callbacks.orderChanged(dragItemInfo.eventArgs()):scope.callbacks.itemMoved(dragItemInfo.eventArgs())}),scope.sortableScope.$apply(function(){scope.callbacks.dragEnd(dragItemInfo.eventArgs())}),dragItemInfo=null),unBindEvents())},dragCancel=function(event){dragHandled&&(event.preventDefault(),dragElement&&(rollbackDragChanges(),scope.sortableScope.$apply(function(){scope.callbacks.dragCancel(dragItemInfo.eventArgs())}),dragItemInfo=null),unBindEvents())},bindDrag=function(){element.bind("touchstart",dragListen),element.bind("mousedown",dragListen)},unbindDrag=function(){element.unbind("touchstart",dragListen),element.unbind("mousedown",dragListen)},bindDrag(),escapeListen=function(event){27===event.keyCode&&dragCancel(event)},angular.element($document[0].body).bind("keydown",escapeListen),bindEvents=function(){angular.element($document).bind("touchmove",dragMove),angular.element($document).bind("touchend",dragEnd),angular.element($document).bind("touchcancel",dragCancel),angular.element($document).bind("mousemove",dragMove),angular.element($document).bind("mouseup",dragEnd)},unBindEvents=function(){angular.element($document).unbind("touchend",dragEnd),angular.element($document).unbind("touchcancel",dragCancel),angular.element($document).unbind("touchmove",dragMove),angular.element($document).unbind("mouseup",dragEnd),angular.element($document).unbind("mousemove",dragMove)}}}}])}(),function(){"use strict";var mainModule=angular.module("as.sortable");mainModule.controller("as.sortable.sortableItemController",["$scope",function($scope){this.scope=$scope,$scope.sortableScope=null,$scope.modelValue=null,$scope.type="item",$scope.index=function(){return $scope.$index},$scope.itemData=function(){return $scope.sortableScope.modelValue[$scope.$index]}}]),mainModule.directive("asSortableItem",["sortableConfig",function(sortableConfig){return{require:["^asSortable","?ngModel"],restrict:"A",controller:"as.sortable.sortableItemController",link:function(scope,element,attrs,ctrl){var sortableController=ctrl[0],ngModelController=ctrl[1];sortableConfig.itemClass&&element.addClass(sortableConfig.itemClass),scope.sortableScope=sortableController.scope,ngModelController?ngModelController.$render=function(){scope.modelValue=ngModelController.$modelValue}:scope.modelValue=sortableController.scope.modelValue[scope.$index],scope.element=element,element.data("_scope",scope)}}}])}();
/*! ngclipboard - v1.1.0 - 2015-12-30
* https://github.com/sachinchoolur/ngclipboard
* Copyright (c) 2015 Sachin; Licensed MIT */
!function(){"use strict";var a,b,c="ngclipboard";"undefined"!=typeof module&&"object"==typeof module.exports?(a=require("angular"),b=require("clipboard"),module.exports=c):(a=window.angular,b=window.Clipboard),a.module(c,[]).directive("ngclipboard",function(){return{restrict:"A",scope:{ngclipboardSuccess:"&",ngclipboardError:"&"},link:function(a,c){var d=new b(c[0]);d.on("success",function(b){a.ngclipboardSuccess({e:b})}),d.on("error",function(b){a.ngclipboardError({e:b})})}}})}();
var app=angular.module("disczump",["ngRoute","ngAnimate","mobile-angular-ui","mobile-angular-ui.gestures","as.sortable","oc.lazyLoad","ngclipboard","disczump.controllers"]);app.config(["$routeProvider","$httpProvider",function($routeProvider,$httpProvider){if(!$httpProvider.defaults.headers.get){$httpProvider.defaults.headers.get={}}$httpProvider.defaults.headers.get["If-Modified-Since"]="Mon, 26 Jul 1997 05:00:00 GMT";$httpProvider.defaults.headers.get["Cache-Control"]="no-cache";$httpProvider.defaults.headers.get["Pragma"]="no-cache";console.log($routeProvider);$routeProvider.when("/",{templateUrl:"/static/mobile/templates/dashboard.html",controller:"DashboardController",reloadOnSearch:false}).when("/d/:userId",{templateUrl:"/static/mobile/templates/dashboard.html",controller:"DashboardController",reloadOnSearch:false}).when("/disc/create",{templateUrl:"/static/mobile/templates/modifyDisc.html",controller:"ModifyDiscController",reloadOnSearch:false}).when("/disc/:discId",{templateUrl:"/static/mobile/templates/disc.html",controller:"DiscController",reloadOnSearch:false}).when("/disc/:discId/edit",{templateUrl:"/static/mobile/templates/modifyDisc.html",controller:"ModifyDiscController",reloadOnSearch:false}).when("/disc/:discId/images",{templateUrl:"/static/mobile/templates/discImages.html",controller:"DiscImageController",reloadOnSearch:false}).when("/filter",{templateUrl:"/static/mobile/templates/filterList.html",controller:"FilterListController",reloadOnSearch:false}).when("/filter/:filterProp",{templateUrl:"/static/mobile/templates/filterProp.html",controller:"FilterPropController",reloadOnSearch:false}).when("/sort",{templateUrl:"/static/mobile/templates/sortList.html",controller:"SortListController",reloadOnSearch:false}).when("/sort/add",{templateUrl:"/static/mobile/templates/sortProp.html",controller:"SortPropController",reloadOnSearch:false}).when("/settings",{templateUrl:"/static/mobile/templates/settings.html",controller:"SettingsController",reloadOnSearch:false}).when("/profile",{templateUrl:"/static/mobile/templates/profileList.html",controller:"ProfileListController",reloadOnSearch:false}).when("/profile/:userId",{templateUrl:"/static/mobile/templates/profile.html",controller:"ProfileController",reloadOnSearch:false}).otherwise({redirectTo:"/"})}]);app.run(["$location","ConfigService",function($location,ConfigService){ConfigService.initUrl($location.absUrl())}]);
var siteUrl="https://www.disczump.com";var dzID="1433417853616595";angular.module("disczump.controllers",["disczump.services"]).directive("dropzone",function(){return function(scope,element,attrs){var config,dropzone;config=scope[attrs.dropzone];dropzone=new Dropzone(element[0],config.options);angular.forEach(config.eventHandlers,function(handler,event){dropzone.on(event,handler)});scope[attrs.dropzone].getDropzone=function(){return dropzone}}}).directive("imageCropper",["$window","ImageService",function($window,ImageService){return{restrict:"E",scope:{cropperOptions:"="},template:'<div class="image-cropper backdrop" ng-show="show">'+'<div class="image-container"><div class="image-area" '+'style="margin-top: {{margin}}px;" id="image-parent">'+"</div></div>"+'<div class="dual-item-row cropper-footer">'+'<button type="button" class="dual-item btn btn-block '+'btn-primary" ng-click="cancel($event)">Cancel</button>'+'<button type="button" class="dual-item btn btn-block '+'btn-primary" ng-click="finish($event)">Finish</button>'+'<div class="clearfix"></div>'+"</div>"+"</div>",replace:true,link:function(scope,element,attrs){var cropper,imageName,imageSrc;scope.show=false;scope.width=$window.innerWidth-40;scope.margin=($window.innerHeight-50-scope.width)/2;scope.cropperOptions.showCropper=function(name,src){imageName=name;imageSrc=src;scope.safeApply(function(){scope.show=true});var parent=document.getElementById("image-parent");parent.innerHTML='<img src="'+src+'" id="test-crop"'+' filename="'+name+'" style="width:'+scope.width+"px;height:"+scope.width+'px"/>';initCropper()};scope.cancel=function(e){e.preventDefault();cropper.destroy();scope.safeApply(function(){scope.show=false})};scope.finish=function(e){e.preventDefault();scope.safeApply(function(){scope.cropperOptions.cropperLoading=true;scope.show=false});setTimeout(function(){var blob=cropper.getCroppedCanvas().toDataURL();var newFile=ImageService.dataURItoBlob(blob);cropper.destroy();newFile.cropped=true;newFile.name=imageName;scope.cropperOptions.onFinish(newFile)},100)};var initCropper=function(){var image=document.getElementById("test-crop");cropper=new Cropper(image,{checkOrientation:false,aspectRatio:1/1,autoCropArea:1,dragMode:"move",dragCrop:false,cropBoxMovable:false,cropBoxResizable:false,viewMode:3,built:function(){scope.safeApply(function(){scope.cropperOptions.cropperLoading=false})}})};scope.safeApply=function(fn){var phase=this.$root.$$phase;if(phase=="$apply"||phase=="$digest"){if(fn&&typeof fn==="function"){fn()}}else{this.$apply(fn)}}}}}]).directive("directiveOn",["$compile",function($compile){return{scope:{trigger:"=directiveOn"},restrict:"A",link:function(scope,element,attrs){var directive=eval("("+attrs.directiveSet+")");if(typeof directive==="object"){scope.$watch("trigger",function(newValue,oldValue){if(newValue==true){for(var a in directive){element.attr(a,directive[a])}element.removeAttr("directive-on");element.removeAttr("directive-set");$compile(angular.element(element[0]))(scope.$parent)}})}}}}]).directive("errorModal",function(){return{scope:{errorOptions:"="},restrict:"E",template:'<div class="backdrop" ng-show="errorOptions.active">'+'<div class="dz-modal">'+'<div class="dz-modal-icon modal-row"><span>'+'<i class="fa fa-exclamation-triangle"></i>'+"</span></div>"+'<div class="dz-modal-title modal-row">'+"{{errorOptions.title}}</div>"+'<div class="dz-modal-text-container modal-row">'+'<div class="dz-modal-label">Details:</div>'+'<div class="dz-modal-details">'+"{{errorOptions.customText}} "+"{{errorOptions.errorText}}"+"</div>"+"</div>"+'<div class="dz-modal-btn close-modal" '+'ng-click="close()">Close</div>'+"</div>"+"</div>",replace:true,link:function(scope,element,attrs){scope.close=function(){scope.errorOptions.active=false;if(scope.errorOptions.onClose){scope.errorOptions.onClose()}}}}}).directive("infiniteScroll",function(){return{restrict:"A",link:function(scope,element,attrs){var raw=element[0];element.bind("scroll",function(){if(raw.scrollTop+raw.offsetHeight>=raw.scrollHeight){scope.$apply(attrs.infiniteScroll)}})}}}).directive("focusOn",["$timeout",function($timeout){return{restrict:"A",scope:{trigger:"=focusOn"},link:function(scope,element){scope.$watch("trigger",function(value){if(value===true){$timeout(function(){element[0].focus();scope.trigger=false},300)}})}}}]).directive("dzFill",["$compile","AutoFillService",function($compile,AutoFillService){return{restrict:"A",scope:{ngModel:"="},replace:false,link:function(scope,element,attrs){scope.fill={results:[],interact:false,selected:false,onSelect:false};var input=angular.element(element[0]);var resultList=angular.element('<ul ng-show="fill.results.length && fill.interact &&'+'!fill.selected" class="auto-fill-list">'+'<li ng-repeat="result in fill.results | limitTo:20" '+'ng-click="setValue(result)">{{result}}</li></ul>');scope.setValue=function(result){scope.fill.selected=true;scope.fill.onSelect=true;element[0].focus();scope.ngModel=result};scope.$watch("ngModel",function(newValue,oldValue){if(oldValue==newValue)return;if(scope.fill.onSelect){scope.fill.onSelect=false;return}scope.fill.selected=false;scope.fill.results=AutoFillService.getOptions(attrs.dzFill,newValue)});input.bind("focus",function(){scope.fill.interact=true});input.bind("blur",function(){scope.fill.interact=false});input.after(resultList);$compile(resultList)(scope)}}}]).directive("ngEnter",function(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){if(event.which===13){scope.$apply(attrs.ngEnter);event.preventDefault()}})}}).controller("MainController",["$scope","$location","$window","$document","DataService",function($scope,$location,$window,$document,DataService){$scope.errorOpts={active:false};$scope.setUrl=function(url){siteUrl=url;$scope.init()};$scope.toast=function(message){var currents=angular.element(document.querySelector(".toast"));currents.remove();var body=$document.find("body").eq(0);var div=angular.element('<div class="toast" id="toast"><div>'+message+"</div></div>");body.append(div);var toast=document.getElementById("toast");toast.addEventListener("animationend",function(){div.remove()},false);div.addClass("fade-out")};$scope.showError=function(obj,title,customText,errorText,onClose){obj.title=title;obj.customText=customText;obj.errorText=errorText;obj.onClose=onClose;obj.active=true};$scope.init=function(){DataService.initialize(function(success,retData){if(success){console.log("Initialized")}else{$scope.showError($scope.errorOpts,retData.type,"Error initializing.",retData.message,function(){$location.path("/")})}})};$scope.goBack=function(){$window.history.back()};$scope.nav=function(url,replace){$location.path("/"+(url?url:""));if(replace){$location.replace()}};$scope.$def=function(obj){return typeof obj!=="undefined"};$scope.safeApply=function(fn){var phase=this.$root.$$phase;if(phase=="$apply"||phase=="$digest"){if(fn&&typeof fn==="function"){fn()}}else{this.$apply(fn)}}}]).controller("DashboardController",["$scope","$routeParams","DataService","FilterService","SearchService",function($scope,$routeParams,DataService,FilterService,SearchService){$scope.discList=undefined;$scope.userPrefs=DataService.userPrefs;$scope.filterDisc=FilterService.filterObj;$scope.query=SearchService.lastQuery.valueOf();$scope.searchFocus=$scope.searchActive=SearchService.lastQuery.valueOf().length>0;$scope.loadSize=20;$scope.title="Loading...";$scope.$on("$destroy",function(){SearchService.lastQuery=$scope.query.valueOf()});$scope.searchDisc=function(obj){return SearchService.search($scope.query,obj)};$scope.$watch("discList",function(){$scope.loadSize=20});$scope.getPrimaryImage=function(disc){return DataService.getPrimaryImage(disc,true)};$scope.getColorize=function(disc){return DataService.getColorize(disc)};$scope.loadMore=function(){$scope.loadSize=Math.min($scope.discList.length,$scope.loadSize+20)};$scope.loadParams={loading:true};if($routeParams.userId){DataService.getPublicDiscs($routeParams.userId,function(success,retData){$scope.loadParams.loading=false;if(success){if(!DataService.isPublic()){DataService.setPublicState(true);FilterService.clearFilters()}$scope.discList=retData.discs;$scope.title=retData.user?retData.user.username+"'s Discs":"Unknown";$scope.filtering=FilterService.isFilterActive()}else{$scope.showError($scope.errorOpts,retData.type,"Error retrieving public discs.",retData.message,function(){$scope.nav()})}})}else{if(DataService.isPublic()){DataService.setPublicState(false);FilterService.clearFilters()}$scope.discList=DataService.discs;$scope.title="My Dashboard";$scope.filtering=FilterService.isFilterActive();$scope.loadParams.loading=false}}]).controller("ProfileListController",["$scope","DataService",function($scope,DataService){$scope.userList=DataService.users;$scope.query=DataService.userQuery;$scope.$watch("query",function(value){DataService.queryUsers($scope.query)});$scope.$on("$destroy",function(){DataService.userQuery=$scope.query.valueOf()});$scope.loading=false;$scope.searchFocus=true}]).controller("ProfileController",["$scope","$routeParams","$window","DataService",function($scope,$routeParams,$window,DataService){$scope.user=undefined;$scope.preview=undefined;$scope.dropdown=false;$scope.windowWidth=$window.innerWidth*.8;$scope.title="Loading...";$scope.errorOpts={active:false};$scope.loading=true;DataService.getUser($routeParams.userId,function(success,retData){$scope.loading=false;if(success){$scope.user=retData.user;$scope.preview=retData.preview;$scope.title=$scope.user.username}else{$scope.showError($scope.errorOpts,retData.type,"Error loading profile.",retData.message,function(){$scope.nav()})}})}]).controller("ModifyDiscController",["$scope","$window","$routeParams","$ocLazyLoad","_","AutoFillService","DataService","ImageService",function($scope,$window,$routeParams,$ocLazyLoad,_,AutoFillService,DataService,ImageService){var dropzoneTemplate='<div class="image-item">'+"<img data-dz-thumbnail />"+'<div class="image-loading" style="width:'+$scope.imgSize+"px;height:"+$scope.imgSize+'px;"><i class="fa fa-spinner fa-spin"></i></div>'+'<div class="image-progress" data-dz-uploadprogress></div>'+"</div>";$scope.disc={visible:true,tagList:[],imageList:[]};$scope.temp={tag:"",tagOptions:[],focus:false};$scope.errorOpts={active:false};$scope.forms={};$scope.settings={page:0,editMode:typeof $routeParams.discId!=="undefined",loading:true,modulesLoaded:false,dropzoneProcessing:false};$scope.imgSize=Math.floor(($window.innerWidth-48)/3);$scope.dropzoneConfig={options:{url:"/api/images",method:"POST",thumbnailWidth:$scope.imgSize,thumbnailHeight:$scope.imgSize,parallelUploads:10,maxFiles:10,paramName:"discImage",previewTemplate:dropzoneTemplate,acceptedFiles:"image/*",autoProcessQueue:true,previewsContainer:"#dropzone-container",clickable:"#add-image",accept:function(file,done){if(this.files[10]!=null){return this.removeFile(this.files[10])}if(file.cropped||file.width<200){$scope.discImageCropper.cropperLoading=false;$scope.settings.dropzoneProcessing=true;$scope.safeApply();return done()}$scope.discImageCropper.cropperLoading=true;$scope.safeApply();$scope.dropzoneConfig.getDropzone().removeFile(file);ImageService.getDataUri(file,function(dataUri){$scope.discImageCropper.showCropper(file.name,dataUri)});return done("Processing")}},eventHandlers:{success:function(file,response){if(typeof response._id!=="undefined"){$scope.disc.imageList.push(response);if($scope.disc.imageList.length==1){$scope.disc.primaryImage=response._id}$scope.safeApply()}this.removeFile(file)},queuecomplete:function(){$scope.safeApply(function(){$scope.settings.dropzoneProcessing=false})}}};$scope.discImageCropper={onFinish:function(file){$scope.safeApply(function(){$scope.discImageCropper.cropperLoading=false});if(file){$scope.dropzoneConfig.getDropzone().addFile(file)}},cropperLoading:false};$scope.triggerDropzone=function(){$scope.dropzoneConfig.getDropzone().progTrigger()};$scope.$watch("temp.tag",function(newValue,oldValue){if(!$scope.temp.tag.length){return $scope.temp.tagOptions=[]}$scope.temp.tagOptions=AutoFillService.getOptions("tagList",newValue)});$scope.appendTag=function(tag,reset){if(!tag.length)return;if(!_.contains($scope.disc.tagList,tag)){$scope.disc.tagList.push(tag)}if(reset)$scope.temp.tag="";$scope.temp.focus=true};$scope.resetDisc=function(){$scope.disc={visible:true,tagList:[],imageList:[]};$scope.settings.page=0;$scope.temp.resetDisc=false};$scope.removeTag=function(){if($scope.temp.activeTag){$scope.disc.tagList=_.without($scope.disc.tagList,$scope.temp.activeTag);$scope.temp.activeTag=undefined}};$scope.selectImage=function(id,thumbnail){$scope.temp.activeImage=id;$scope.temp.activeImageThumbnail=thumbnail};$scope.makePrimary=function(){if($scope.temp.activeImage){$scope.disc.primaryImage=$scope.temp.activeImage;$scope.temp.activeImage=undefined}};$scope.removeImage=function(){if($scope.temp.activeImage){$scope.disc.imageList=_.without($scope.disc.imageList,_.findWhere($scope.disc.imageList,{_id:$scope.temp.activeImage}));if($scope.temp.activeImage==$scope.disc.primaryImage){if($scope.disc.imageList.length){$scope.disc.primaryImage=$scope.disc.imageList[0]._id}else{$scope.disc.primaryImage=undefined}}$scope.temp.activeImage=undefined}};$scope.saveDisc=function(){if($scope.settings.dropzoneProcessing==true||$scope.settings.cropperLoading==true)return;$scope.settings.loading=true;if($scope.settings.editMode){DataService.updateDisc($scope.disc,function(success,retData){$scope.settings.loading=false;if(!success){$scope.showError($scope.errorOpts,retData.type,"Error updating existing disc.",retData.message)}else{$scope.goBack()}})}else{DataService.createDisc($scope.disc,function(success,retData){$scope.settings.loading=false;if(!success){$scope.showError($scope.errorOpts,retData.type,"Error saving new disc.",retData.message)}else{$scope.nav("disc/"+retData,true)}})}};AutoFillService.initialize(function(){if($scope.settings.editMode){DataService.getDisc($routeParams.discId,function(success,retData){$scope.settings.loading=false;if(success){$scope.disc=angular.copy(retData.disc)}else{$scope.showError($scope.errorOpts,retData.type,"Error loading disc.",retData.message,function(){$scope.nav("",true)})}})}else{$scope.settings.loading=false}});if(typeof Dropzone==="undefined"||typeof EXIF==="undefined"||typeof Cropper==="undefined"){$ocLazyLoad.load(["https://cdn.rawgit.com/exif-js/exif-js/master/exif.js","/static/src/js-dist/dropzone.min.js"]).then(function(){$ocLazyLoad.load(["/static/src/js-dist/cropper.min.js",{type:"css",path:"https://cdn.rawgit.com/fengyuanchen/cropperjs/master/dist/cropper.min.css"}]).then(function(){$scope.settings.modulesLoaded=true})})}else{$scope.settings.modulesLoaded=true}}]).controller("DiscController",["$scope","$routeParams","$window","DataService",function($scope,$routeParams,$window,DataService){$scope.disc=undefined;$scope.user=undefined;$scope.windowWidth=$window.innerWidth*.8;$scope.dropdown=false;$scope.title="Loading...";$scope.errorOpts={active:false};$scope.modal={reqShareDisc:false};$scope.onSuccess=function(e){e.clearSelection();$scope.safeApply(function(){$scope.modal.reqShareDisc=false;$scope.dropdown=false});$scope.toast("Public link copied!")};$scope.getPrimaryImage=function(){return DataService.getPrimaryImage($scope.disc)};$scope.showImageList=function(){if(!$scope.disc.imageList.length)return;$scope.nav("disc/"+$scope.disc._id+"/images")};$scope.shareLink=function(){if($scope.disc){return encodeURI("https://www.facebook.com/dialog/share?app_id="+dzID+"&display=popup&href="+siteUrl+"/disc/"+$scope.disc._id+"&redirect_uri="+siteUrl)}return"#"};$scope.deleteDisc=function(){DataService.deleteDisc($scope.disc,function(success,retData){$scope.reqDeleteDisc=undefined;if(success){$scope.nav()}else{$scope.showError($scope.errorOpts,retData.type,"Error deleting disc.",retData.message)}})};$scope.loading=true;DataService.getDisc($routeParams.discId,function(success,retData){if(success){$scope.disc=retData.disc;$scope.user=retData.user;$scope.title=$scope.disc.name;$scope.publicUrl=siteUrl+"/disc/"+$scope.disc._id}else{$scope.showError($scope.errorOpts,retData.type,"Error loading disc.",retData.message,function(){$scope.nav("",true)})}$scope.loading=false})}]).controller("DiscImageController",["$location","$scope","$routeParams","$window","DataService",function($location,$scope,$routeParams,$window,DataService){$scope.disc=undefined;$scope.title="Loading...";$scope.windowWidth=$window.innerWidth-20;$scope.imageWidth=$window.innerWidth-42;$scope.errorOpts={active:false};$scope.showImage=function(fileId){$window.open(siteUrl+"/files/"+fileId)};$scope.loading=true;DataService.getDisc($routeParams.discId,function(success,retData){$scope.loading=false;if(success){$scope.disc=retData.disc;$scope.title=$scope.disc.name+": Images"}else{$scope.showError($scope.errorOpts,retData.type,"Error loading disc.",retData.message,function(){$scope.nav()})}})}]).controller("SettingsController",["$window","$scope","DataService",function($window,$scope,DataService){$scope.viewItems=[{text:"List",value:"list"},{text:"Gallery",value:"gallery"},{text:"Dashboard",value:"dashboard"}];$scope.defaults={view:$scope.viewItems[0]}}]).controller("FilterListController",["$location","$scope","$routeParams","$window","DataService","FilterService",function($location,$scope,$routeParams,$window,DataService,FilterService){$scope.filterProps=FilterService.filterProps;$scope.clearFilters=function(){FilterService.clearFilters()};$scope.showFilterItems=function(property){$location.path("/filter/"+property)}}]).controller("FilterPropController",["$scope","$routeParams","_","FilterService",function($scope,$routeParams,_,FilterService){$scope.items=[];$scope.item=FilterService.getFilterItem($routeParams.filterProp);$scope.clearFilters=function(){_.each($scope.items,function(item){FilterService.clearOption($scope.item.property,item.name);item.active=false})};$scope.setOption=function(item){if(!item.active){FilterService.setOption($scope.item.property,item.name)}else{FilterService.clearOption($scope.item.property,item.name)}item.active=!item.active};var options=_.sortBy(FilterService.getFilterOptions($scope.item.property),function(i){if(_.isNumber(i)){return parseInt(i)}if(_.isString(i)){if(i==""){return undefined}else{return i.toLowerCase()}}return i});_.each(options,function(option){var text=typeof option==="undefined"||option==""?"- None -":option;$scope.items.push({name:option,active:FilterService.isOptionActive($scope.item.property,option),text:text})})}]).controller("SortListController",["$location","$scope","$routeParams","$window","SortService",function($location,$scope,$routeParams,$window,SortService){$scope.sortItems=SortService.sortItems;$scope.filterSort=function(obj){return obj.sortOn};$scope.toggleDirection=function(sortItem){sortItem.sortAsc=!sortItem.sortAsc};$scope.toggleDirection=function(sortItem){sortItem.sortAsc=!sortItem.sortAsc};$scope.removeSort=function(sortItem){SortService.clearSort(sortItem.property)};$scope.addSort=function(){$location.path("/sort/add")};$scope.dragControlListeners={orderChanged:function(event){SortService.updateSortOrder(event.source.itemScope.modelValue.property,event.source.index,event.dest.index)},containment:"#sort-prop-list"}}]).controller("SortPropController",["$window","$scope","$routeParams","SortService",function($window,$scope,$routeParams,SortService){$scope.sortAsc=true;$scope.sortOptions=_.where(SortService.sortItems,{sortOn:false});$scope.data={sortItem:$scope.sortOptions[0]};$scope.setSortAsc=function(val){$scope.sortAsc=val};$scope.acceptSort=function(){SortService.addSortItem($scope.data.sortItem.property,$scope.sortAsc);$window.history.back()}}]).filter("discSort",["SortService",function(SortService){return function(array){return SortService.executeSort(array)}}]);
angular.module("underscore",[]).factory("_",["$window",function($window){return $window._}]);angular.module("disczump.services",["underscore"]).factory("ConfigService",["$location","_",function($location,_){function parseParams(url){var url=url.replace("/","");console.log(url);var params=transformToAssocArray(url);console.log(params);if(params.view=="disc"&&params.disc_id){return $location.path("/disc/"+params.disc_id)}if(params.view=="dashboard"&&params.user_id){return $location.path("/d/"+params.user_id)}if(params.view=="profile"&&params.user_id){return $location.path("/profile/"+params.user_id)}}function transformToAssocArray(prmstr){var params={};var prmarr=prmstr.split("&");for(var i=0;i<prmarr.length;i++){var tmparr=prmarr[i].split("=");params[tmparr[0]]=tmparr[1]}return params}function initUrl(url){var hashIndex=url.indexOf("#");var eqIndex=url.indexOf("=");if(hashIndex>=0&&eqIndex>=0){parseParams(url.substr(hashIndex+1,url.length-hashIndex-1))}}return{initUrl:initUrl}}]).factory("APIService",["$http","$window",function($http,$window){return{Get:Get,Put:Put,Post:Post,Delete:Delete,Query:Query};function Query(path,query,callback){var qPath=path+"?";for(var key in query){qPath=qPath+key+"="+query[key]}return request({path:qPath,method:"GET",skipAuth:true},callback)}function Get(path,callback){return request({path:path,method:"GET"},callback)}function Put(path,data,callback){return request({path:path,method:"PUT",data:data},callback)}function Post(path,data,callback){return request({path:path,method:"POST",data:data},callback)}function Delete(path,callback){return request({path:path,method:"DELETE"},callback)}function request(params,callback){return $http({method:params.method,url:siteUrl+"/api"+params.path,data:params.data,timeout:5e3}).then(function(response){var retObj=parseResponse(response);return callback(retObj.success,retObj.data)},function(response){return callback(false,{message:"Failed to hit server with request.",type:"Internal Error"})})}function parseResponse(response){if(response.data.error){return{sucess:false,data:response.data.error}}else{return{success:true,data:response.data}}}}]).factory("DataService",["$q","$rootScope","_","APIService",function($q,$rootScope,_,APIService){var account={};var userPrefs={};var discs=[];var userCache=[];var users=[];var userQuery="";var pubDiscs=undefined;var pubAccount=undefined;var publicActive=false;var isLoggedIn=false;function initialize(callback){var tasks=[];var acctReq=$q.defer();tasks.push(acctReq.promise);APIService.Get("/account",function(success,data){if(success){angular.copy(data,account);isLoggedIn=true;acctReq.resolve()}else{acctReq.reject({process:"Error loading account.",error:data})}});var prefsReq=$q.defer();tasks.push(prefsReq.promise);APIService.Get("/account/preferences",function(success,data){if(success){angular.copy(data,userPrefs);prefsReq.resolve()}else{prefsReq.reject({process:"Error loading preferences.",error:data})}});var discReq=$q.defer();tasks.push(discReq.promise);APIService.Get("/discs",function(success,data){if(success){angular.copy(data,discs);discReq.resolve()}else{discReq.reject({process:"Error loading discs.",error:data})}});$q.all(tasks).then(function(results){$rootScope.$emit("DZUserPrefsUpdated");if(callback)callback(true)},function(err){console.log(err);if(callback)callback(false,err)})}function getPrimaryImage(disc,isThumbnail){if(disc){var image=_.findWhere(disc.imageList,{_id:disc.primaryImage});if(image){return siteUrl+"/files/"+(isThumbnail?image.thumbnailId:image.fileId)}else{return siteUrl+"/static/logo/logo_small_faded.svg"}}}function getColorize(disc){if(disc.type=="Distance Driver"){return userPrefs.colorize["distance"]}else if(disc.type=="Fairway Driver"){return userPrefs.colorize["fairway"]}else if(disc.type=="Mid-range"){return userPrefs.colorize["mid"]}else if(disc.type=="Putt/Approach"){return userPrefs.colorize["putter"]}else if(disc.type=="Mini"){return userPrefs.colorize["mini"]}else{return"#FFFFFF"}}function getDisc(id,callback){var disc=_.findWhere(discs,{_id:id});var pubDisc=_.findWhere(pubDiscs,{_id:id});if(typeof disc!=="undefined"){return callback(true,{disc:disc,user:account})}if(typeof pubDisc!=="undefined"){APIService.Get("/users/"+pubDisc.userId,function(success,user){if(success){return callback(true,{disc:pubDisc,user:user})}else{return callback(false,user)}})}APIService.Get("/discs/"+id,function(success,disc){if(success){APIService.Get("/users/"+disc.userId,function(success,user){if(success){return callback(true,{disc:disc,user:user})}else{return callback(false,user)}})}else{return callback(false,disc)}})}function getUser(id,callback){var user=_.findWhere(userCache,{_id:id});if(typeof user!=="undefined"){return getUserPreview(user,callback)}APIService.Get("/users/"+id,function(success,user){if(success){userCache=_.uniq(_.union(userCache,[user]),false,_.property("_id"));return getUserPreview(user,callback)}else{return callback(false,user)}})}function getUserPreview(user,callback){if(typeof user==="undefined")return callback();APIService.Get("/users/"+user._id+"/preview",function(success,preview){if(success){return callback(true,{user:user,preview:preview})}else{return callback(false,preview)}})}function createDisc(disc,callback){APIService.Post("/discs",disc,function(success,data){if(success){discs.push(angular.copy(data));return callback(true,data._id)}return callback(false,data)})}function updateDisc(disc,callback){APIService.Put("/discs/"+disc._id,disc,function(success,data){if(success){var disc=_.findWhere(discs,{_id:data._id});copyDisc(disc,data);return callback(true,data._id)}callback(false,data)})}function deleteDisc(disc,callback){APIService.Delete("/discs/"+disc._id,function(success,data){if(success){var index=_.findIndex(discs,function(disc){return disc._id==data._id});discs.splice(index,1);return callback(true,data._id)}callback(false,data)})}function copyDisc(disc,copy){disc.brand=copy.brand;disc.name=copy.name;disc.type=copy.type;disc.material=copy.material;disc.weight=copy.weight;disc.color=copy.color;disc.speed=copy.speed;disc.turn=copy.turn;disc.glide=copy.bgliderand;disc.fade=copy.fade;disc.notes=copy.notes;disc.condition=copy.condition;disc.visible=copy.visible;disc.tagList=copy.tagList;disc.imageList=copy.imageList;disc.primaryImage=copy.primaryImage}function getPublicDiscs(userId,callback){if(userId==account._id){callback(true,{discs:discs,user:account})}else{var tasks=[];var accReq=$q.defer();tasks.push(accReq.promise);APIService.Get("/users/"+userId,function(success,data){if(success){pubAccount=data;accReq.resolve()}else{pubAccount=undefined;accReq.reject({process:"Error loading user account.",error:data})}});var discReq=$q.defer();tasks.push(discReq.promise);APIService.Get("/users/"+userId+"/discs",function(success,data){if(success){pubDiscs=data;discReq.resolve()}else{pubDiscs=undefined;discReq.reject({process:"Error loading user account.",error:data})}});$q.all(tasks).then(function(){callback(true,{discs:pubDiscs,user:pubAccount})}),function(errorObj){callback(false,errorObj)}}}function setPublicState(active){publicActive=active}function getActiveDiscList(){return publicActive?pubDiscs:discs}function isPublic(){return publicActive}function queryUsers(query){userQuery=query;if(typeof query==="undefined"||!query.trim().length){users.splice(0,users.length);return}APIService.Get("/users?q="+query.trim(),function(success,qResults){if(success){if(qResults.query!=userQuery)return;userCache=_.uniq(_.union(userCache,qResults.results),false,_.property("_id"));users.splice(0,users.length);qResults.results.forEach(function(v){users.push(v)},users)}})}function isAuthenticated(){return isLoggedIn}return{initialize:initialize,discs:discs,users:users,userQuery:userQuery,account:account,userPrefs:userPrefs,getPrimaryImage:getPrimaryImage,getColorize:getColorize,getDisc:getDisc,getPublicDiscs:getPublicDiscs,setPublicState:setPublicState,updateDisc:updateDisc,createDisc:createDisc,deleteDisc:deleteDisc,getActiveDiscList:getActiveDiscList,isPublic:isPublic,getUser:getUser,queryUsers:queryUsers,isAuthenticated:isAuthenticated}}]).factory("SearchService",["_",function(_){var searchProps=["brand","name","type","color","weight","material","tagList"];var lastQuery="";function search(query,obj){if(query==""){return true}for(var i=0;i<searchProps.length;i++){var propVal=obj[searchProps[i]];if(typeof propVal==="undefined")continue;if(_.isArray(propVal)){for(var j=0;j<propVal.length;j++){if(doCompare(query,propVal[j])){return true}}}else{if(doCompare(query,propVal)){return true}}}return false}function doCompare(query,param){try{var value=param.toString().toLowerCase();return value.indexOf(query.toLowerCase())>=0}catch(e){return false}}return{lastQuery:lastQuery,search:search}}]).factory("AutoFillService",["_","APIService","DataService",function(_,APIService,DataService){var templates=[];var initialized=false;function initialize(callback){if(initialized)return callback();APIService.Get("/templates",function(success,data){if(success){templates=data}initialized=true;callback()})}function getOptions(prop,val){if(typeof val==="undefined"){return[]}var queryArr=prop=="tagList"?DataService.discs:templates.concat(DataService.discs);var properties=getProperties(queryArr,prop);var results=_.filter(properties,function(item){var curItem;if(typeof item==="undefined"){return false}if(_.isNumber(item)){curItem=String(item)}else{curItem=item}return curItem.toLowerCase().indexOf(val.toLowerCase())>=0});return _.sortBy(results,function(item){return item.toLowerCase()})}function getProperties(items,property){var list=[];if(items.length&&_.isArray(items[0][property])){var arrList=_.pluck(items,property);_.each(arrList,function(arr){list=list.concat(arr)})}else{list=_.pluck(items,property)}return _.uniq(list)}return{initialize:initialize,getOptions:getOptions}}]).factory("FilterService",["$window","_","DataService",function($window,_,DataService){var filterProps=[{property:"brand",text:"Brand",filters:[]},{property:"name",text:"Name",filters:[]},{property:"tagList",text:"Tags",filters:[]},{property:"type",text:"Type",filters:[]},{property:"material",text:"Material",filters:[]},{property:"weight",text:"Weight",filters:[]},{property:"color",text:"Color",filters:[]},{property:"speed",text:"Speed",filters:[]},{property:"glide",text:"Glide",filters:[]},{property:"turn",text:"Turn",filters:[]},{property:"fade",text:"Fade",filters:[]},{property:"condition",text:"Condition",filters:[]}];var filterOrder=[];var tempArrFilters=undefined;function getFilterCount(prop){var filter=_.findWhere(filterProps,{property:prop});if(filter){return filter.count}return 0}function isFilterActive(){var sum=_.reduce(filterProps,function(memo,filter){return memo+filter.filters.length},0);return sum>0}function getFilterItem(prop){return _.findWhere(filterProps,{property:prop})}function getFilterOptions(prop){var discList=DataService.getActiveDiscList();var newFilters=[];for(var i=0;i<filterOrder.length;i++){var filterProp=filterOrder[i];if(prop==filterProp){break}var filterItem=_.findWhere(filterProps,{property:filterProp});newFilters.push(filterItem);discList=executeFilter(discList,newFilters)}return getProperties(prop,discList)}function clearFilters(){_.each(filterProps,function(filterItem){filterItem.filters=[]});filterOrder=[];tempArrFilters=undefined}function setOption(prop,option){var filterItem=_.findWhere(filterProps,{property:prop});if(filterItem){filterItem.filters.push(option);if(!_.contains(filterOrder,prop)){filterOrder.push(prop)}}tempArrFilters=undefined}function clearOption(prop,option){var filterItem=_.findWhere(filterProps,{property:prop});if(filterItem){filterItem.filters=_.without(filterItem.filters,option);if(!filterItem.filters.length){filterOrder=_.without(filterOrder,prop)}}tempArrFilters=undefined}function isOptionActive(prop,option){var filter=_.findWhere(filterProps,{property:prop});if(filter){return _.contains(filter.filters,option)}return false}function getFilters(filterList){var arrFilters={};if(!filterList)filterList=filterProps;_.each(filterProps,function(filter){arrFilters[filter.property]=filter.filters});return arrFilters}function filterObj(obj){if(!tempArrFilters)tempArrFilters=getFilters();for(var property in tempArrFilters){if(tempArrFilters[property].length>0){if(_.has(obj,property)){if(_.isArray(obj[property])){var hasProp=false;_.each(obj[property],function(propVal){if(_.contains(tempArrFilters[property],String(propVal))){hasProp=true}});if(!hasProp){return false}}else{if(!_.contains(tempArrFilters[property],String(obj[property]))){return false}}}else{if(!_.contains(tempArrFilters[property],"undefined")){return false}}}}return true}function executeFilter(arr,filterList){tempArrFilters=getFilters(filterList);var results=_.filter(arr,function(obj){return filterObj(obj,tempArrFilters)});return results}function getProperties(prop,arr){var list=[];if(arr.length&&_.isArray(arr[0][prop])){var arrList=_.pluck(arr,prop);_.each(arrList,function(arr){list=list.concat(arr)})}else{list=_.pluck(arr,prop)}return _.uniq(list)}return{filterProps:filterProps,getFilters:getFilters,getFilterItem:getFilterItem,getFilterOptions:getFilterOptions,clearFilters:clearFilters,setOption:setOption,clearOption:clearOption,isOptionActive:isOptionActive,executeFilter:executeFilter,filterObj:filterObj,isFilterActive:isFilterActive}}]).factory("SortService",["$window","$rootScope","_","DataService",function($window,$rootScope,_,DataService){var sortItems=[{property:"brand",text:"Brand",sortOn:true,sortAsc:false,sortOrder:0,type:"text"},{property:"name",text:"Name",sortOn:true,sortAsc:false,sortOrder:1,type:"text"},{property:"type",text:"Type",sortOn:false,sortAsc:false,sortOrder:-1,type:"text"},{property:"material",text:"Material",sortOn:false,sortAsc:false,sortOrder:-1,type:"text"},{property:"weight",text:"Weight",sortOn:false,sortAsc:false,sortOrder:1,type:"number"},{property:"color",text:"Color",sortOn:false,sortAsc:false,sortOrder:-1,type:"text"},{property:"speed",text:"Speed",sortOn:false,sortAsc:false,sortOrder:-1,type:"number"},{property:"glide",text:"Glide",sortOn:false,sortAsc:false,sortOrder:-1,type:"number"},{property:"turn",text:"Turn",sortOn:false,sortAsc:false,sortOrder:-1,type:"number"},{property:"fade",text:"Fade",sortOn:false,sortAsc:false,sortOrder:-1,type:"number"},{property:"condition",text:"Condition",sortOn:false,sortAsc:false,sortOrder:-1,type:"number"},{property:"createDate",text:"Create Date",sortOn:false,sortAsc:false,sortOrder:-1,type:"date"}];$rootScope.$on("DZUserPrefsUpdated",function(){setUserPrefs()});function setUserPrefs(){_.each(sortItems,function(sortItem){sortItem.sortOn=false;sortItem.sortOrder=-1});_.each(DataService.userPrefs.defaultSort,function(pref){addSortItem(pref.property,pref.sortAsc)})}function addSortItem(prop,asc){var i=_.max(_.pluck(sortItems,"sortOrder"))+1;var sortItem=_.findWhere(sortItems,{property:prop});if(sortItem){sortItem.sortOn=true;sortItem.sortAsc=asc;sortItem.sortOrder=i}}function clearSort(prop){var sortItem=_.findWhere(sortItems,{property:prop});var activeCount=_.where(sortItems,{sortOn:true}).length;if(sortItem&&activeCount>1){var sortOrder=sortItem.sortOrder;sortItem.sortOn=false;sortItem.sortOrder=-1;_.each(sortItems,function(sortItem){if(sortItem.sortOn){if(sortItem.sortOrder>=sortOrder){sortItem.sortOrder-=1}}})}}function updateSortOrder(prop,fromIndex,toIndex){var updateItem=_.findWhere(sortItems,{property:prop});_.each(sortItems,function(sortItem){if(sortItem.sortOn){if(sortItem.sortOrder>=toIndex&&sortItem.sortOrder<fromIndex){sortItem.sortOrder+=1}}});updateItem.sortOrder=toIndex}function getSortString(){var sortArray=[];var toSort=_.sortBy(_.where(sortItems,{sortOn:true}),"sortOrder");_.each(toSort,function(sortItem){sortArray.push((sortItem.sortAsc?"+":"-")+sortItem.property)});return sortArray.toString()}function executeSort(arr){var toSort=_.sortBy(_.where(sortItems,{sortOn:true}),"sortOrder");if(!toSort.length){return arr}return groupAndSort(arr,toSort,0)}function groupAndSort(sorted,toSort,i){if(i==toSort.length){sorted=genericSort(toSort[i-1],sorted);return sorted}var sorter=toSort[i];if(i==0){sorted=genericSort(sorter,groupAndSort(sorted,toSort,i+1));return sorted}else{var grouper=toSort[i-1];var grouped=_.groupBy(sorted,function(obj){return obj[grouper.property]});var newArray=[];_.each(grouped,function(valArray){valArray=genericSort(sorter,groupAndSort(valArray,toSort,i+1));newArray=newArray.concat(valArray)});sorted=newArray;return sorted}}function genericSort(sorter,array){if(sorter.type=="number"){array=_.sortBy(array,function(obj){return parseInt(obj[sorter.property])})}else if(sorter.type=="date"){array=_.sortBy(array,function(obj){return new Date(obj[sorter.property])})}else{array=_.sortBy(array,function(obj){return obj[sorter.property]?obj[sorter.property].toLowerCase():undefined})}if(!sorter.sortAsc){array=array.reverse()}return array}return{sortItems:sortItems,addSortItem:addSortItem,updateSortOrder:updateSortOrder,clearSort:clearSort,getSortString:getSortString,executeSort:executeSort,setUserPrefs:setUserPrefs}}]).factory("ImageService",function(){var detectVerticalSquash=function(img){var alpha,canvas,ctx,data,ey,ih,iw,py,ratio,sy;iw=img.naturalWidth;ih=img.naturalHeight;canvas=document.createElement("canvas");canvas.width=1;canvas.height=ih;ctx=canvas.getContext("2d");ctx.drawImage(img,0,0);data=ctx.getImageData(0,0,1,ih).data;sy=0;ey=ih;py=ih;while(py>sy){alpha=data[(py-1)*4+3];if(alpha===0){ey=py}else{sy=py}py=ey+sy>>1}ratio=py/ih;if(ratio===0){return 1}else{return ratio}};var drawImageIOSFix=function(o,ctx,img,sx,sy,sw,sh,dx,dy,dw,dh){var vertSquashRatio,transX,transY;vertSquashRatio=detectVerticalSquash(img);dh=dh/vertSquashRatio;transX=Math.abs(o)==90?dx+dh/2:dx+dw/2;transY=Math.abs(o)==90?dy+dw/2:dy+dh/2;ctx.translate(transX,transY);ctx.rotate(-1*o*Math.PI/180);dx=-dw/2;dy=-dh/2;return ctx.drawImage(img,sx,sy,sw,sh,dx,dy,dw,dh)};var fixImageOrientation=function(file,callback){var fileReader;fileReader=new FileReader;fileReader.onload=function(){var img;img=document.createElement("img");img.onload=function(){var orientation=0;EXIF.getData(img,function(){switch(parseInt(EXIF.getTag(this,"Orientation"))){case 3:orientation=180;break;case 6:orientation=-90;break;case 8:orientation=90;break}var canvas,ctx,dataURL;var targetWidth,targetHeight;file.width=img.naturalWidth;file.height=img.naturalHeight;targetWidth=file.width;targetHeight=file.height;canvas=document.createElement("canvas");ctx=canvas.getContext("2d");canvas.width=Math.abs(orientation)==90?targetHeight:targetWidth;canvas.height=Math.abs(orientation)==90?targetWidth:targetHeight;drawImageIOSFix(orientation,ctx,img,0,0,img.width,img.height,0,0,targetWidth,targetHeight);dataURL=canvas.toDataURL(file.type,.6);callback(dataURL)})};img.onerror=callback;img.src=fileReader.result};fileReader.readAsDataURL(file)};var dataURItoBlob=function(dataURI){var byteString=atob(dataURI.split(",")[1]);var ab=new ArrayBuffer(byteString.length);var ia=new Uint8Array(ab);for(var i=0;i<byteString.length;i++){ia[i]=byteString.charCodeAt(i)}return new Blob([ab],{type:"image/jpeg"})};return{getDataUri:fixImageOrientation,dataURItoBlob:dataURItoBlob}});